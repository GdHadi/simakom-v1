function em(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function tm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fd={exports:{}},oi={},md={exports:{}},pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vs=Symbol.for("react.element"),rm=Symbol.for("react.portal"),nm=Symbol.for("react.fragment"),sm=Symbol.for("react.strict_mode"),am=Symbol.for("react.profiler"),im=Symbol.for("react.provider"),om=Symbol.for("react.context"),lm=Symbol.for("react.forward_ref"),cm=Symbol.for("react.suspense"),um=Symbol.for("react.memo"),dm=Symbol.for("react.lazy"),Ec=Symbol.iterator;function hm(e){return e===null||typeof e!="object"?null:(e=Ec&&e[Ec]||e["@@iterator"],typeof e=="function"?e:null)}var pd={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gd=Object.assign,vd={};function Wn(e,t,r){this.props=e,this.context=t,this.refs=vd,this.updater=r||pd}Wn.prototype.isReactComponent={};Wn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Wn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function yd(){}yd.prototype=Wn.prototype;function _l(e,t,r){this.props=e,this.context=t,this.refs=vd,this.updater=r||pd}var xl=_l.prototype=new yd;xl.constructor=_l;gd(xl,Wn.prototype);xl.isPureReactComponent=!0;var Nc=Array.isArray,wd=Object.prototype.hasOwnProperty,jl={current:null},_d={key:!0,ref:!0,__self:!0,__source:!0};function xd(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)wd.call(t,n)&&!_d.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:Vs,type:e,key:i,ref:o,props:a,_owner:jl.current}}function fm(e,t){return{$$typeof:Vs,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function bl(e){return typeof e=="object"&&e!==null&&e.$$typeof===Vs}function mm(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Cc=/\/+/g;function Ti(e,t){return typeof e=="object"&&e!==null&&e.key!=null?mm(""+e.key):t.toString(36)}function xa(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Vs:case rm:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+Ti(o,0):n,Nc(a)?(r="",e!=null&&(r=e.replace(Cc,"$&/")+"/"),xa(a,t,r,"",function(u){return u})):a!=null&&(bl(a)&&(a=fm(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(Cc,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",Nc(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+Ti(i,l);o+=xa(i,t,r,c,a)}else if(c=hm(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+Ti(i,l++),o+=xa(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function ea(e,t,r){if(e==null)return e;var n=[],a=0;return xa(e,n,"","",function(i){return t.call(r,i,a++)}),n}function pm(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var it={current:null},ja={transition:null},gm={ReactCurrentDispatcher:it,ReactCurrentBatchConfig:ja,ReactCurrentOwner:jl};function jd(){throw Error("act(...) is not supported in production builds of React.")}pe.Children={map:ea,forEach:function(e,t,r){ea(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return ea(e,function(){t++}),t},toArray:function(e){return ea(e,function(t){return t})||[]},only:function(e){if(!bl(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};pe.Component=Wn;pe.Fragment=nm;pe.Profiler=am;pe.PureComponent=_l;pe.StrictMode=sm;pe.Suspense=cm;pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gm;pe.act=jd;pe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=gd({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=jl.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)wd.call(t,c)&&!_d.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:Vs,type:e.type,key:a,ref:i,props:n,_owner:o}};pe.createContext=function(e){return e={$$typeof:om,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:im,_context:e},e.Consumer=e};pe.createElement=xd;pe.createFactory=function(e){var t=xd.bind(null,e);return t.type=e,t};pe.createRef=function(){return{current:null}};pe.forwardRef=function(e){return{$$typeof:lm,render:e}};pe.isValidElement=bl;pe.lazy=function(e){return{$$typeof:dm,_payload:{_status:-1,_result:e},_init:pm}};pe.memo=function(e,t){return{$$typeof:um,type:e,compare:t===void 0?null:t}};pe.startTransition=function(e){var t=ja.transition;ja.transition={};try{e()}finally{ja.transition=t}};pe.unstable_act=jd;pe.useCallback=function(e,t){return it.current.useCallback(e,t)};pe.useContext=function(e){return it.current.useContext(e)};pe.useDebugValue=function(){};pe.useDeferredValue=function(e){return it.current.useDeferredValue(e)};pe.useEffect=function(e,t){return it.current.useEffect(e,t)};pe.useId=function(){return it.current.useId()};pe.useImperativeHandle=function(e,t,r){return it.current.useImperativeHandle(e,t,r)};pe.useInsertionEffect=function(e,t){return it.current.useInsertionEffect(e,t)};pe.useLayoutEffect=function(e,t){return it.current.useLayoutEffect(e,t)};pe.useMemo=function(e,t){return it.current.useMemo(e,t)};pe.useReducer=function(e,t,r){return it.current.useReducer(e,t,r)};pe.useRef=function(e){return it.current.useRef(e)};pe.useState=function(e){return it.current.useState(e)};pe.useSyncExternalStore=function(e,t,r){return it.current.useSyncExternalStore(e,t,r)};pe.useTransition=function(){return it.current.useTransition()};pe.version="18.3.1";md.exports=pe;var v=md.exports;const bd=tm(v),vm=em({__proto__:null,default:bd},[v]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ym=v,wm=Symbol.for("react.element"),_m=Symbol.for("react.fragment"),xm=Object.prototype.hasOwnProperty,jm=ym.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bm={key:!0,ref:!0,__self:!0,__source:!0};function Sd(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)xm.call(t,n)&&!bm.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:wm,type:e,key:i,ref:o,props:a,_owner:jm.current}}oi.Fragment=_m;oi.jsx=Sd;oi.jsxs=Sd;fd.exports=oi;var s=fd.exports,fo={},kd={exports:{}},kt={},Ed={exports:{}},Nd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t($,F){var M=$.length;$.push(F);e:for(;0<M;){var Q=M-1>>>1,te=$[Q];if(0<a(te,F))$[Q]=F,$[M]=te,M=Q;else break e}}function r($){return $.length===0?null:$[0]}function n($){if($.length===0)return null;var F=$[0],M=$.pop();if(M!==F){$[0]=M;e:for(var Q=0,te=$.length,oe=te>>>1;Q<oe;){var me=2*(Q+1)-1,se=$[me],K=me+1,G=$[K];if(0>a(se,M))K<te&&0>a(G,se)?($[Q]=G,$[K]=M,Q=K):($[Q]=se,$[me]=M,Q=me);else if(K<te&&0>a(G,M))$[Q]=G,$[K]=M,Q=K;else break e}}return F}function a($,F){var M=$.sortIndex-F.sortIndex;return M!==0?M:$.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,p=null,h=3,_=!1,y=!1,j=!1,w=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g($){for(var F=r(u);F!==null;){if(F.callback===null)n(u);else if(F.startTime<=$)n(u),F.sortIndex=F.expirationTime,t(c,F);else break;F=r(u)}}function b($){if(j=!1,g($),!y)if(r(c)!==null)y=!0,ue(L);else{var F=r(u);F!==null&&O(b,F.startTime-$)}}function L($,F){y=!1,j&&(j=!1,m(N),N=-1),_=!0;var M=h;try{for(g(F),p=r(c);p!==null&&(!(p.expirationTime>F)||$&&!B());){var Q=p.callback;if(typeof Q=="function"){p.callback=null,h=p.priorityLevel;var te=Q(p.expirationTime<=F);F=e.unstable_now(),typeof te=="function"?p.callback=te:p===r(c)&&n(c),g(F)}else n(c);p=r(c)}if(p!==null)var oe=!0;else{var me=r(u);me!==null&&O(b,me.startTime-F),oe=!1}return oe}finally{p=null,h=M,_=!1}}var A=!1,k=null,N=-1,R=5,S=-1;function B(){return!(e.unstable_now()-S<R)}function H(){if(k!==null){var $=e.unstable_now();S=$;var F=!0;try{F=k(!0,$)}finally{F?J():(A=!1,k=null)}}else A=!1}var J;if(typeof f=="function")J=function(){f(H)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,Y=V.port2;V.port1.onmessage=H,J=function(){Y.postMessage(null)}}else J=function(){w(H,0)};function ue($){k=$,A||(A=!0,J())}function O($,F){N=w(function(){$(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($){$.callback=null},e.unstable_continueExecution=function(){y||_||(y=!0,ue(L))},e.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<$?Math.floor(1e3/$):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function($){switch(h){case 1:case 2:case 3:var F=3;break;default:F=h}var M=h;h=F;try{return $()}finally{h=M}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function($,F){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var M=h;h=$;try{return F()}finally{h=M}},e.unstable_scheduleCallback=function($,F,M){var Q=e.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?Q+M:Q):M=Q,$){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=M+te,$={id:d++,callback:F,priorityLevel:$,startTime:M,expirationTime:te,sortIndex:-1},M>Q?($.sortIndex=M,t(u,$),r(c)===null&&$===r(u)&&(j?(m(N),N=-1):j=!0,O(b,M-Q))):($.sortIndex=te,t(c,$),y||_||(y=!0,ue(L))),$},e.unstable_shouldYield=B,e.unstable_wrapCallback=function($){var F=h;return function(){var M=h;h=F;try{return $.apply(this,arguments)}finally{h=M}}}})(Nd);Ed.exports=Nd;var Sm=Ed.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var km=v,St=Sm;function W(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Cd=new Set,js={};function an(e,t){Un(e,t),Un(e+"Capture",t)}function Un(e,t){for(js[e]=t,e=0;e<t.length;e++)Cd.add(t[e])}var ir=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mo=Object.prototype.hasOwnProperty,Em=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Tc={},Pc={};function Nm(e){return mo.call(Pc,e)?!0:mo.call(Tc,e)?!1:Em.test(e)?Pc[e]=!0:(Tc[e]=!0,!1)}function Cm(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Tm(e,t,r,n){if(t===null||typeof t>"u"||Cm(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ot(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Xe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Xe[e]=new ot(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Xe[t]=new ot(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Xe[e]=new ot(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Xe[e]=new ot(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Xe[e]=new ot(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Xe[e]=new ot(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Xe[e]=new ot(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Xe[e]=new ot(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Xe[e]=new ot(e,5,!1,e.toLowerCase(),null,!1,!1)});var Sl=/[\-:]([a-z])/g;function kl(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Sl,kl);Xe[t]=new ot(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Sl,kl);Xe[t]=new ot(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Sl,kl);Xe[t]=new ot(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Xe[e]=new ot(e,1,!1,e.toLowerCase(),null,!1,!1)});Xe.xlinkHref=new ot("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Xe[e]=new ot(e,1,!1,e.toLowerCase(),null,!0,!0)});function El(e,t,r,n){var a=Xe.hasOwnProperty(t)?Xe[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Tm(t,r,a,n)&&(r=null),n||a===null?Nm(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ur=km.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ta=Symbol.for("react.element"),yn=Symbol.for("react.portal"),wn=Symbol.for("react.fragment"),Nl=Symbol.for("react.strict_mode"),po=Symbol.for("react.profiler"),Td=Symbol.for("react.provider"),Pd=Symbol.for("react.context"),Cl=Symbol.for("react.forward_ref"),go=Symbol.for("react.suspense"),vo=Symbol.for("react.suspense_list"),Tl=Symbol.for("react.memo"),mr=Symbol.for("react.lazy"),Rd=Symbol.for("react.offscreen"),Rc=Symbol.iterator;function Xn(e){return e===null||typeof e!="object"?null:(e=Rc&&e[Rc]||e["@@iterator"],typeof e=="function"?e:null)}var Ae=Object.assign,Pi;function is(e){if(Pi===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Pi=t&&t[1]||""}return`
`+Pi+e}var Ri=!1;function Ai(e,t){if(!e||Ri)return"";Ri=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var c=`
`+a[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Ri=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?is(e):""}function Pm(e){switch(e.tag){case 5:return is(e.type);case 16:return is("Lazy");case 13:return is("Suspense");case 19:return is("SuspenseList");case 0:case 2:case 15:return e=Ai(e.type,!1),e;case 11:return e=Ai(e.type.render,!1),e;case 1:return e=Ai(e.type,!0),e;default:return""}}function yo(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case wn:return"Fragment";case yn:return"Portal";case po:return"Profiler";case Nl:return"StrictMode";case go:return"Suspense";case vo:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Pd:return(e.displayName||"Context")+".Consumer";case Td:return(e._context.displayName||"Context")+".Provider";case Cl:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Tl:return t=e.displayName||null,t!==null?t:yo(e.type)||"Memo";case mr:t=e._payload,e=e._init;try{return yo(e(t))}catch{}}return null}function Rm(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yo(t);case 8:return t===Nl?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ar(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ad(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Am(e){var t=Ad(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ra(e){e._valueTracker||(e._valueTracker=Am(e))}function Od(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Ad(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Oa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function wo(e,t){var r=t.checked;return Ae({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Ac(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ar(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Id(e,t){t=t.checked,t!=null&&El(e,"checked",t,!1)}function _o(e,t){Id(e,t);var r=Ar(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?xo(e,t.type,r):t.hasOwnProperty("defaultValue")&&xo(e,t.type,Ar(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Oc(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function xo(e,t,r){(t!=="number"||Oa(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var os=Array.isArray;function Rn(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ar(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function jo(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(W(91));return Ae({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ic(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(W(92));if(os(r)){if(1<r.length)throw Error(W(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ar(r)}}function Dd(e,t){var r=Ar(t.value),n=Ar(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Dc(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Ld(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bo(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Ld(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var na,$d=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(na=na||document.createElement("div"),na.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=na.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function bs(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ds={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Om=["Webkit","ms","Moz","O"];Object.keys(ds).forEach(function(e){Om.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ds[t]=ds[e]})});function Ud(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ds.hasOwnProperty(e)&&ds[e]?(""+t).trim():t+"px"}function Fd(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Ud(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var Im=Ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function So(e,t){if(t){if(Im[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(W(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(W(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(W(61))}if(t.style!=null&&typeof t.style!="object")throw Error(W(62))}}function ko(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Eo=null;function Pl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var No=null,An=null,On=null;function Lc(e){if(e=Qs(e)){if(typeof No!="function")throw Error(W(280));var t=e.stateNode;t&&(t=hi(t),No(e.stateNode,e.type,t))}}function Md(e){An?On?On.push(e):On=[e]:An=e}function Bd(){if(An){var e=An,t=On;if(On=An=null,Lc(e),t)for(e=0;e<t.length;e++)Lc(t[e])}}function zd(e,t){return e(t)}function Kd(){}var Oi=!1;function qd(e,t,r){if(Oi)return e(t,r);Oi=!0;try{return zd(e,t,r)}finally{Oi=!1,(An!==null||On!==null)&&(Kd(),Bd())}}function Ss(e,t){var r=e.stateNode;if(r===null)return null;var n=hi(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(W(231,t,typeof r));return r}var Co=!1;if(ir)try{var Zn={};Object.defineProperty(Zn,"passive",{get:function(){Co=!0}}),window.addEventListener("test",Zn,Zn),window.removeEventListener("test",Zn,Zn)}catch{Co=!1}function Dm(e,t,r,n,a,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var hs=!1,Ia=null,Da=!1,To=null,Lm={onError:function(e){hs=!0,Ia=e}};function $m(e,t,r,n,a,i,o,l,c){hs=!1,Ia=null,Dm.apply(Lm,arguments)}function Um(e,t,r,n,a,i,o,l,c){if($m.apply(this,arguments),hs){if(hs){var u=Ia;hs=!1,Ia=null}else throw Error(W(198));Da||(Da=!0,To=u)}}function on(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Wd(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function $c(e){if(on(e)!==e)throw Error(W(188))}function Fm(e){var t=e.alternate;if(!t){if(t=on(e),t===null)throw Error(W(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return $c(a),e;if(i===n)return $c(a),t;i=i.sibling}throw Error(W(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(W(189))}}if(r.alternate!==n)throw Error(W(190))}if(r.tag!==3)throw Error(W(188));return r.stateNode.current===r?e:t}function Hd(e){return e=Fm(e),e!==null?Vd(e):null}function Vd(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Vd(e);if(t!==null)return t;e=e.sibling}return null}var Jd=St.unstable_scheduleCallback,Uc=St.unstable_cancelCallback,Mm=St.unstable_shouldYield,Bm=St.unstable_requestPaint,$e=St.unstable_now,zm=St.unstable_getCurrentPriorityLevel,Rl=St.unstable_ImmediatePriority,Gd=St.unstable_UserBlockingPriority,La=St.unstable_NormalPriority,Km=St.unstable_LowPriority,Qd=St.unstable_IdlePriority,li=null,Qt=null;function qm(e){if(Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(li,e,void 0,(e.current.flags&128)===128)}catch{}}var Bt=Math.clz32?Math.clz32:Vm,Wm=Math.log,Hm=Math.LN2;function Vm(e){return e>>>=0,e===0?32:31-(Wm(e)/Hm|0)|0}var sa=64,aa=4194304;function ls(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $a(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=ls(l):(i&=o,i!==0&&(n=ls(i)))}else o=r&~a,o!==0?n=ls(o):i!==0&&(n=ls(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Bt(t),a=1<<r,n|=e[r],t&=~a;return n}function Jm(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gm(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Bt(i),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=Jm(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Po(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Yd(){var e=sa;return sa<<=1,!(sa&4194240)&&(sa=64),e}function Ii(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Js(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Bt(t),e[t]=r}function Qm(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Bt(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Al(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Bt(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var we=0;function Xd(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Zd,Ol,eh,th,rh,Ro=!1,ia=[],br=null,Sr=null,kr=null,ks=new Map,Es=new Map,vr=[],Ym="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fc(e,t){switch(e){case"focusin":case"focusout":br=null;break;case"dragenter":case"dragleave":Sr=null;break;case"mouseover":case"mouseout":kr=null;break;case"pointerover":case"pointerout":ks.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Es.delete(t.pointerId)}}function es(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Qs(t),t!==null&&Ol(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Xm(e,t,r,n,a){switch(t){case"focusin":return br=es(br,e,t,r,n,a),!0;case"dragenter":return Sr=es(Sr,e,t,r,n,a),!0;case"mouseover":return kr=es(kr,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return ks.set(i,es(ks.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Es.set(i,es(Es.get(i)||null,e,t,r,n,a)),!0}return!1}function nh(e){var t=Jr(e.target);if(t!==null){var r=on(t);if(r!==null){if(t=r.tag,t===13){if(t=Wd(r),t!==null){e.blockedOn=t,rh(e.priority,function(){eh(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ba(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ao(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Eo=n,r.target.dispatchEvent(n),Eo=null}else return t=Qs(r),t!==null&&Ol(t),e.blockedOn=r,!1;t.shift()}return!0}function Mc(e,t,r){ba(e)&&r.delete(t)}function Zm(){Ro=!1,br!==null&&ba(br)&&(br=null),Sr!==null&&ba(Sr)&&(Sr=null),kr!==null&&ba(kr)&&(kr=null),ks.forEach(Mc),Es.forEach(Mc)}function ts(e,t){e.blockedOn===t&&(e.blockedOn=null,Ro||(Ro=!0,St.unstable_scheduleCallback(St.unstable_NormalPriority,Zm)))}function Ns(e){function t(a){return ts(a,e)}if(0<ia.length){ts(ia[0],e);for(var r=1;r<ia.length;r++){var n=ia[r];n.blockedOn===e&&(n.blockedOn=null)}}for(br!==null&&ts(br,e),Sr!==null&&ts(Sr,e),kr!==null&&ts(kr,e),ks.forEach(t),Es.forEach(t),r=0;r<vr.length;r++)n=vr[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<vr.length&&(r=vr[0],r.blockedOn===null);)nh(r),r.blockedOn===null&&vr.shift()}var In=ur.ReactCurrentBatchConfig,Ua=!0;function ep(e,t,r,n){var a=we,i=In.transition;In.transition=null;try{we=1,Il(e,t,r,n)}finally{we=a,In.transition=i}}function tp(e,t,r,n){var a=we,i=In.transition;In.transition=null;try{we=4,Il(e,t,r,n)}finally{we=a,In.transition=i}}function Il(e,t,r,n){if(Ua){var a=Ao(e,t,r,n);if(a===null)qi(e,t,n,Fa,r),Fc(e,n);else if(Xm(a,e,t,r,n))n.stopPropagation();else if(Fc(e,n),t&4&&-1<Ym.indexOf(e)){for(;a!==null;){var i=Qs(a);if(i!==null&&Zd(i),i=Ao(e,t,r,n),i===null&&qi(e,t,n,Fa,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else qi(e,t,n,null,r)}}var Fa=null;function Ao(e,t,r,n){if(Fa=null,e=Pl(n),e=Jr(e),e!==null)if(t=on(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Wd(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Fa=e,null}function sh(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zm()){case Rl:return 1;case Gd:return 4;case La:case Km:return 16;case Qd:return 536870912;default:return 16}default:return 16}}var _r=null,Dl=null,Sa=null;function ah(){if(Sa)return Sa;var e,t=Dl,r=t.length,n,a="value"in _r?_r.value:_r.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return Sa=a.slice(e,1<n?1-n:void 0)}function ka(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function oa(){return!0}function Bc(){return!1}function Et(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?oa:Bc,this.isPropagationStopped=Bc,this}return Ae(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=oa)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=oa)},persist:function(){},isPersistent:oa}),t}var Hn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ll=Et(Hn),Gs=Ae({},Hn,{view:0,detail:0}),rp=Et(Gs),Di,Li,rs,ci=Ae({},Gs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$l,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==rs&&(rs&&e.type==="mousemove"?(Di=e.screenX-rs.screenX,Li=e.screenY-rs.screenY):Li=Di=0,rs=e),Di)},movementY:function(e){return"movementY"in e?e.movementY:Li}}),zc=Et(ci),np=Ae({},ci,{dataTransfer:0}),sp=Et(np),ap=Ae({},Gs,{relatedTarget:0}),$i=Et(ap),ip=Ae({},Hn,{animationName:0,elapsedTime:0,pseudoElement:0}),op=Et(ip),lp=Ae({},Hn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),cp=Et(lp),up=Ae({},Hn,{data:0}),Kc=Et(up),dp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=fp[e])?!!t[e]:!1}function $l(){return mp}var pp=Ae({},Gs,{key:function(e){if(e.key){var t=dp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ka(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?hp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$l,charCode:function(e){return e.type==="keypress"?ka(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ka(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),gp=Et(pp),vp=Ae({},ci,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qc=Et(vp),yp=Ae({},Gs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$l}),wp=Et(yp),_p=Ae({},Hn,{propertyName:0,elapsedTime:0,pseudoElement:0}),xp=Et(_p),jp=Ae({},ci,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),bp=Et(jp),Sp=[9,13,27,32],Ul=ir&&"CompositionEvent"in window,fs=null;ir&&"documentMode"in document&&(fs=document.documentMode);var kp=ir&&"TextEvent"in window&&!fs,ih=ir&&(!Ul||fs&&8<fs&&11>=fs),Wc=" ",Hc=!1;function oh(e,t){switch(e){case"keyup":return Sp.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var _n=!1;function Ep(e,t){switch(e){case"compositionend":return lh(t);case"keypress":return t.which!==32?null:(Hc=!0,Wc);case"textInput":return e=t.data,e===Wc&&Hc?null:e;default:return null}}function Np(e,t){if(_n)return e==="compositionend"||!Ul&&oh(e,t)?(e=ah(),Sa=Dl=_r=null,_n=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ih&&t.locale!=="ko"?null:t.data;default:return null}}var Cp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Cp[e.type]:t==="textarea"}function ch(e,t,r,n){Md(n),t=Ma(t,"onChange"),0<t.length&&(r=new Ll("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ms=null,Cs=null;function Tp(e){_h(e,0)}function ui(e){var t=bn(e);if(Od(t))return e}function Pp(e,t){if(e==="change")return t}var uh=!1;if(ir){var Ui;if(ir){var Fi="oninput"in document;if(!Fi){var Jc=document.createElement("div");Jc.setAttribute("oninput","return;"),Fi=typeof Jc.oninput=="function"}Ui=Fi}else Ui=!1;uh=Ui&&(!document.documentMode||9<document.documentMode)}function Gc(){ms&&(ms.detachEvent("onpropertychange",dh),Cs=ms=null)}function dh(e){if(e.propertyName==="value"&&ui(Cs)){var t=[];ch(t,Cs,e,Pl(e)),qd(Tp,t)}}function Rp(e,t,r){e==="focusin"?(Gc(),ms=t,Cs=r,ms.attachEvent("onpropertychange",dh)):e==="focusout"&&Gc()}function Ap(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ui(Cs)}function Op(e,t){if(e==="click")return ui(t)}function Ip(e,t){if(e==="input"||e==="change")return ui(t)}function Dp(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Kt=typeof Object.is=="function"?Object.is:Dp;function Ts(e,t){if(Kt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!mo.call(t,a)||!Kt(e[a],t[a]))return!1}return!0}function Qc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Yc(e,t){var r=Qc(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qc(r)}}function hh(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?hh(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function fh(){for(var e=window,t=Oa();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Oa(e.document)}return t}function Fl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Lp(e){var t=fh(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&hh(r.ownerDocument.documentElement,r)){if(n!==null&&Fl(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=Yc(r,i);var o=Yc(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var $p=ir&&"documentMode"in document&&11>=document.documentMode,xn=null,Oo=null,ps=null,Io=!1;function Xc(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Io||xn==null||xn!==Oa(n)||(n=xn,"selectionStart"in n&&Fl(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ps&&Ts(ps,n)||(ps=n,n=Ma(Oo,"onSelect"),0<n.length&&(t=new Ll("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=xn)))}function la(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var jn={animationend:la("Animation","AnimationEnd"),animationiteration:la("Animation","AnimationIteration"),animationstart:la("Animation","AnimationStart"),transitionend:la("Transition","TransitionEnd")},Mi={},mh={};ir&&(mh=document.createElement("div").style,"AnimationEvent"in window||(delete jn.animationend.animation,delete jn.animationiteration.animation,delete jn.animationstart.animation),"TransitionEvent"in window||delete jn.transitionend.transition);function di(e){if(Mi[e])return Mi[e];if(!jn[e])return e;var t=jn[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in mh)return Mi[e]=t[r];return e}var ph=di("animationend"),gh=di("animationiteration"),vh=di("animationstart"),yh=di("transitionend"),wh=new Map,Zc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ir(e,t){wh.set(e,t),an(t,[e])}for(var Bi=0;Bi<Zc.length;Bi++){var zi=Zc[Bi],Up=zi.toLowerCase(),Fp=zi[0].toUpperCase()+zi.slice(1);Ir(Up,"on"+Fp)}Ir(ph,"onAnimationEnd");Ir(gh,"onAnimationIteration");Ir(vh,"onAnimationStart");Ir("dblclick","onDoubleClick");Ir("focusin","onFocus");Ir("focusout","onBlur");Ir(yh,"onTransitionEnd");Un("onMouseEnter",["mouseout","mouseover"]);Un("onMouseLeave",["mouseout","mouseover"]);Un("onPointerEnter",["pointerout","pointerover"]);Un("onPointerLeave",["pointerout","pointerover"]);an("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));an("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));an("onBeforeInput",["compositionend","keypress","textInput","paste"]);an("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));an("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));an("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mp=new Set("cancel close invalid load scroll toggle".split(" ").concat(cs));function eu(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Um(n,t,void 0,e),e.currentTarget=null}function _h(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;eu(a,l,u),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;eu(a,l,u),i=c}}}if(Da)throw e=To,Da=!1,To=null,e}function Ee(e,t){var r=t[Fo];r===void 0&&(r=t[Fo]=new Set);var n=e+"__bubble";r.has(n)||(xh(t,e,2,!1),r.add(n))}function Ki(e,t,r){var n=0;t&&(n|=4),xh(r,e,n,t)}var ca="_reactListening"+Math.random().toString(36).slice(2);function Ps(e){if(!e[ca]){e[ca]=!0,Cd.forEach(function(r){r!=="selectionchange"&&(Mp.has(r)||Ki(r,!1,e),Ki(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ca]||(t[ca]=!0,Ki("selectionchange",!1,t))}}function xh(e,t,r,n){switch(sh(t)){case 1:var a=ep;break;case 4:a=tp;break;default:a=Il}r=a.bind(null,t,r,e),a=void 0,!Co||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function qi(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=Jr(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}qd(function(){var u=i,d=Pl(r),p=[];e:{var h=wh.get(e);if(h!==void 0){var _=Ll,y=e;switch(e){case"keypress":if(ka(r)===0)break e;case"keydown":case"keyup":_=gp;break;case"focusin":y="focus",_=$i;break;case"focusout":y="blur",_=$i;break;case"beforeblur":case"afterblur":_=$i;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=zc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=sp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=wp;break;case ph:case gh:case vh:_=op;break;case yh:_=xp;break;case"scroll":_=rp;break;case"wheel":_=bp;break;case"copy":case"cut":case"paste":_=cp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=qc}var j=(t&4)!==0,w=!j&&e==="scroll",m=j?h!==null?h+"Capture":null:h;j=[];for(var f=u,g;f!==null;){g=f;var b=g.stateNode;if(g.tag===5&&b!==null&&(g=b,m!==null&&(b=Ss(f,m),b!=null&&j.push(Rs(f,b,g)))),w)break;f=f.return}0<j.length&&(h=new _(h,y,null,r,d),p.push({event:h,listeners:j}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",_=e==="mouseout"||e==="pointerout",h&&r!==Eo&&(y=r.relatedTarget||r.fromElement)&&(Jr(y)||y[or]))break e;if((_||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,_?(y=r.relatedTarget||r.toElement,_=u,y=y?Jr(y):null,y!==null&&(w=on(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(_=null,y=u),_!==y)){if(j=zc,b="onMouseLeave",m="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(j=qc,b="onPointerLeave",m="onPointerEnter",f="pointer"),w=_==null?h:bn(_),g=y==null?h:bn(y),h=new j(b,f+"leave",_,r,d),h.target=w,h.relatedTarget=g,b=null,Jr(d)===u&&(j=new j(m,f+"enter",y,r,d),j.target=g,j.relatedTarget=w,b=j),w=b,_&&y)t:{for(j=_,m=y,f=0,g=j;g;g=ln(g))f++;for(g=0,b=m;b;b=ln(b))g++;for(;0<f-g;)j=ln(j),f--;for(;0<g-f;)m=ln(m),g--;for(;f--;){if(j===m||m!==null&&j===m.alternate)break t;j=ln(j),m=ln(m)}j=null}else j=null;_!==null&&tu(p,h,_,j,!1),y!==null&&w!==null&&tu(p,w,y,j,!0)}}e:{if(h=u?bn(u):window,_=h.nodeName&&h.nodeName.toLowerCase(),_==="select"||_==="input"&&h.type==="file")var L=Pp;else if(Vc(h))if(uh)L=Ip;else{L=Ap;var A=Rp}else(_=h.nodeName)&&_.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(L=Op);if(L&&(L=L(e,u))){ch(p,L,r,d);break e}A&&A(e,h,u),e==="focusout"&&(A=h._wrapperState)&&A.controlled&&h.type==="number"&&xo(h,"number",h.value)}switch(A=u?bn(u):window,e){case"focusin":(Vc(A)||A.contentEditable==="true")&&(xn=A,Oo=u,ps=null);break;case"focusout":ps=Oo=xn=null;break;case"mousedown":Io=!0;break;case"contextmenu":case"mouseup":case"dragend":Io=!1,Xc(p,r,d);break;case"selectionchange":if($p)break;case"keydown":case"keyup":Xc(p,r,d)}var k;if(Ul)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else _n?oh(e,r)&&(N="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(N="onCompositionStart");N&&(ih&&r.locale!=="ko"&&(_n||N!=="onCompositionStart"?N==="onCompositionEnd"&&_n&&(k=ah()):(_r=d,Dl="value"in _r?_r.value:_r.textContent,_n=!0)),A=Ma(u,N),0<A.length&&(N=new Kc(N,e,null,r,d),p.push({event:N,listeners:A}),k?N.data=k:(k=lh(r),k!==null&&(N.data=k)))),(k=kp?Ep(e,r):Np(e,r))&&(u=Ma(u,"onBeforeInput"),0<u.length&&(d=new Kc("onBeforeInput","beforeinput",null,r,d),p.push({event:d,listeners:u}),d.data=k))}_h(p,t)})}function Rs(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ma(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Ss(e,r),i!=null&&n.unshift(Rs(e,i,a)),i=Ss(e,t),i!=null&&n.push(Rs(e,i,a))),e=e.return}return n}function ln(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function tu(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,a?(c=Ss(r,i),c!=null&&o.unshift(Rs(r,c,l))):a||(c=Ss(r,i),c!=null&&o.push(Rs(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var Bp=/\r\n?/g,zp=/\u0000|\uFFFD/g;function ru(e){return(typeof e=="string"?e:""+e).replace(Bp,`
`).replace(zp,"")}function ua(e,t,r){if(t=ru(t),ru(e)!==t&&r)throw Error(W(425))}function Ba(){}var Do=null,Lo=null;function $o(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Uo=typeof setTimeout=="function"?setTimeout:void 0,Kp=typeof clearTimeout=="function"?clearTimeout:void 0,nu=typeof Promise=="function"?Promise:void 0,qp=typeof queueMicrotask=="function"?queueMicrotask:typeof nu<"u"?function(e){return nu.resolve(null).then(e).catch(Wp)}:Uo;function Wp(e){setTimeout(function(){throw e})}function Wi(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Ns(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Ns(t)}function Er(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function su(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Vn=Math.random().toString(36).slice(2),Gt="__reactFiber$"+Vn,As="__reactProps$"+Vn,or="__reactContainer$"+Vn,Fo="__reactEvents$"+Vn,Hp="__reactListeners$"+Vn,Vp="__reactHandles$"+Vn;function Jr(e){var t=e[Gt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[or]||r[Gt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=su(e);e!==null;){if(r=e[Gt])return r;e=su(e)}return t}e=r,r=e.parentNode}return null}function Qs(e){return e=e[Gt]||e[or],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function bn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(W(33))}function hi(e){return e[As]||null}var Mo=[],Sn=-1;function Dr(e){return{current:e}}function Ne(e){0>Sn||(e.current=Mo[Sn],Mo[Sn]=null,Sn--)}function ke(e,t){Sn++,Mo[Sn]=e.current,e.current=t}var Or={},nt=Dr(Or),ht=Dr(!1),en=Or;function Fn(e,t){var r=e.type.contextTypes;if(!r)return Or;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function ft(e){return e=e.childContextTypes,e!=null}function za(){Ne(ht),Ne(nt)}function au(e,t,r){if(nt.current!==Or)throw Error(W(168));ke(nt,t),ke(ht,r)}function jh(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(W(108,Rm(e)||"Unknown",a));return Ae({},r,n)}function Ka(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Or,en=nt.current,ke(nt,e),ke(ht,ht.current),!0}function iu(e,t,r){var n=e.stateNode;if(!n)throw Error(W(169));r?(e=jh(e,t,en),n.__reactInternalMemoizedMergedChildContext=e,Ne(ht),Ne(nt),ke(nt,e)):Ne(ht),ke(ht,r)}var rr=null,fi=!1,Hi=!1;function bh(e){rr===null?rr=[e]:rr.push(e)}function Jp(e){fi=!0,bh(e)}function Lr(){if(!Hi&&rr!==null){Hi=!0;var e=0,t=we;try{var r=rr;for(we=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}rr=null,fi=!1}catch(a){throw rr!==null&&(rr=rr.slice(e+1)),Jd(Rl,Lr),a}finally{we=t,Hi=!1}}return null}var kn=[],En=0,qa=null,Wa=0,Nt=[],Ct=0,tn=null,nr=1,sr="";function Kr(e,t){kn[En++]=Wa,kn[En++]=qa,qa=e,Wa=t}function Sh(e,t,r){Nt[Ct++]=nr,Nt[Ct++]=sr,Nt[Ct++]=tn,tn=e;var n=nr;e=sr;var a=32-Bt(n)-1;n&=~(1<<a),r+=1;var i=32-Bt(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,nr=1<<32-Bt(t)+a|r<<a|n,sr=i+e}else nr=1<<i|r<<a|n,sr=e}function Ml(e){e.return!==null&&(Kr(e,1),Sh(e,1,0))}function Bl(e){for(;e===qa;)qa=kn[--En],kn[En]=null,Wa=kn[--En],kn[En]=null;for(;e===tn;)tn=Nt[--Ct],Nt[Ct]=null,sr=Nt[--Ct],Nt[Ct]=null,nr=Nt[--Ct],Nt[Ct]=null}var bt=null,jt=null,Ce=!1,Mt=null;function kh(e,t){var r=Tt(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ou(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,bt=e,jt=Er(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,bt=e,jt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=tn!==null?{id:nr,overflow:sr}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Tt(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,bt=e,jt=null,!0):!1;default:return!1}}function Bo(e){return(e.mode&1)!==0&&(e.flags&128)===0}function zo(e){if(Ce){var t=jt;if(t){var r=t;if(!ou(e,t)){if(Bo(e))throw Error(W(418));t=Er(r.nextSibling);var n=bt;t&&ou(e,t)?kh(n,r):(e.flags=e.flags&-4097|2,Ce=!1,bt=e)}}else{if(Bo(e))throw Error(W(418));e.flags=e.flags&-4097|2,Ce=!1,bt=e}}}function lu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;bt=e}function da(e){if(e!==bt)return!1;if(!Ce)return lu(e),Ce=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!$o(e.type,e.memoizedProps)),t&&(t=jt)){if(Bo(e))throw Eh(),Error(W(418));for(;t;)kh(e,t),t=Er(t.nextSibling)}if(lu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(W(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){jt=Er(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}jt=null}}else jt=bt?Er(e.stateNode.nextSibling):null;return!0}function Eh(){for(var e=jt;e;)e=Er(e.nextSibling)}function Mn(){jt=bt=null,Ce=!1}function zl(e){Mt===null?Mt=[e]:Mt.push(e)}var Gp=ur.ReactCurrentBatchConfig;function ns(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(W(309));var n=r.stateNode}if(!n)throw Error(W(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(W(284));if(!r._owner)throw Error(W(290,e))}return e}function ha(e,t){throw e=Object.prototype.toString.call(t),Error(W(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function cu(e){var t=e._init;return t(e._payload)}function Nh(e){function t(m,f){if(e){var g=m.deletions;g===null?(m.deletions=[f],m.flags|=16):g.push(f)}}function r(m,f){if(!e)return null;for(;f!==null;)t(m,f),f=f.sibling;return null}function n(m,f){for(m=new Map;f!==null;)f.key!==null?m.set(f.key,f):m.set(f.index,f),f=f.sibling;return m}function a(m,f){return m=Pr(m,f),m.index=0,m.sibling=null,m}function i(m,f,g){return m.index=g,e?(g=m.alternate,g!==null?(g=g.index,g<f?(m.flags|=2,f):g):(m.flags|=2,f)):(m.flags|=1048576,f)}function o(m){return e&&m.alternate===null&&(m.flags|=2),m}function l(m,f,g,b){return f===null||f.tag!==6?(f=Zi(g,m.mode,b),f.return=m,f):(f=a(f,g),f.return=m,f)}function c(m,f,g,b){var L=g.type;return L===wn?d(m,f,g.props.children,b,g.key):f!==null&&(f.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===mr&&cu(L)===f.type)?(b=a(f,g.props),b.ref=ns(m,f,g),b.return=m,b):(b=Aa(g.type,g.key,g.props,null,m.mode,b),b.ref=ns(m,f,g),b.return=m,b)}function u(m,f,g,b){return f===null||f.tag!==4||f.stateNode.containerInfo!==g.containerInfo||f.stateNode.implementation!==g.implementation?(f=eo(g,m.mode,b),f.return=m,f):(f=a(f,g.children||[]),f.return=m,f)}function d(m,f,g,b,L){return f===null||f.tag!==7?(f=Zr(g,m.mode,b,L),f.return=m,f):(f=a(f,g),f.return=m,f)}function p(m,f,g){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Zi(""+f,m.mode,g),f.return=m,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case ta:return g=Aa(f.type,f.key,f.props,null,m.mode,g),g.ref=ns(m,null,f),g.return=m,g;case yn:return f=eo(f,m.mode,g),f.return=m,f;case mr:var b=f._init;return p(m,b(f._payload),g)}if(os(f)||Xn(f))return f=Zr(f,m.mode,g,null),f.return=m,f;ha(m,f)}return null}function h(m,f,g,b){var L=f!==null?f.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return L!==null?null:l(m,f,""+g,b);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case ta:return g.key===L?c(m,f,g,b):null;case yn:return g.key===L?u(m,f,g,b):null;case mr:return L=g._init,h(m,f,L(g._payload),b)}if(os(g)||Xn(g))return L!==null?null:d(m,f,g,b,null);ha(m,g)}return null}function _(m,f,g,b,L){if(typeof b=="string"&&b!==""||typeof b=="number")return m=m.get(g)||null,l(f,m,""+b,L);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ta:return m=m.get(b.key===null?g:b.key)||null,c(f,m,b,L);case yn:return m=m.get(b.key===null?g:b.key)||null,u(f,m,b,L);case mr:var A=b._init;return _(m,f,g,A(b._payload),L)}if(os(b)||Xn(b))return m=m.get(g)||null,d(f,m,b,L,null);ha(f,b)}return null}function y(m,f,g,b){for(var L=null,A=null,k=f,N=f=0,R=null;k!==null&&N<g.length;N++){k.index>N?(R=k,k=null):R=k.sibling;var S=h(m,k,g[N],b);if(S===null){k===null&&(k=R);break}e&&k&&S.alternate===null&&t(m,k),f=i(S,f,N),A===null?L=S:A.sibling=S,A=S,k=R}if(N===g.length)return r(m,k),Ce&&Kr(m,N),L;if(k===null){for(;N<g.length;N++)k=p(m,g[N],b),k!==null&&(f=i(k,f,N),A===null?L=k:A.sibling=k,A=k);return Ce&&Kr(m,N),L}for(k=n(m,k);N<g.length;N++)R=_(k,m,N,g[N],b),R!==null&&(e&&R.alternate!==null&&k.delete(R.key===null?N:R.key),f=i(R,f,N),A===null?L=R:A.sibling=R,A=R);return e&&k.forEach(function(B){return t(m,B)}),Ce&&Kr(m,N),L}function j(m,f,g,b){var L=Xn(g);if(typeof L!="function")throw Error(W(150));if(g=L.call(g),g==null)throw Error(W(151));for(var A=L=null,k=f,N=f=0,R=null,S=g.next();k!==null&&!S.done;N++,S=g.next()){k.index>N?(R=k,k=null):R=k.sibling;var B=h(m,k,S.value,b);if(B===null){k===null&&(k=R);break}e&&k&&B.alternate===null&&t(m,k),f=i(B,f,N),A===null?L=B:A.sibling=B,A=B,k=R}if(S.done)return r(m,k),Ce&&Kr(m,N),L;if(k===null){for(;!S.done;N++,S=g.next())S=p(m,S.value,b),S!==null&&(f=i(S,f,N),A===null?L=S:A.sibling=S,A=S);return Ce&&Kr(m,N),L}for(k=n(m,k);!S.done;N++,S=g.next())S=_(k,m,N,S.value,b),S!==null&&(e&&S.alternate!==null&&k.delete(S.key===null?N:S.key),f=i(S,f,N),A===null?L=S:A.sibling=S,A=S);return e&&k.forEach(function(H){return t(m,H)}),Ce&&Kr(m,N),L}function w(m,f,g,b){if(typeof g=="object"&&g!==null&&g.type===wn&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case ta:e:{for(var L=g.key,A=f;A!==null;){if(A.key===L){if(L=g.type,L===wn){if(A.tag===7){r(m,A.sibling),f=a(A,g.props.children),f.return=m,m=f;break e}}else if(A.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===mr&&cu(L)===A.type){r(m,A.sibling),f=a(A,g.props),f.ref=ns(m,A,g),f.return=m,m=f;break e}r(m,A);break}else t(m,A);A=A.sibling}g.type===wn?(f=Zr(g.props.children,m.mode,b,g.key),f.return=m,m=f):(b=Aa(g.type,g.key,g.props,null,m.mode,b),b.ref=ns(m,f,g),b.return=m,m=b)}return o(m);case yn:e:{for(A=g.key;f!==null;){if(f.key===A)if(f.tag===4&&f.stateNode.containerInfo===g.containerInfo&&f.stateNode.implementation===g.implementation){r(m,f.sibling),f=a(f,g.children||[]),f.return=m,m=f;break e}else{r(m,f);break}else t(m,f);f=f.sibling}f=eo(g,m.mode,b),f.return=m,m=f}return o(m);case mr:return A=g._init,w(m,f,A(g._payload),b)}if(os(g))return y(m,f,g,b);if(Xn(g))return j(m,f,g,b);ha(m,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,f!==null&&f.tag===6?(r(m,f.sibling),f=a(f,g),f.return=m,m=f):(r(m,f),f=Zi(g,m.mode,b),f.return=m,m=f),o(m)):r(m,f)}return w}var Bn=Nh(!0),Ch=Nh(!1),Ha=Dr(null),Va=null,Nn=null,Kl=null;function ql(){Kl=Nn=Va=null}function Wl(e){var t=Ha.current;Ne(Ha),e._currentValue=t}function Ko(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Dn(e,t){Va=e,Kl=Nn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(dt=!0),e.firstContext=null)}function Rt(e){var t=e._currentValue;if(Kl!==e)if(e={context:e,memoizedValue:t,next:null},Nn===null){if(Va===null)throw Error(W(308));Nn=e,Va.dependencies={lanes:0,firstContext:e}}else Nn=Nn.next=e;return t}var Gr=null;function Hl(e){Gr===null?Gr=[e]:Gr.push(e)}function Th(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Hl(t)):(r.next=a.next,a.next=r),t.interleaved=r,lr(e,n)}function lr(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var pr=!1;function Vl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ph(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ar(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Nr(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ge&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,lr(e,r)}return a=n.interleaved,a===null?(t.next=t,Hl(n)):(t.next=a.next,a.next=t),n.interleaved=t,lr(e,r)}function Ea(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Al(e,r)}}function uu(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ja(e,t,r,n){var a=e.updateQueue;pr=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var p=a.baseState;o=0,d=u=c=null,l=i;do{var h=l.lane,_=l.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:_,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,j=l;switch(h=t,_=r,j.tag){case 1:if(y=j.payload,typeof y=="function"){p=y.call(_,p,h);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=j.payload,h=typeof y=="function"?y.call(_,p,h):y,h==null)break e;p=Ae({},p,h);break e;case 2:pr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[l]:h.push(l))}else _={eventTime:_,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=_,c=p):d=d.next=_,o|=h;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;h=l,l=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(d===null&&(c=p),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);nn|=o,e.lanes=o,e.memoizedState=p}}function du(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(W(191,a));a.call(n)}}}var Ys={},Yt=Dr(Ys),Os=Dr(Ys),Is=Dr(Ys);function Qr(e){if(e===Ys)throw Error(W(174));return e}function Jl(e,t){switch(ke(Is,t),ke(Os,e),ke(Yt,Ys),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:bo(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=bo(t,e)}Ne(Yt),ke(Yt,t)}function zn(){Ne(Yt),Ne(Os),Ne(Is)}function Rh(e){Qr(Is.current);var t=Qr(Yt.current),r=bo(t,e.type);t!==r&&(ke(Os,e),ke(Yt,r))}function Gl(e){Os.current===e&&(Ne(Yt),Ne(Os))}var Pe=Dr(0);function Ga(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vi=[];function Ql(){for(var e=0;e<Vi.length;e++)Vi[e]._workInProgressVersionPrimary=null;Vi.length=0}var Na=ur.ReactCurrentDispatcher,Ji=ur.ReactCurrentBatchConfig,rn=0,Re=null,ze=null,He=null,Qa=!1,gs=!1,Ds=0,Qp=0;function et(){throw Error(W(321))}function Yl(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Kt(e[r],t[r]))return!1;return!0}function Xl(e,t,r,n,a,i){if(rn=i,Re=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Na.current=e===null||e.memoizedState===null?eg:tg,e=r(n,a),gs){i=0;do{if(gs=!1,Ds=0,25<=i)throw Error(W(301));i+=1,He=ze=null,t.updateQueue=null,Na.current=rg,e=r(n,a)}while(gs)}if(Na.current=Ya,t=ze!==null&&ze.next!==null,rn=0,He=ze=Re=null,Qa=!1,t)throw Error(W(300));return e}function Zl(){var e=Ds!==0;return Ds=0,e}function Jt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return He===null?Re.memoizedState=He=e:He=He.next=e,He}function At(){if(ze===null){var e=Re.alternate;e=e!==null?e.memoizedState:null}else e=ze.next;var t=He===null?Re.memoizedState:He.next;if(t!==null)He=t,ze=e;else{if(e===null)throw Error(W(310));ze=e,e={memoizedState:ze.memoizedState,baseState:ze.baseState,baseQueue:ze.baseQueue,queue:ze.queue,next:null},He===null?Re.memoizedState=He=e:He=He.next=e}return He}function Ls(e,t){return typeof t=="function"?t(e):t}function Gi(e){var t=At(),r=t.queue;if(r===null)throw Error(W(311));r.lastRenderedReducer=e;var n=ze,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((rn&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=p,o=n):c=c.next=p,Re.lanes|=d,nn|=d}u=u.next}while(u!==null&&u!==i);c===null?o=n:c.next=l,Kt(n,t.memoizedState)||(dt=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Re.lanes|=i,nn|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Qi(e){var t=At(),r=t.queue;if(r===null)throw Error(W(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);Kt(i,t.memoizedState)||(dt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Ah(){}function Oh(e,t){var r=Re,n=At(),a=t(),i=!Kt(n.memoizedState,a);if(i&&(n.memoizedState=a,dt=!0),n=n.queue,ec(Lh.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||He!==null&&He.memoizedState.tag&1){if(r.flags|=2048,$s(9,Dh.bind(null,r,n,a,t),void 0,null),Ve===null)throw Error(W(349));rn&30||Ih(r,t,a)}return a}function Ih(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Re.updateQueue,t===null?(t={lastEffect:null,stores:null},Re.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Dh(e,t,r,n){t.value=r,t.getSnapshot=n,$h(t)&&Uh(e)}function Lh(e,t,r){return r(function(){$h(t)&&Uh(e)})}function $h(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Kt(e,r)}catch{return!0}}function Uh(e){var t=lr(e,1);t!==null&&zt(t,e,1,-1)}function hu(e){var t=Jt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ls,lastRenderedState:e},t.queue=e,e=e.dispatch=Zp.bind(null,Re,e),[t.memoizedState,e]}function $s(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Re.updateQueue,t===null?(t={lastEffect:null,stores:null},Re.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Fh(){return At().memoizedState}function Ca(e,t,r,n){var a=Jt();Re.flags|=e,a.memoizedState=$s(1|t,r,void 0,n===void 0?null:n)}function mi(e,t,r,n){var a=At();n=n===void 0?null:n;var i=void 0;if(ze!==null){var o=ze.memoizedState;if(i=o.destroy,n!==null&&Yl(n,o.deps)){a.memoizedState=$s(t,r,i,n);return}}Re.flags|=e,a.memoizedState=$s(1|t,r,i,n)}function fu(e,t){return Ca(8390656,8,e,t)}function ec(e,t){return mi(2048,8,e,t)}function Mh(e,t){return mi(4,2,e,t)}function Bh(e,t){return mi(4,4,e,t)}function zh(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Kh(e,t,r){return r=r!=null?r.concat([e]):null,mi(4,4,zh.bind(null,t,e),r)}function tc(){}function qh(e,t){var r=At();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Yl(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Wh(e,t){var r=At();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Yl(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Hh(e,t,r){return rn&21?(Kt(r,t)||(r=Yd(),Re.lanes|=r,nn|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,dt=!0),e.memoizedState=r)}function Yp(e,t){var r=we;we=r!==0&&4>r?r:4,e(!0);var n=Ji.transition;Ji.transition={};try{e(!1),t()}finally{we=r,Ji.transition=n}}function Vh(){return At().memoizedState}function Xp(e,t,r){var n=Tr(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Jh(e))Gh(t,r);else if(r=Th(e,t,r,n),r!==null){var a=at();zt(r,e,n,a),Qh(r,t,n)}}function Zp(e,t,r){var n=Tr(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Jh(e))Gh(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,Kt(l,o)){var c=t.interleaved;c===null?(a.next=a,Hl(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=Th(e,t,a,n),r!==null&&(a=at(),zt(r,e,n,a),Qh(r,t,n))}}function Jh(e){var t=e.alternate;return e===Re||t!==null&&t===Re}function Gh(e,t){gs=Qa=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Qh(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Al(e,r)}}var Ya={readContext:Rt,useCallback:et,useContext:et,useEffect:et,useImperativeHandle:et,useInsertionEffect:et,useLayoutEffect:et,useMemo:et,useReducer:et,useRef:et,useState:et,useDebugValue:et,useDeferredValue:et,useTransition:et,useMutableSource:et,useSyncExternalStore:et,useId:et,unstable_isNewReconciler:!1},eg={readContext:Rt,useCallback:function(e,t){return Jt().memoizedState=[e,t===void 0?null:t],e},useContext:Rt,useEffect:fu,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Ca(4194308,4,zh.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ca(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ca(4,2,e,t)},useMemo:function(e,t){var r=Jt();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Jt();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Xp.bind(null,Re,e),[n.memoizedState,e]},useRef:function(e){var t=Jt();return e={current:e},t.memoizedState=e},useState:hu,useDebugValue:tc,useDeferredValue:function(e){return Jt().memoizedState=e},useTransition:function(){var e=hu(!1),t=e[0];return e=Yp.bind(null,e[1]),Jt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Re,a=Jt();if(Ce){if(r===void 0)throw Error(W(407));r=r()}else{if(r=t(),Ve===null)throw Error(W(349));rn&30||Ih(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,fu(Lh.bind(null,n,i,e),[e]),n.flags|=2048,$s(9,Dh.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Jt(),t=Ve.identifierPrefix;if(Ce){var r=sr,n=nr;r=(n&~(1<<32-Bt(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ds++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Qp++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},tg={readContext:Rt,useCallback:qh,useContext:Rt,useEffect:ec,useImperativeHandle:Kh,useInsertionEffect:Mh,useLayoutEffect:Bh,useMemo:Wh,useReducer:Gi,useRef:Fh,useState:function(){return Gi(Ls)},useDebugValue:tc,useDeferredValue:function(e){var t=At();return Hh(t,ze.memoizedState,e)},useTransition:function(){var e=Gi(Ls)[0],t=At().memoizedState;return[e,t]},useMutableSource:Ah,useSyncExternalStore:Oh,useId:Vh,unstable_isNewReconciler:!1},rg={readContext:Rt,useCallback:qh,useContext:Rt,useEffect:ec,useImperativeHandle:Kh,useInsertionEffect:Mh,useLayoutEffect:Bh,useMemo:Wh,useReducer:Qi,useRef:Fh,useState:function(){return Qi(Ls)},useDebugValue:tc,useDeferredValue:function(e){var t=At();return ze===null?t.memoizedState=e:Hh(t,ze.memoizedState,e)},useTransition:function(){var e=Qi(Ls)[0],t=At().memoizedState;return[e,t]},useMutableSource:Ah,useSyncExternalStore:Oh,useId:Vh,unstable_isNewReconciler:!1};function Lt(e,t){if(e&&e.defaultProps){t=Ae({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function qo(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ae({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var pi={isMounted:function(e){return(e=e._reactInternals)?on(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=at(),a=Tr(e),i=ar(n,a);i.payload=t,r!=null&&(i.callback=r),t=Nr(e,i,a),t!==null&&(zt(t,e,a,n),Ea(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=at(),a=Tr(e),i=ar(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Nr(e,i,a),t!==null&&(zt(t,e,a,n),Ea(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=at(),n=Tr(e),a=ar(r,n);a.tag=2,t!=null&&(a.callback=t),t=Nr(e,a,n),t!==null&&(zt(t,e,n,r),Ea(t,e,n))}};function mu(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!Ts(r,n)||!Ts(a,i):!0}function Yh(e,t,r){var n=!1,a=Or,i=t.contextType;return typeof i=="object"&&i!==null?i=Rt(i):(a=ft(t)?en:nt.current,n=t.contextTypes,i=(n=n!=null)?Fn(e,a):Or),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=pi,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function pu(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&pi.enqueueReplaceState(t,t.state,null)}function Wo(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Vl(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Rt(i):(i=ft(t)?en:nt.current,a.context=Fn(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(qo(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&pi.enqueueReplaceState(a,a.state,null),Ja(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Kn(e,t){try{var r="",n=t;do r+=Pm(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Yi(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Ho(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ng=typeof WeakMap=="function"?WeakMap:Map;function Xh(e,t,r){r=ar(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Za||(Za=!0,rl=n),Ho(e,t)},r}function Zh(e,t,r){r=ar(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Ho(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Ho(e,t),typeof n!="function"&&(Cr===null?Cr=new Set([this]):Cr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function gu(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new ng;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=vg.bind(null,e,t,r),t.then(e,e))}function vu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function yu(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ar(-1,1),t.tag=2,Nr(r,t,1))),r.lanes|=1),e)}var sg=ur.ReactCurrentOwner,dt=!1;function st(e,t,r,n){t.child=e===null?Ch(t,null,r,n):Bn(t,e.child,r,n)}function wu(e,t,r,n,a){r=r.render;var i=t.ref;return Dn(t,a),n=Xl(e,t,r,n,i,a),r=Zl(),e!==null&&!dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,cr(e,t,a)):(Ce&&r&&Ml(t),t.flags|=1,st(e,t,n,a),t.child)}function _u(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!cc(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,ef(e,t,i,n,a)):(e=Aa(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Ts,r(o,n)&&e.ref===t.ref)return cr(e,t,a)}return t.flags|=1,e=Pr(i,n),e.ref=t.ref,e.return=t,t.child=e}function ef(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Ts(i,n)&&e.ref===t.ref)if(dt=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(dt=!0);else return t.lanes=e.lanes,cr(e,t,a)}return Vo(e,t,r,n,a)}function tf(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ke(Tn,wt),wt|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ke(Tn,wt),wt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,ke(Tn,wt),wt|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,ke(Tn,wt),wt|=n;return st(e,t,a,r),t.child}function rf(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Vo(e,t,r,n,a){var i=ft(r)?en:nt.current;return i=Fn(t,i),Dn(t,a),r=Xl(e,t,r,n,i,a),n=Zl(),e!==null&&!dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,cr(e,t,a)):(Ce&&n&&Ml(t),t.flags|=1,st(e,t,r,a),t.child)}function xu(e,t,r,n,a){if(ft(r)){var i=!0;Ka(t)}else i=!1;if(Dn(t,a),t.stateNode===null)Ta(e,t),Yh(t,r,n),Wo(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Rt(u):(u=ft(r)?en:nt.current,u=Fn(t,u));var d=r.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&pu(t,o,n,u),pr=!1;var h=t.memoizedState;o.state=h,Ja(t,n,o,a),c=t.memoizedState,l!==n||h!==c||ht.current||pr?(typeof d=="function"&&(qo(t,r,d,n),c=t.memoizedState),(l=pr||mu(t,r,l,n,h,c,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Ph(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Lt(t.type,l),o.props=u,p=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Rt(c):(c=ft(r)?en:nt.current,c=Fn(t,c));var _=r.getDerivedStateFromProps;(d=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||h!==c)&&pu(t,o,n,c),pr=!1,h=t.memoizedState,o.state=h,Ja(t,n,o,a);var y=t.memoizedState;l!==p||h!==y||ht.current||pr?(typeof _=="function"&&(qo(t,r,_,n),y=t.memoizedState),(u=pr||mu(t,r,u,n,h,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),o.props=n,o.state=y,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Jo(e,t,r,n,i,a)}function Jo(e,t,r,n,a,i){rf(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&iu(t,r,!1),cr(e,t,i);n=t.stateNode,sg.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Bn(t,e.child,null,i),t.child=Bn(t,null,l,i)):st(e,t,l,i),t.memoizedState=n.state,a&&iu(t,r,!0),t.child}function nf(e){var t=e.stateNode;t.pendingContext?au(e,t.pendingContext,t.pendingContext!==t.context):t.context&&au(e,t.context,!1),Jl(e,t.containerInfo)}function ju(e,t,r,n,a){return Mn(),zl(a),t.flags|=256,st(e,t,r,n),t.child}var Go={dehydrated:null,treeContext:null,retryLane:0};function Qo(e){return{baseLanes:e,cachePool:null,transitions:null}}function sf(e,t,r){var n=t.pendingProps,a=Pe.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),ke(Pe,a&1),e===null)return zo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=yi(o,n,0,null),e=Zr(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Qo(r),t.memoizedState=Go,e):rc(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return ag(e,t,o,n,l,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Pr(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=Pr(l,i):(i=Zr(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?Qo(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Go,n}return i=e.child,e=i.sibling,n=Pr(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function rc(e,t){return t=yi({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function fa(e,t,r,n){return n!==null&&zl(n),Bn(t,e.child,null,r),e=rc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ag(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=Yi(Error(W(422))),fa(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=yi({mode:"visible",children:n.children},a,0,null),i=Zr(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Bn(t,e.child,null,o),t.child.memoizedState=Qo(o),t.memoizedState=Go,i);if(!(t.mode&1))return fa(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(W(419)),n=Yi(i,n,void 0),fa(e,t,o,n)}if(l=(o&e.childLanes)!==0,dt||l){if(n=Ve,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,lr(e,a),zt(n,e,a,-1))}return lc(),n=Yi(Error(W(421))),fa(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=yg.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,jt=Er(a.nextSibling),bt=t,Ce=!0,Mt=null,e!==null&&(Nt[Ct++]=nr,Nt[Ct++]=sr,Nt[Ct++]=tn,nr=e.id,sr=e.overflow,tn=t),t=rc(t,n.children),t.flags|=4096,t)}function bu(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ko(e.return,t,r)}function Xi(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function af(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(st(e,t,n.children,r),n=Pe.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&bu(e,r,t);else if(e.tag===19)bu(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ke(Pe,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Ga(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Xi(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Ga(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Xi(t,!0,r,null,i);break;case"together":Xi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ta(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function cr(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),nn|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(W(153));if(t.child!==null){for(e=t.child,r=Pr(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Pr(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function ig(e,t,r){switch(t.tag){case 3:nf(t),Mn();break;case 5:Rh(t);break;case 1:ft(t.type)&&Ka(t);break;case 4:Jl(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;ke(Ha,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ke(Pe,Pe.current&1),t.flags|=128,null):r&t.child.childLanes?sf(e,t,r):(ke(Pe,Pe.current&1),e=cr(e,t,r),e!==null?e.sibling:null);ke(Pe,Pe.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return af(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ke(Pe,Pe.current),n)break;return null;case 22:case 23:return t.lanes=0,tf(e,t,r)}return cr(e,t,r)}var of,Yo,lf,cf;of=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Yo=function(){};lf=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Qr(Yt.current);var i=null;switch(r){case"input":a=wo(e,a),n=wo(e,n),i=[];break;case"select":a=Ae({},a,{value:void 0}),n=Ae({},n,{value:void 0}),i=[];break;case"textarea":a=jo(e,a),n=jo(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ba)}So(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(js.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(js.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ee("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};cf=function(e,t,r,n){r!==n&&(t.flags|=4)};function ss(e,t){if(!Ce)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function tt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function og(e,t,r){var n=t.pendingProps;switch(Bl(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tt(t),null;case 1:return ft(t.type)&&za(),tt(t),null;case 3:return n=t.stateNode,zn(),Ne(ht),Ne(nt),Ql(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(da(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Mt!==null&&(al(Mt),Mt=null))),Yo(e,t),tt(t),null;case 5:Gl(t);var a=Qr(Is.current);if(r=t.type,e!==null&&t.stateNode!=null)lf(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(W(166));return tt(t),null}if(e=Qr(Yt.current),da(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Gt]=t,n[As]=i,e=(t.mode&1)!==0,r){case"dialog":Ee("cancel",n),Ee("close",n);break;case"iframe":case"object":case"embed":Ee("load",n);break;case"video":case"audio":for(a=0;a<cs.length;a++)Ee(cs[a],n);break;case"source":Ee("error",n);break;case"img":case"image":case"link":Ee("error",n),Ee("load",n);break;case"details":Ee("toggle",n);break;case"input":Ac(n,i),Ee("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ee("invalid",n);break;case"textarea":Ic(n,i),Ee("invalid",n)}So(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&ua(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&ua(n.textContent,l,e),a=["children",""+l]):js.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ee("scroll",n)}switch(r){case"input":ra(n),Oc(n,i,!0);break;case"textarea":ra(n),Dc(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Ba)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Ld(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Gt]=t,e[As]=n,of(e,t,!1,!1),t.stateNode=e;e:{switch(o=ko(r,n),r){case"dialog":Ee("cancel",e),Ee("close",e),a=n;break;case"iframe":case"object":case"embed":Ee("load",e),a=n;break;case"video":case"audio":for(a=0;a<cs.length;a++)Ee(cs[a],e);a=n;break;case"source":Ee("error",e),a=n;break;case"img":case"image":case"link":Ee("error",e),Ee("load",e),a=n;break;case"details":Ee("toggle",e),a=n;break;case"input":Ac(e,n),a=wo(e,n),Ee("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Ae({},n,{value:void 0}),Ee("invalid",e);break;case"textarea":Ic(e,n),a=jo(e,n),Ee("invalid",e);break;default:a=n}So(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Fd(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&$d(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&bs(e,c):typeof c=="number"&&bs(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(js.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ee("scroll",e):c!=null&&El(e,i,c,o))}switch(r){case"input":ra(e),Oc(e,n,!1);break;case"textarea":ra(e),Dc(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ar(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Rn(e,!!n.multiple,i,!1):n.defaultValue!=null&&Rn(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Ba)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return tt(t),null;case 6:if(e&&t.stateNode!=null)cf(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(W(166));if(r=Qr(Is.current),Qr(Yt.current),da(t)){if(n=t.stateNode,r=t.memoizedProps,n[Gt]=t,(i=n.nodeValue!==r)&&(e=bt,e!==null))switch(e.tag){case 3:ua(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ua(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Gt]=t,t.stateNode=n}return tt(t),null;case 13:if(Ne(Pe),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ce&&jt!==null&&t.mode&1&&!(t.flags&128))Eh(),Mn(),t.flags|=98560,i=!1;else if(i=da(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(W(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Gt]=t}else Mn(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;tt(t),i=!1}else Mt!==null&&(al(Mt),Mt=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Pe.current&1?Ke===0&&(Ke=3):lc())),t.updateQueue!==null&&(t.flags|=4),tt(t),null);case 4:return zn(),Yo(e,t),e===null&&Ps(t.stateNode.containerInfo),tt(t),null;case 10:return Wl(t.type._context),tt(t),null;case 17:return ft(t.type)&&za(),tt(t),null;case 19:if(Ne(Pe),i=t.memoizedState,i===null)return tt(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)ss(i,!1);else{if(Ke!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ga(e),o!==null){for(t.flags|=128,ss(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ke(Pe,Pe.current&1|2),t.child}e=e.sibling}i.tail!==null&&$e()>qn&&(t.flags|=128,n=!0,ss(i,!1),t.lanes=4194304)}else{if(!n)if(e=Ga(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ss(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ce)return tt(t),null}else 2*$e()-i.renderingStartTime>qn&&r!==1073741824&&(t.flags|=128,n=!0,ss(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=$e(),t.sibling=null,r=Pe.current,ke(Pe,n?r&1|2:r&1),t):(tt(t),null);case 22:case 23:return oc(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?wt&1073741824&&(tt(t),t.subtreeFlags&6&&(t.flags|=8192)):tt(t),null;case 24:return null;case 25:return null}throw Error(W(156,t.tag))}function lg(e,t){switch(Bl(t),t.tag){case 1:return ft(t.type)&&za(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return zn(),Ne(ht),Ne(nt),Ql(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Gl(t),null;case 13:if(Ne(Pe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(W(340));Mn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ne(Pe),null;case 4:return zn(),null;case 10:return Wl(t.type._context),null;case 22:case 23:return oc(),null;case 24:return null;default:return null}}var ma=!1,rt=!1,cg=typeof WeakSet=="function"?WeakSet:Set,ne=null;function Cn(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){De(e,t,n)}else r.current=null}function Xo(e,t,r){try{r()}catch(n){De(e,t,n)}}var Su=!1;function ug(e,t){if(Do=Ua,e=fh(),Fl(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,p=e,h=null;t:for(;;){for(var _;p!==r||a!==0&&p.nodeType!==3||(l=o+a),p!==i||n!==0&&p.nodeType!==3||(c=o+n),p.nodeType===3&&(o+=p.nodeValue.length),(_=p.firstChild)!==null;)h=p,p=_;for(;;){if(p===e)break t;if(h===r&&++u===a&&(l=o),h===i&&++d===n&&(c=o),(_=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=_}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Lo={focusedElem:e,selectionRange:r},Ua=!1,ne=t;ne!==null;)if(t=ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ne=e;else for(;ne!==null;){t=ne;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var j=y.memoizedProps,w=y.memoizedState,m=t.stateNode,f=m.getSnapshotBeforeUpdate(t.elementType===t.type?j:Lt(t.type,j),w);m.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(b){De(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,ne=e;break}ne=t.return}return y=Su,Su=!1,y}function vs(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Xo(t,r,i)}a=a.next}while(a!==n)}}function gi(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Zo(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function uf(e){var t=e.alternate;t!==null&&(e.alternate=null,uf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gt],delete t[As],delete t[Fo],delete t[Hp],delete t[Vp])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function df(e){return e.tag===5||e.tag===3||e.tag===4}function ku(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||df(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function el(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ba));else if(n!==4&&(e=e.child,e!==null))for(el(e,t,r),e=e.sibling;e!==null;)el(e,t,r),e=e.sibling}function tl(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(tl(e,t,r),e=e.sibling;e!==null;)tl(e,t,r),e=e.sibling}var Qe=null,Ut=!1;function fr(e,t,r){for(r=r.child;r!==null;)hf(e,t,r),r=r.sibling}function hf(e,t,r){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(li,r)}catch{}switch(r.tag){case 5:rt||Cn(r,t);case 6:var n=Qe,a=Ut;Qe=null,fr(e,t,r),Qe=n,Ut=a,Qe!==null&&(Ut?(e=Qe,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Qe.removeChild(r.stateNode));break;case 18:Qe!==null&&(Ut?(e=Qe,r=r.stateNode,e.nodeType===8?Wi(e.parentNode,r):e.nodeType===1&&Wi(e,r),Ns(e)):Wi(Qe,r.stateNode));break;case 4:n=Qe,a=Ut,Qe=r.stateNode.containerInfo,Ut=!0,fr(e,t,r),Qe=n,Ut=a;break;case 0:case 11:case 14:case 15:if(!rt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Xo(r,t,o),a=a.next}while(a!==n)}fr(e,t,r);break;case 1:if(!rt&&(Cn(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){De(r,t,l)}fr(e,t,r);break;case 21:fr(e,t,r);break;case 22:r.mode&1?(rt=(n=rt)||r.memoizedState!==null,fr(e,t,r),rt=n):fr(e,t,r);break;default:fr(e,t,r)}}function Eu(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new cg),t.forEach(function(n){var a=wg.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function It(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Qe=l.stateNode,Ut=!1;break e;case 3:Qe=l.stateNode.containerInfo,Ut=!0;break e;case 4:Qe=l.stateNode.containerInfo,Ut=!0;break e}l=l.return}if(Qe===null)throw Error(W(160));hf(i,o,a),Qe=null,Ut=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){De(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ff(t,e),t=t.sibling}function ff(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(It(t,e),Wt(e),n&4){try{vs(3,e,e.return),gi(3,e)}catch(j){De(e,e.return,j)}try{vs(5,e,e.return)}catch(j){De(e,e.return,j)}}break;case 1:It(t,e),Wt(e),n&512&&r!==null&&Cn(r,r.return);break;case 5:if(It(t,e),Wt(e),n&512&&r!==null&&Cn(r,r.return),e.flags&32){var a=e.stateNode;try{bs(a,"")}catch(j){De(e,e.return,j)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Id(a,i),ko(l,o);var u=ko(l,i);for(o=0;o<c.length;o+=2){var d=c[o],p=c[o+1];d==="style"?Fd(a,p):d==="dangerouslySetInnerHTML"?$d(a,p):d==="children"?bs(a,p):El(a,d,p,u)}switch(l){case"input":_o(a,i);break;case"textarea":Dd(a,i);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?Rn(a,!!i.multiple,_,!1):h!==!!i.multiple&&(i.defaultValue!=null?Rn(a,!!i.multiple,i.defaultValue,!0):Rn(a,!!i.multiple,i.multiple?[]:"",!1))}a[As]=i}catch(j){De(e,e.return,j)}}break;case 6:if(It(t,e),Wt(e),n&4){if(e.stateNode===null)throw Error(W(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(j){De(e,e.return,j)}}break;case 3:if(It(t,e),Wt(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ns(t.containerInfo)}catch(j){De(e,e.return,j)}break;case 4:It(t,e),Wt(e);break;case 13:It(t,e),Wt(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(ac=$e())),n&4&&Eu(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(rt=(u=rt)||d,It(t,e),rt=u):It(t,e),Wt(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(ne=e,d=e.child;d!==null;){for(p=ne=d;ne!==null;){switch(h=ne,_=h.child,h.tag){case 0:case 11:case 14:case 15:vs(4,h,h.return);break;case 1:Cn(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(j){De(n,r,j)}}break;case 5:Cn(h,h.return);break;case 22:if(h.memoizedState!==null){Cu(p);continue}}_!==null?(_.return=h,ne=_):Cu(p)}d=d.sibling}e:for(d=null,p=e;;){if(p.tag===5){if(d===null){d=p;try{a=p.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Ud("display",o))}catch(j){De(e,e.return,j)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(j){De(e,e.return,j)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:It(t,e),Wt(e),n&4&&Eu(e);break;case 21:break;default:It(t,e),Wt(e)}}function Wt(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(df(r)){var n=r;break e}r=r.return}throw Error(W(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(bs(a,""),n.flags&=-33);var i=ku(e);tl(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=ku(e);el(e,l,o);break;default:throw Error(W(161))}}catch(c){De(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function dg(e,t,r){ne=e,mf(e)}function mf(e,t,r){for(var n=(e.mode&1)!==0;ne!==null;){var a=ne,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||ma;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||rt;l=ma;var u=rt;if(ma=o,(rt=c)&&!u)for(ne=a;ne!==null;)o=ne,c=o.child,o.tag===22&&o.memoizedState!==null?Tu(a):c!==null?(c.return=o,ne=c):Tu(a);for(;i!==null;)ne=i,mf(i),i=i.sibling;ne=a,ma=l,rt=u}Nu(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,ne=i):Nu(e)}}function Nu(e){for(;ne!==null;){var t=ne;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:rt||gi(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!rt)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Lt(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&du(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}du(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&Ns(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}rt||t.flags&512&&Zo(t)}catch(h){De(t,t.return,h)}}if(t===e){ne=null;break}if(r=t.sibling,r!==null){r.return=t.return,ne=r;break}ne=t.return}}function Cu(e){for(;ne!==null;){var t=ne;if(t===e){ne=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ne=r;break}ne=t.return}}function Tu(e){for(;ne!==null;){var t=ne;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{gi(4,t)}catch(c){De(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){De(t,a,c)}}var i=t.return;try{Zo(t)}catch(c){De(t,i,c)}break;case 5:var o=t.return;try{Zo(t)}catch(c){De(t,o,c)}}}catch(c){De(t,t.return,c)}if(t===e){ne=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ne=l;break}ne=t.return}}var hg=Math.ceil,Xa=ur.ReactCurrentDispatcher,nc=ur.ReactCurrentOwner,Pt=ur.ReactCurrentBatchConfig,ge=0,Ve=null,Me=null,Ye=0,wt=0,Tn=Dr(0),Ke=0,Us=null,nn=0,vi=0,sc=0,ys=null,ut=null,ac=0,qn=1/0,er=null,Za=!1,rl=null,Cr=null,pa=!1,xr=null,ei=0,ws=0,nl=null,Pa=-1,Ra=0;function at(){return ge&6?$e():Pa!==-1?Pa:Pa=$e()}function Tr(e){return e.mode&1?ge&2&&Ye!==0?Ye&-Ye:Gp.transition!==null?(Ra===0&&(Ra=Yd()),Ra):(e=we,e!==0||(e=window.event,e=e===void 0?16:sh(e.type)),e):1}function zt(e,t,r,n){if(50<ws)throw ws=0,nl=null,Error(W(185));Js(e,r,n),(!(ge&2)||e!==Ve)&&(e===Ve&&(!(ge&2)&&(vi|=r),Ke===4&&yr(e,Ye)),mt(e,n),r===1&&ge===0&&!(t.mode&1)&&(qn=$e()+500,fi&&Lr()))}function mt(e,t){var r=e.callbackNode;Gm(e,t);var n=$a(e,e===Ve?Ye:0);if(n===0)r!==null&&Uc(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Uc(r),t===1)e.tag===0?Jp(Pu.bind(null,e)):bh(Pu.bind(null,e)),qp(function(){!(ge&6)&&Lr()}),r=null;else{switch(Xd(n)){case 1:r=Rl;break;case 4:r=Gd;break;case 16:r=La;break;case 536870912:r=Qd;break;default:r=La}r=jf(r,pf.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function pf(e,t){if(Pa=-1,Ra=0,ge&6)throw Error(W(327));var r=e.callbackNode;if(Ln()&&e.callbackNode!==r)return null;var n=$a(e,e===Ve?Ye:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ti(e,n);else{t=n;var a=ge;ge|=2;var i=vf();(Ve!==e||Ye!==t)&&(er=null,qn=$e()+500,Xr(e,t));do try{pg();break}catch(l){gf(e,l)}while(!0);ql(),Xa.current=i,ge=a,Me!==null?t=0:(Ve=null,Ye=0,t=Ke)}if(t!==0){if(t===2&&(a=Po(e),a!==0&&(n=a,t=sl(e,a))),t===1)throw r=Us,Xr(e,0),yr(e,n),mt(e,$e()),r;if(t===6)yr(e,n);else{if(a=e.current.alternate,!(n&30)&&!fg(a)&&(t=ti(e,n),t===2&&(i=Po(e),i!==0&&(n=i,t=sl(e,i))),t===1))throw r=Us,Xr(e,0),yr(e,n),mt(e,$e()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(W(345));case 2:qr(e,ut,er);break;case 3:if(yr(e,n),(n&130023424)===n&&(t=ac+500-$e(),10<t)){if($a(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){at(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Uo(qr.bind(null,e,ut,er),t);break}qr(e,ut,er);break;case 4:if(yr(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-Bt(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=$e()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*hg(n/1960))-n,10<n){e.timeoutHandle=Uo(qr.bind(null,e,ut,er),n);break}qr(e,ut,er);break;case 5:qr(e,ut,er);break;default:throw Error(W(329))}}}return mt(e,$e()),e.callbackNode===r?pf.bind(null,e):null}function sl(e,t){var r=ys;return e.current.memoizedState.isDehydrated&&(Xr(e,t).flags|=256),e=ti(e,t),e!==2&&(t=ut,ut=r,t!==null&&al(t)),e}function al(e){ut===null?ut=e:ut.push.apply(ut,e)}function fg(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Kt(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function yr(e,t){for(t&=~sc,t&=~vi,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Bt(t),n=1<<r;e[r]=-1,t&=~n}}function Pu(e){if(ge&6)throw Error(W(327));Ln();var t=$a(e,0);if(!(t&1))return mt(e,$e()),null;var r=ti(e,t);if(e.tag!==0&&r===2){var n=Po(e);n!==0&&(t=n,r=sl(e,n))}if(r===1)throw r=Us,Xr(e,0),yr(e,t),mt(e,$e()),r;if(r===6)throw Error(W(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,qr(e,ut,er),mt(e,$e()),null}function ic(e,t){var r=ge;ge|=1;try{return e(t)}finally{ge=r,ge===0&&(qn=$e()+500,fi&&Lr())}}function sn(e){xr!==null&&xr.tag===0&&!(ge&6)&&Ln();var t=ge;ge|=1;var r=Pt.transition,n=we;try{if(Pt.transition=null,we=1,e)return e()}finally{we=n,Pt.transition=r,ge=t,!(ge&6)&&Lr()}}function oc(){wt=Tn.current,Ne(Tn)}function Xr(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Kp(r)),Me!==null)for(r=Me.return;r!==null;){var n=r;switch(Bl(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&za();break;case 3:zn(),Ne(ht),Ne(nt),Ql();break;case 5:Gl(n);break;case 4:zn();break;case 13:Ne(Pe);break;case 19:Ne(Pe);break;case 10:Wl(n.type._context);break;case 22:case 23:oc()}r=r.return}if(Ve=e,Me=e=Pr(e.current,null),Ye=wt=t,Ke=0,Us=null,sc=vi=nn=0,ut=ys=null,Gr!==null){for(t=0;t<Gr.length;t++)if(r=Gr[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}Gr=null}return e}function gf(e,t){do{var r=Me;try{if(ql(),Na.current=Ya,Qa){for(var n=Re.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Qa=!1}if(rn=0,He=ze=Re=null,gs=!1,Ds=0,nc.current=null,r===null||r.return===null){Ke=1,Us=t,Me=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=Ye,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var _=vu(o);if(_!==null){_.flags&=-257,yu(_,o,l,i,t),_.mode&1&&gu(i,u,t),t=_,c=u;var y=t.updateQueue;if(y===null){var j=new Set;j.add(c),t.updateQueue=j}else y.add(c);break e}else{if(!(t&1)){gu(i,u,t),lc();break e}c=Error(W(426))}}else if(Ce&&l.mode&1){var w=vu(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),yu(w,o,l,i,t),zl(Kn(c,l));break e}}i=c=Kn(c,l),Ke!==4&&(Ke=2),ys===null?ys=[i]:ys.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var m=Xh(i,c,t);uu(i,m);break e;case 1:l=c;var f=i.type,g=i.stateNode;if(!(i.flags&128)&&(typeof f.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Cr===null||!Cr.has(g)))){i.flags|=65536,t&=-t,i.lanes|=t;var b=Zh(i,l,t);uu(i,b);break e}}i=i.return}while(i!==null)}wf(r)}catch(L){t=L,Me===r&&r!==null&&(Me=r=r.return);continue}break}while(!0)}function vf(){var e=Xa.current;return Xa.current=Ya,e===null?Ya:e}function lc(){(Ke===0||Ke===3||Ke===2)&&(Ke=4),Ve===null||!(nn&268435455)&&!(vi&268435455)||yr(Ve,Ye)}function ti(e,t){var r=ge;ge|=2;var n=vf();(Ve!==e||Ye!==t)&&(er=null,Xr(e,t));do try{mg();break}catch(a){gf(e,a)}while(!0);if(ql(),ge=r,Xa.current=n,Me!==null)throw Error(W(261));return Ve=null,Ye=0,Ke}function mg(){for(;Me!==null;)yf(Me)}function pg(){for(;Me!==null&&!Mm();)yf(Me)}function yf(e){var t=xf(e.alternate,e,wt);e.memoizedProps=e.pendingProps,t===null?wf(e):Me=t,nc.current=null}function wf(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=lg(r,t),r!==null){r.flags&=32767,Me=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ke=6,Me=null;return}}else if(r=og(r,t,wt),r!==null){Me=r;return}if(t=t.sibling,t!==null){Me=t;return}Me=t=e}while(t!==null);Ke===0&&(Ke=5)}function qr(e,t,r){var n=we,a=Pt.transition;try{Pt.transition=null,we=1,gg(e,t,r,n)}finally{Pt.transition=a,we=n}return null}function gg(e,t,r,n){do Ln();while(xr!==null);if(ge&6)throw Error(W(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(W(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(Qm(e,i),e===Ve&&(Me=Ve=null,Ye=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||pa||(pa=!0,jf(La,function(){return Ln(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Pt.transition,Pt.transition=null;var o=we;we=1;var l=ge;ge|=4,nc.current=null,ug(e,r),ff(r,e),Lp(Lo),Ua=!!Do,Lo=Do=null,e.current=r,dg(r),Bm(),ge=l,we=o,Pt.transition=i}else e.current=r;if(pa&&(pa=!1,xr=e,ei=a),i=e.pendingLanes,i===0&&(Cr=null),qm(r.stateNode),mt(e,$e()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Za)throw Za=!1,e=rl,rl=null,e;return ei&1&&e.tag!==0&&Ln(),i=e.pendingLanes,i&1?e===nl?ws++:(ws=0,nl=e):ws=0,Lr(),null}function Ln(){if(xr!==null){var e=Xd(ei),t=Pt.transition,r=we;try{if(Pt.transition=null,we=16>e?16:e,xr===null)var n=!1;else{if(e=xr,xr=null,ei=0,ge&6)throw Error(W(331));var a=ge;for(ge|=4,ne=e.current;ne!==null;){var i=ne,o=i.child;if(ne.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ne=u;ne!==null;){var d=ne;switch(d.tag){case 0:case 11:case 15:vs(8,d,i)}var p=d.child;if(p!==null)p.return=d,ne=p;else for(;ne!==null;){d=ne;var h=d.sibling,_=d.return;if(uf(d),d===u){ne=null;break}if(h!==null){h.return=_,ne=h;break}ne=_}}}var y=i.alternate;if(y!==null){var j=y.child;if(j!==null){y.child=null;do{var w=j.sibling;j.sibling=null,j=w}while(j!==null)}}ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ne=o;else e:for(;ne!==null;){if(i=ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:vs(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,ne=m;break e}ne=i.return}}var f=e.current;for(ne=f;ne!==null;){o=ne;var g=o.child;if(o.subtreeFlags&2064&&g!==null)g.return=o,ne=g;else e:for(o=f;ne!==null;){if(l=ne,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:gi(9,l)}}catch(L){De(l,l.return,L)}if(l===o){ne=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,ne=b;break e}ne=l.return}}if(ge=a,Lr(),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(li,e)}catch{}n=!0}return n}finally{we=r,Pt.transition=t}}return!1}function Ru(e,t,r){t=Kn(r,t),t=Xh(e,t,1),e=Nr(e,t,1),t=at(),e!==null&&(Js(e,1,t),mt(e,t))}function De(e,t,r){if(e.tag===3)Ru(e,e,r);else for(;t!==null;){if(t.tag===3){Ru(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Cr===null||!Cr.has(n))){e=Kn(r,e),e=Zh(t,e,1),t=Nr(t,e,1),e=at(),t!==null&&(Js(t,1,e),mt(t,e));break}}t=t.return}}function vg(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=at(),e.pingedLanes|=e.suspendedLanes&r,Ve===e&&(Ye&r)===r&&(Ke===4||Ke===3&&(Ye&130023424)===Ye&&500>$e()-ac?Xr(e,0):sc|=r),mt(e,t)}function _f(e,t){t===0&&(e.mode&1?(t=aa,aa<<=1,!(aa&130023424)&&(aa=4194304)):t=1);var r=at();e=lr(e,t),e!==null&&(Js(e,t,r),mt(e,r))}function yg(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),_f(e,r)}function wg(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(W(314))}n!==null&&n.delete(t),_f(e,r)}var xf;xf=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ht.current)dt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return dt=!1,ig(e,t,r);dt=!!(e.flags&131072)}else dt=!1,Ce&&t.flags&1048576&&Sh(t,Wa,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ta(e,t),e=t.pendingProps;var a=Fn(t,nt.current);Dn(t,r),a=Xl(null,t,n,e,a,r);var i=Zl();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ft(n)?(i=!0,Ka(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Vl(t),a.updater=pi,t.stateNode=a,a._reactInternals=t,Wo(t,n,e,r),t=Jo(null,t,n,!0,i,r)):(t.tag=0,Ce&&i&&Ml(t),st(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ta(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=xg(n),e=Lt(n,e),a){case 0:t=Vo(null,t,n,e,r);break e;case 1:t=xu(null,t,n,e,r);break e;case 11:t=wu(null,t,n,e,r);break e;case 14:t=_u(null,t,n,Lt(n.type,e),r);break e}throw Error(W(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Lt(n,a),Vo(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Lt(n,a),xu(e,t,n,a,r);case 3:e:{if(nf(t),e===null)throw Error(W(387));n=t.pendingProps,i=t.memoizedState,a=i.element,Ph(e,t),Ja(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Kn(Error(W(423)),t),t=ju(e,t,n,r,a);break e}else if(n!==a){a=Kn(Error(W(424)),t),t=ju(e,t,n,r,a);break e}else for(jt=Er(t.stateNode.containerInfo.firstChild),bt=t,Ce=!0,Mt=null,r=Ch(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Mn(),n===a){t=cr(e,t,r);break e}st(e,t,n,r)}t=t.child}return t;case 5:return Rh(t),e===null&&zo(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,$o(n,a)?o=null:i!==null&&$o(n,i)&&(t.flags|=32),rf(e,t),st(e,t,o,r),t.child;case 6:return e===null&&zo(t),null;case 13:return sf(e,t,r);case 4:return Jl(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Bn(t,null,n,r):st(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Lt(n,a),wu(e,t,n,a,r);case 7:return st(e,t,t.pendingProps,r),t.child;case 8:return st(e,t,t.pendingProps.children,r),t.child;case 12:return st(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,ke(Ha,n._currentValue),n._currentValue=o,i!==null)if(Kt(i.value,o)){if(i.children===a.children&&!ht.current){t=cr(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=ar(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Ko(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Ko(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}st(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Dn(t,r),a=Rt(a),n=n(a),t.flags|=1,st(e,t,n,r),t.child;case 14:return n=t.type,a=Lt(n,t.pendingProps),a=Lt(n.type,a),_u(e,t,n,a,r);case 15:return ef(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Lt(n,a),Ta(e,t),t.tag=1,ft(n)?(e=!0,Ka(t)):e=!1,Dn(t,r),Yh(t,n,a),Wo(t,n,a,r),Jo(null,t,n,!0,e,r);case 19:return af(e,t,r);case 22:return tf(e,t,r)}throw Error(W(156,t.tag))};function jf(e,t){return Jd(e,t)}function _g(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tt(e,t,r,n){return new _g(e,t,r,n)}function cc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function xg(e){if(typeof e=="function")return cc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Cl)return 11;if(e===Tl)return 14}return 2}function Pr(e,t){var r=e.alternate;return r===null?(r=Tt(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Aa(e,t,r,n,a,i){var o=2;if(n=e,typeof e=="function")cc(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case wn:return Zr(r.children,a,i,t);case Nl:o=8,a|=8;break;case po:return e=Tt(12,r,t,a|2),e.elementType=po,e.lanes=i,e;case go:return e=Tt(13,r,t,a),e.elementType=go,e.lanes=i,e;case vo:return e=Tt(19,r,t,a),e.elementType=vo,e.lanes=i,e;case Rd:return yi(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Td:o=10;break e;case Pd:o=9;break e;case Cl:o=11;break e;case Tl:o=14;break e;case mr:o=16,n=null;break e}throw Error(W(130,e==null?e:typeof e,""))}return t=Tt(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Zr(e,t,r,n){return e=Tt(7,e,n,t),e.lanes=r,e}function yi(e,t,r,n){return e=Tt(22,e,n,t),e.elementType=Rd,e.lanes=r,e.stateNode={isHidden:!1},e}function Zi(e,t,r){return e=Tt(6,e,null,t),e.lanes=r,e}function eo(e,t,r){return t=Tt(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jg(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ii(0),this.expirationTimes=Ii(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ii(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function uc(e,t,r,n,a,i,o,l,c){return e=new jg(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Tt(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Vl(i),e}function bg(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yn,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function bf(e){if(!e)return Or;e=e._reactInternals;e:{if(on(e)!==e||e.tag!==1)throw Error(W(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ft(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(W(171))}if(e.tag===1){var r=e.type;if(ft(r))return jh(e,r,t)}return t}function Sf(e,t,r,n,a,i,o,l,c){return e=uc(r,n,!0,e,a,i,o,l,c),e.context=bf(null),r=e.current,n=at(),a=Tr(r),i=ar(n,a),i.callback=t??null,Nr(r,i,a),e.current.lanes=a,Js(e,a,n),mt(e,n),e}function wi(e,t,r,n){var a=t.current,i=at(),o=Tr(a);return r=bf(r),t.context===null?t.context=r:t.pendingContext=r,t=ar(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Nr(a,t,o),e!==null&&(zt(e,a,o,i),Ea(e,a,o)),o}function ri(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Au(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function dc(e,t){Au(e,t),(e=e.alternate)&&Au(e,t)}function Sg(){return null}var kf=typeof reportError=="function"?reportError:function(e){console.error(e)};function hc(e){this._internalRoot=e}_i.prototype.render=hc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(W(409));wi(e,t,null,null)};_i.prototype.unmount=hc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;sn(function(){wi(null,e,null,null)}),t[or]=null}};function _i(e){this._internalRoot=e}_i.prototype.unstable_scheduleHydration=function(e){if(e){var t=th();e={blockedOn:null,target:e,priority:t};for(var r=0;r<vr.length&&t!==0&&t<vr[r].priority;r++);vr.splice(r,0,e),r===0&&nh(e)}};function fc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function xi(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ou(){}function kg(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=ri(o);i.call(u)}}var o=Sf(t,n,e,0,null,!1,!1,"",Ou);return e._reactRootContainer=o,e[or]=o.current,Ps(e.nodeType===8?e.parentNode:e),sn(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var u=ri(c);l.call(u)}}var c=uc(e,0,!1,null,null,!1,!1,"",Ou);return e._reactRootContainer=c,e[or]=c.current,Ps(e.nodeType===8?e.parentNode:e),sn(function(){wi(t,c,r,n)}),c}function ji(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var c=ri(o);l.call(c)}}wi(t,o,e,a)}else o=kg(r,t,e,a,n);return ri(o)}Zd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ls(t.pendingLanes);r!==0&&(Al(t,r|1),mt(t,$e()),!(ge&6)&&(qn=$e()+500,Lr()))}break;case 13:sn(function(){var n=lr(e,1);if(n!==null){var a=at();zt(n,e,1,a)}}),dc(e,1)}};Ol=function(e){if(e.tag===13){var t=lr(e,134217728);if(t!==null){var r=at();zt(t,e,134217728,r)}dc(e,134217728)}};eh=function(e){if(e.tag===13){var t=Tr(e),r=lr(e,t);if(r!==null){var n=at();zt(r,e,t,n)}dc(e,t)}};th=function(){return we};rh=function(e,t){var r=we;try{return we=e,t()}finally{we=r}};No=function(e,t,r){switch(t){case"input":if(_o(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=hi(n);if(!a)throw Error(W(90));Od(n),_o(n,a)}}}break;case"textarea":Dd(e,r);break;case"select":t=r.value,t!=null&&Rn(e,!!r.multiple,t,!1)}};zd=ic;Kd=sn;var Eg={usingClientEntryPoint:!1,Events:[Qs,bn,hi,Md,Bd,ic]},as={findFiberByHostInstance:Jr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ng={bundleType:as.bundleType,version:as.version,rendererPackageName:as.rendererPackageName,rendererConfig:as.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ur.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Hd(e),e===null?null:e.stateNode},findFiberByHostInstance:as.findFiberByHostInstance||Sg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ga=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ga.isDisabled&&ga.supportsFiber)try{li=ga.inject(Ng),Qt=ga}catch{}}kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Eg;kt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fc(t))throw Error(W(200));return bg(e,t,null,r)};kt.createRoot=function(e,t){if(!fc(e))throw Error(W(299));var r=!1,n="",a=kf;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=uc(e,1,!1,null,null,r,!1,n,a),e[or]=t.current,Ps(e.nodeType===8?e.parentNode:e),new hc(t)};kt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(W(188)):(e=Object.keys(e).join(","),Error(W(268,e)));return e=Hd(t),e=e===null?null:e.stateNode,e};kt.flushSync=function(e){return sn(e)};kt.hydrate=function(e,t,r){if(!xi(t))throw Error(W(200));return ji(null,e,t,!0,r)};kt.hydrateRoot=function(e,t,r){if(!fc(e))throw Error(W(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=kf;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=Sf(t,null,e,1,r??null,a,!1,i,o),e[or]=t.current,Ps(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new _i(t)};kt.render=function(e,t,r){if(!xi(t))throw Error(W(200));return ji(null,e,t,!1,r)};kt.unmountComponentAtNode=function(e){if(!xi(e))throw Error(W(40));return e._reactRootContainer?(sn(function(){ji(null,null,e,!1,function(){e._reactRootContainer=null,e[or]=null})}),!0):!1};kt.unstable_batchedUpdates=ic;kt.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!xi(r))throw Error(W(200));if(e==null||e._reactInternals===void 0)throw Error(W(38));return ji(e,t,r,!1,n)};kt.version="18.3.1-next-f1338f8080-20240426";function Ef(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ef)}catch(e){console.error(e)}}Ef(),kd.exports=kt;var Cg=kd.exports,Iu=Cg;fo.createRoot=Iu.createRoot,fo.hydrateRoot=Iu.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fs(){return Fs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fs.apply(this,arguments)}var jr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(jr||(jr={}));const Du="popstate";function Tg(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:o,hash:l}=n.location;return il("",{pathname:i,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:ni(a)}return Rg(t,r,null,e)}function Ue(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function mc(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Pg(){return Math.random().toString(36).substr(2,8)}function Lu(e,t){return{usr:e.state,key:e.key,idx:t}}function il(e,t,r,n){return r===void 0&&(r=null),Fs({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Jn(t):t,{state:r,key:t&&t.key||n||Pg()})}function ni(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Jn(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Rg(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,l=jr.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(Fs({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function p(){l=jr.Pop;let w=d(),m=w==null?null:w-u;u=w,c&&c({action:l,location:j.location,delta:m})}function h(w,m){l=jr.Push;let f=il(j.location,w,m);u=d()+1;let g=Lu(f,u),b=j.createHref(f);try{o.pushState(g,"",b)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(b)}i&&c&&c({action:l,location:j.location,delta:1})}function _(w,m){l=jr.Replace;let f=il(j.location,w,m);u=d();let g=Lu(f,u),b=j.createHref(f);o.replaceState(g,"",b),i&&c&&c({action:l,location:j.location,delta:0})}function y(w){let m=a.location.origin!=="null"?a.location.origin:a.location.href,f=typeof w=="string"?w:ni(w);return f=f.replace(/ $/,"%20"),Ue(m,"No window.location.(origin|href) available to create URL for href: "+f),new URL(f,m)}let j={get action(){return l},get location(){return e(a,o)},listen(w){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(Du,p),c=w,()=>{a.removeEventListener(Du,p),c=null}},createHref(w){return t(a,w)},createURL:y,encodeLocation(w){let m=y(w);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:h,replace:_,go(w){return o.go(w)}};return j}var $u;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})($u||($u={}));function Ag(e,t,r){return r===void 0&&(r="/"),Og(e,t,r)}function Og(e,t,r,n){let a=typeof t=="string"?Jn(t):t,i=pc(a.pathname||"/",r);if(i==null)return null;let o=Nf(e);Ig(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=Hg(i);l=Kg(o[c],u)}return l}function Nf(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Ue(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Rr([n,c.relativePath]),d=r.concat(c);i.children&&i.children.length>0&&(Ue(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Nf(i.children,t,d,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:Bg(u,i.index),routesMeta:d})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,o);else for(let c of Cf(i.path))a(i,o,c)}),t}function Cf(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=Cf(n.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function Ig(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:zg(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Dg=/^:[\w-]+$/,Lg=3,$g=2,Ug=1,Fg=10,Mg=-2,Uu=e=>e==="*";function Bg(e,t){let r=e.split("/"),n=r.length;return r.some(Uu)&&(n+=Mg),t&&(n+=$g),r.filter(a=>!Uu(a)).reduce((a,i)=>a+(Dg.test(i)?Lg:i===""?Ug:Fg),n)}function zg(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function Kg(e,t,r){let{routesMeta:n}=e,a={},i="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",p=qg({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!p)return null;Object.assign(a,p.params),o.push({params:a,pathname:Rr([i,p.pathname]),pathnameBase:Yg(Rr([i,p.pathnameBase])),route:h}),p.pathnameBase!=="/"&&(i=Rr([i,p.pathnameBase]))}return o}function qg(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Wg(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((u,d,p)=>{let{paramName:h,isOptional:_}=d;if(h==="*"){let j=l[p]||"";o=i.slice(0,i.length-j.length).replace(/(.)\/+$/,"$1")}const y=l[p];return _&&!y?u[h]=void 0:u[h]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:e}}function Wg(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),mc(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function Hg(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return mc(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function pc(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const Vg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Jg=e=>Vg.test(e);function Gg(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Jn(e):e,i;if(r)if(Jg(r))i=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),mc(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?i=Fu(r.substring(1),"/"):i=Fu(r,t)}else i=t;return{pathname:i,search:Xg(n),hash:Zg(a)}}function Fu(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function to(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Qg(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function gc(e,t){let r=Qg(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function vc(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Jn(e):(a=Fs({},e),Ue(!a.pathname||!a.pathname.includes("?"),to("?","pathname","search",a)),Ue(!a.pathname||!a.pathname.includes("#"),to("#","pathname","hash",a)),Ue(!a.search||!a.search.includes("#"),to("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=r;else{let p=t.length-1;if(!n&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),p-=1;a.pathname=h.join("/")}l=p>=0?t[p]:"/"}let c=Gg(a,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Rr=e=>e.join("/").replace(/\/\/+/g,"/"),Yg=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Xg=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Zg=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ev(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Tf=["post","put","patch","delete"];new Set(Tf);const tv=["get",...Tf];new Set(tv);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ms(){return Ms=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ms.apply(this,arguments)}const yc=v.createContext(null),rv=v.createContext(null),$r=v.createContext(null),bi=v.createContext(null),Ur=v.createContext({outlet:null,matches:[],isDataRoute:!1}),Pf=v.createContext(null);function nv(e,t){let{relative:r}=t===void 0?{}:t;Gn()||Ue(!1);let{basename:n,navigator:a}=v.useContext($r),{hash:i,pathname:o,search:l}=Af(e,{relative:r}),c=o;return n!=="/"&&(c=o==="/"?n:Rr([n,o])),a.createHref({pathname:c,search:l,hash:i})}function Gn(){return v.useContext(bi)!=null}function Qn(){return Gn()||Ue(!1),v.useContext(bi).location}function Rf(e){v.useContext($r).static||v.useLayoutEffect(e)}function Xs(){let{isDataRoute:e}=v.useContext(Ur);return e?gv():sv()}function sv(){Gn()||Ue(!1);let e=v.useContext(yc),{basename:t,future:r,navigator:n}=v.useContext($r),{matches:a}=v.useContext(Ur),{pathname:i}=Qn(),o=JSON.stringify(gc(a,r.v7_relativeSplatPath)),l=v.useRef(!1);return Rf(()=>{l.current=!0}),v.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let p=vc(u,JSON.parse(o),i,d.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:Rr([t,p.pathname])),(d.replace?n.replace:n.push)(p,d.state,d)},[t,n,o,i,e])}function Af(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=v.useContext($r),{matches:a}=v.useContext(Ur),{pathname:i}=Qn(),o=JSON.stringify(gc(a,n.v7_relativeSplatPath));return v.useMemo(()=>vc(e,JSON.parse(o),i,r==="path"),[e,o,i,r])}function av(e,t){return iv(e,t)}function iv(e,t,r,n){Gn()||Ue(!1);let{navigator:a}=v.useContext($r),{matches:i}=v.useContext(Ur),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Qn(),d;if(t){var p;let w=typeof t=="string"?Jn(t):t;c==="/"||(p=w.pathname)!=null&&p.startsWith(c)||Ue(!1),d=w}else d=u;let h=d.pathname||"/",_=h;if(c!=="/"){let w=c.replace(/^\//,"").split("/");_="/"+h.replace(/^\//,"").split("/").slice(w.length).join("/")}let y=Ag(e,{pathname:_}),j=dv(y&&y.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:Rr([c,a.encodeLocation?a.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:Rr([c,a.encodeLocation?a.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,r,n);return t&&j?v.createElement(bi.Provider,{value:{location:Ms({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:jr.Pop}},j):j}function ov(){let e=pv(),t=ev(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},t),r?v.createElement("pre",{style:a},r):null,null)}const lv=v.createElement(ov,null);class cv extends v.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?v.createElement(Ur.Provider,{value:this.props.routeContext},v.createElement(Pf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function uv(e){let{routeContext:t,match:r,children:n}=e,a=v.useContext(yc);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),v.createElement(Ur.Provider,{value:t},n)}function dv(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(a=r)==null?void 0:a.errors;if(l!=null){let d=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);d>=0||Ue(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let p=o[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=d),p.route.id){let{loaderData:h,errors:_}=r,y=p.route.loader&&h[p.route.id]===void 0&&(!_||_[p.route.id]===void 0);if(p.route.lazy||y){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,p,h)=>{let _,y=!1,j=null,w=null;r&&(_=l&&p.route.id?l[p.route.id]:void 0,j=p.route.errorElement||lv,c&&(u<0&&h===0?(vv("route-fallback"),y=!0,w=null):u===h&&(y=!0,w=p.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,h+1)),f=()=>{let g;return _?g=j:y?g=w:p.route.Component?g=v.createElement(p.route.Component,null):p.route.element?g=p.route.element:g=d,v.createElement(uv,{match:p,routeContext:{outlet:d,matches:m,isDataRoute:r!=null},children:g})};return r&&(p.route.ErrorBoundary||p.route.errorElement||h===0)?v.createElement(cv,{location:r.location,revalidation:r.revalidation,component:j,error:_,children:f(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):f()},null)}var Of=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Of||{}),If=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(If||{});function hv(e){let t=v.useContext(yc);return t||Ue(!1),t}function fv(e){let t=v.useContext(rv);return t||Ue(!1),t}function mv(e){let t=v.useContext(Ur);return t||Ue(!1),t}function Df(e){let t=mv(),r=t.matches[t.matches.length-1];return r.route.id||Ue(!1),r.route.id}function pv(){var e;let t=v.useContext(Pf),r=fv(),n=Df();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function gv(){let{router:e}=hv(Of.UseNavigateStable),t=Df(If.UseNavigateStable),r=v.useRef(!1);return Rf(()=>{r.current=!0}),v.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Ms({fromRouteId:t},i)))},[e,t])}const Mu={};function vv(e,t,r){Mu[e]||(Mu[e]=!0)}function yv(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function wv(e){let{to:t,replace:r,state:n,relative:a}=e;Gn()||Ue(!1);let{future:i,static:o}=v.useContext($r),{matches:l}=v.useContext(Ur),{pathname:c}=Qn(),u=Xs(),d=vc(t,gc(l,i.v7_relativeSplatPath),c,a==="path"),p=JSON.stringify(d);return v.useEffect(()=>u(JSON.parse(p),{replace:r,state:n,relative:a}),[u,p,a,r,n]),null}function vt(e){Ue(!1)}function _v(e){let{basename:t="/",children:r=null,location:n,navigationType:a=jr.Pop,navigator:i,static:o=!1,future:l}=e;Gn()&&Ue(!1);let c=t.replace(/^\/*/,"/"),u=v.useMemo(()=>({basename:c,navigator:i,static:o,future:Ms({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof n=="string"&&(n=Jn(n));let{pathname:d="/",search:p="",hash:h="",state:_=null,key:y="default"}=n,j=v.useMemo(()=>{let w=pc(d,c);return w==null?null:{location:{pathname:w,search:p,hash:h,state:_,key:y},navigationType:a}},[c,d,p,h,_,y,a]);return j==null?null:v.createElement($r.Provider,{value:u},v.createElement(bi.Provider,{children:r,value:j}))}function xv(e){let{children:t,location:r}=e;return av(ol(t),r)}new Promise(()=>{});function ol(e,t){t===void 0&&(t=[]);let r=[];return v.Children.forEach(e,(n,a)=>{if(!v.isValidElement(n))return;let i=[...t,a];if(n.type===v.Fragment){r.push.apply(r,ol(n.props.children,i));return}n.type!==vt&&Ue(!1),!n.props.index||!n.props.children||Ue(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=ol(n.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ll(){return ll=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ll.apply(this,arguments)}function jv(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function bv(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Sv(e,t){return e.button===0&&(!t||t==="_self")&&!bv(e)}const kv=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ev="6";try{window.__reactRouterVersion=Ev}catch{}const Nv="startTransition",Bu=vm[Nv];function Cv(e){let{basename:t,children:r,future:n,window:a}=e,i=v.useRef();i.current==null&&(i.current=Tg({window:a,v5Compat:!0}));let o=i.current,[l,c]=v.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=v.useCallback(p=>{u&&Bu?Bu(()=>c(p)):c(p)},[c,u]);return v.useLayoutEffect(()=>o.listen(d),[o,d]),v.useEffect(()=>yv(n),[n]),v.createElement(_v,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const Tv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Pv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ro=v.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:p}=t,h=jv(t,kv),{basename:_}=v.useContext($r),y,j=!1;if(typeof u=="string"&&Pv.test(u)&&(y=u,Tv))try{let g=new URL(window.location.href),b=u.startsWith("//")?new URL(g.protocol+u):new URL(u),L=pc(b.pathname,_);b.origin===g.origin&&L!=null?u=L+b.search+b.hash:j=!0}catch{}let w=nv(u,{relative:a}),m=Rv(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:p});function f(g){n&&n(g),g.defaultPrevented||m(g)}return v.createElement("a",ll({},h,{href:y||w,onClick:j||i?n:f,ref:r,target:c}))});var zu;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(zu||(zu={}));var Ku;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Ku||(Ku={}));function Rv(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:o,viewTransition:l}=t===void 0?{}:t,c=Xs(),u=Qn(),d=Af(e,{relative:o});return v.useCallback(p=>{if(Sv(p,r)){p.preventDefault();let h=n!==void 0?n:ni(u)===ni(d);c(e,{replace:h,state:a,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,d,n,a,r,e,i,o,l])}function Si(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Av(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(p){o(p)}}function c(d){try{u(n.throw(d))}catch(p){o(p)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})}const Ov=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class wc extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Iv extends wc{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class qu extends wc{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Wu extends wc{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var cl;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(cl||(cl={}));class Dv{constructor(t,{headers:r={},customFetch:n,region:a=cl.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Ov(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Av(this,arguments,void 0,function*(r,n={}){var a;let i,o;try{const{headers:l,method:c,body:u,signal:d,timeout:p}=n;let h={},{region:_}=n;_||(_=this.region);const y=new URL(`${this.url}/${r}`);_&&_!=="any"&&(h["x-region"]=_,y.searchParams.set("forceFunctionRegion",_));let j;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",j=u):typeof u=="string"?(h["Content-Type"]="text/plain",j=u):typeof FormData<"u"&&u instanceof FormData?j=u:(h["Content-Type"]="application/json",j=JSON.stringify(u)):j=u;let w=d;p&&(o=new AbortController,i=setTimeout(()=>o.abort(),p),d?(w=o.signal,d.addEventListener("abort",()=>o.abort())):w=o.signal);const m=yield this.fetch(y.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),l),body:j,signal:w}).catch(L=>{throw new Iv(L)}),f=m.headers.get("x-relay-error");if(f&&f==="true")throw new qu(m);if(!m.ok)throw new Wu(m);let g=((a=m.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),b;return g==="application/json"?b=yield m.json():g==="application/octet-stream"||g==="application/pdf"?b=yield m.blob():g==="text/event-stream"?b=m:g==="multipart/form-data"?b=yield m.formData():b=yield m.text(),{data:b,error:null,response:m}}catch(l){return{data:null,error:l,response:l instanceof Wu||l instanceof qu?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var Lv=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},$v=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,l=null,c=null,u=i.status,d=i.statusText;if(i.ok){var p,h;if(r.method!=="HEAD"){var _;const m=await i.text();m===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((_=r.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?l=m:l=JSON.parse(m))}const j=(p=r.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),w=(h=i.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");j&&w&&w.length>1&&(c=parseInt(w[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(l)&&(l.length>1?(o={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,u=406,d="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var y;const j=await i.text();try{o=JSON.parse(j),Array.isArray(o)&&i.status===404&&(l=[],o=null,u=200,d="OK")}catch{i.status===404&&j===""?(u=204,d="No Content"):o={message:j}}if(o&&r.isMaybeSingle&&(!(o==null||(y=o.details)===null||y===void 0)&&y.includes("0 rows"))&&(o=null,u=200,d="OK"),o&&r.shouldThrowOnError)throw new Lv(o)}return{error:o,data:l,count:c,status:u,statusText:d}});return this.shouldThrowOnError||(a=a.catch(i=>{var o;let l="";const c=i==null?void 0:i.cause;if(c){var u,d,p,h;const y=(u=c==null?void 0:c.message)!==null&&u!==void 0?u:"",j=(d=c==null?void 0:c.code)!==null&&d!==void 0?d:"";l=`${(p=i==null?void 0:i.name)!==null&&p!==void 0?p:"FetchError"}: ${i==null?void 0:i.message}`,l+=`

Caused by: ${(h=c==null?void 0:c.name)!==null&&h!==void 0?h:"Error"}: ${y}`,j&&(l+=` (${j})`),c!=null&&c.stack&&(l+=`
${c.stack}`)}else{var _;l=(_=i==null?void 0:i.stack)!==null&&_!==void 0?_:""}return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},Uv=class extends $v{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:a=n}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:a=!1,format:i="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Hu=new RegExp("[,()]");var pn=class extends Uv{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Hu.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Hu.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},Fv=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}select(e,t){const{head:r=!1,count:n}=t??{},a=r?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new pn({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const a="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const i=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new pn({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:a=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),n&&this.headers.append("Prefer",`count=${n}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new pn({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:t}={}){var r;const n="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new pn({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new pn({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},Mv=class Lf{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Fv(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Lf(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){var o;let l;const c=new URL(`${this.url}/rpc/${t}`);let u;n||a?(l=n?"HEAD":"GET",Object.entries(r).filter(([p,h])=>h!==void 0).map(([p,h])=>[p,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([p,h])=>{c.searchParams.append(p,h)})):(l="POST",u=r);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new pn({method:l,url:c,headers:d,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class Bv{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const zv="2.89.0",Kv=`realtime-js/${zv}`,$f="1.0.0",qv="2.0.0",Vu=$f,ul=1e4,Wv=1e3,Hv=100;var gr;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(gr||(gr={}));var Be;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Be||(Be={}));var Ft;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ft||(Ft={}));var dl;(function(e){e.websocket="websocket"})(dl||(dl={}));var Hr;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Hr||(Hr={}));class Vv{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,n){var a,i;const o=t.topic,l=(a=t.ref)!==null&&a!==void 0?a:"",c=(i=t.join_ref)!==null&&i!==void 0?i:"",u=t.payload.event,d=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},p=Object.keys(d).length===0?"":JSON.stringify(d);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`metadata length ${p.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+u.length+p.length,_=new ArrayBuffer(this.HEADER_LENGTH+h);let y=new DataView(_),j=0;y.setUint8(j++,this.KINDS.userBroadcastPush),y.setUint8(j++,c.length),y.setUint8(j++,l.length),y.setUint8(j++,o.length),y.setUint8(j++,u.length),y.setUint8(j++,p.length),y.setUint8(j++,r),Array.from(c,m=>y.setUint8(j++,m.charCodeAt(0))),Array.from(l,m=>y.setUint8(j++,m.charCodeAt(0))),Array.from(o,m=>y.setUint8(j++,m.charCodeAt(0))),Array.from(u,m=>y.setUint8(j++,m.charCodeAt(0))),Array.from(p,m=>y.setUint8(j++,m.charCodeAt(0)));var w=new Uint8Array(_.byteLength+n.byteLength);return w.set(new Uint8Array(_),0),w.set(new Uint8Array(n),_.byteLength),w.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[a,i,o,l,c]=n;return r({join_ref:a,ref:i,topic:o,event:l,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,a)}}_decodeUserBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=n.decode(t.slice(c,c+a));c=c+a;const d=n.decode(t.slice(c,c+i));c=c+i;const p=n.decode(t.slice(c,c+o));c=c+o;const h=t.slice(c,t.byteLength),_=l===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,y={type:this.BROADCAST_EVENT,event:d,payload:_};return o>0&&(y.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:y}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class Uf{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Se;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Se||(Se={}));const Ju=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,o)=>(i[o]=Jv(o,e,t,a),i),{}):{}},Jv=(e,t,r,n)=>{const a=t.find(l=>l.name===e),i=a==null?void 0:a.type,o=r[e];return i&&!n.includes(i)?Ff(i,o):hl(o)},Ff=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Xv(t,r)}switch(e){case Se.bool:return Gv(t);case Se.float4:case Se.float8:case Se.int2:case Se.int4:case Se.int8:case Se.numeric:case Se.oid:return Qv(t);case Se.json:case Se.jsonb:return Yv(t);case Se.timestamp:return Zv(t);case Se.abstime:case Se.date:case Se.daterange:case Se.int4range:case Se.int8range:case Se.money:case Se.reltime:case Se.text:case Se.time:case Se.timestamptz:case Se.timetz:case Se.tsrange:case Se.tstzrange:return hl(t);default:return hl(t)}},hl=e=>e,Gv=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Qv=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Yv=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},Xv=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Ff(t,l))}return e},Zv=e=>typeof e=="string"?e.replace(" ","T"):e,Mf=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class no{constructor(t,r,n={},a=ul){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Gu;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Gu||(Gu={}));class _s{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=_s.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=_s.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=_s.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(i,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const p=i[u];if(p){const h=d.map(w=>w.presence_ref),_=p.map(w=>w.presence_ref),y=d.filter(w=>_.indexOf(w.presence_ref)<0),j=p.filter(w=>h.indexOf(w.presence_ref)<0);y.length>0&&(l[u]=y),j.length>0&&(c[u]=j)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const p=t[l].map(_=>_.presence_ref),h=d.filter(_=>p.indexOf(_.presence_ref)<0);t[l].unshift(...h)}n(l,d,c)}),this.map(o,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(p=>p.presence_ref);u=u.filter(p=>d.indexOf(p.presence_ref)<0),t[l]=u,a(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Qu;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Qu||(Qu={}));var xs;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(xs||(xs={}));var tr;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(tr||(tr={}));class Pn{constructor(t,r={config:{}},n){var a,i;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Be.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new no(this,Ft.join,this.params,this.timeout),this.rejoinTimer=new Uf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Be.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Be.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Be.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Be.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Be.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ft.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new _s(this),this.broadcastEndpointURL=Mf(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Be.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,u=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(_=>_.filter))!==null&&a!==void 0?a:[],d=!!this.bindings[xs.PRESENCE]&&this.bindings[xs.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,p={},h={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(_=>t==null?void 0:t(tr.CHANNEL_ERROR,_)),this._onClose(()=>t==null?void 0:t(tr.CLOSED)),this.updateJoinPayload(Object.assign({config:h},p)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var y;if(this.socket._isManualToken()||this.socket.setAuth(),_===void 0){t==null||t(tr.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,w=(y=j==null?void 0:j.length)!==null&&y!==void 0?y:0,m=[];for(let f=0;f<w;f++){const g=j[f],{filter:{event:b,schema:L,table:A,filter:k}}=g,N=_&&_[f];if(N&&N.event===b&&Pn.isFilterValueEqual(N.schema,L)&&Pn.isFilterValueEqual(N.table,A)&&Pn.isFilterValueEqual(N.filter,k))m.push(Object.assign(Object.assign({},g),{id:N.id}));else{this.unsubscribe(),this.state=Be.errored,t==null||t(tr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,t&&t(tr.SUBSCRIBED);return}}).receive("error",_=>{this.state=Be.errored,t==null||t(tr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(tr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Be.joined&&t===xs.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=t,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Be.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ft.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new no(this,Ft.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Be.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new no(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Hv){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Ft;if(n&&[l,c,u,d].indexOf(o)>=0&&n!==this._joinRef())return;let h=this._onMessage(o,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(_=>{var y,j,w;return((y=_.filter)===null||y===void 0?void 0:y.event)==="*"||((w=(j=_.filter)===null||j===void 0?void 0:j.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===o}).map(_=>_.callback(h,n)):(i=this.bindings[o])===null||i===void 0||i.filter(_=>{var y,j,w,m,f,g;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in _){const b=_.id,L=(y=_.filter)===null||y===void 0?void 0:y.event;return b&&((j=r.ids)===null||j===void 0?void 0:j.includes(b))&&(L==="*"||(L==null?void 0:L.toLocaleLowerCase())===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const b=(f=(m=_==null?void 0:_.filter)===null||m===void 0?void 0:m.event)===null||f===void 0?void 0:f.toLocaleLowerCase();return b==="*"||b===((g=r==null?void 0:r.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===o}).map(_=>{if(typeof h=="object"&&"ids"in h){const y=h.data,{schema:j,table:w,commit_timestamp:m,type:f,errors:g}=y;h=Object.assign(Object.assign({},{schema:j,table:w,commit_timestamp:m,eventType:f,new:{},old:{},errors:g}),this._getPayloadRecords(y))}_.callback(h,n)})}_isClosed(){return this.state===Be.closed}_isJoined(){return this.state===Be.joined}_isJoining(){return this.state===Be.joining}_isLeaving(){return this.state===Be.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Pn.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ft.close,{},t)}_onError(t){this._on(Ft.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Be.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ju(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ju(t.columns,t.old_record)),r}}const so=()=>{},va={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ey=[1e3,2e3,5e3,1e4],ty=1e4,ry=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ny{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ul,this.transport=null,this.heartbeatIntervalMs=va.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=so,this.ref=0,this.reconnectTimer=null,this.vsn=Vu,this.logger=so,this.conn=null,this.sendBuffer=[],this.serializer=new Vv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${dl.websocket}`,this.httpEndpoint=Mf(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Bv.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case gr.connecting:return Hr.Connecting;case gr.open:return Hr.Open;case gr.closing:return Hr.Closing;default:return Hr.Closed}}isConnected(){return this.connectionState()===Hr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new Pn(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Wv,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},va.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:i,ref:o}=r,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${n} ${a} ${l}`.trim(),i),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(a,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===gr.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===gr.open||this.conn.readyState===gr.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ft.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([ry],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const i={access_token:r,version:Kv};r&&a.updateJoinPayload(i),a.joinedOnce&&a._isJoined()&&a._push(Ft.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Uf(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},va.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,i,o,l,c,u,d,p,h,_;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:ul,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:va.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:so,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:Vu,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:y=>ey[y-1]||ty,this.vsn){case $f:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(y,j)=>j(JSON.stringify(y)),this.decode=(p=t==null?void 0:t.decode)!==null&&p!==void 0?p:(y,j)=>j(JSON.parse(y));break;case qv:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(_=t==null?void 0:t.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var Bs=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function sy(e,t,r){const n=new URL(t,e);if(r)for(const[a,i]of Object.entries(r))i!==void 0&&n.searchParams.set(a,i);return n.toString()}async function ay(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function iy(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:a,body:i,headers:o}){const l=sy(e.baseUrl,n,a),c=await ay(e.auth),u=await t(l,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...c,...o},body:i?JSON.stringify(i):void 0}),d=await u.text(),p=(u.headers.get("content-type")||"").includes("application/json"),h=p&&d?JSON.parse(d):d;if(!u.ok){const _=p?h:void 0,y=_==null?void 0:_.error;throw new Bs((y==null?void 0:y.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:y==null?void 0:y.type,icebergCode:y==null?void 0:y.code,details:_})}return{status:u.status,headers:u.headers,data:h}}}}function ya(e){return e.join("")}var oy=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:ya(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ya(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ya(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ya(e.namespace)}`}),!0}catch(t){if(t instanceof Bs&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Bs&&r.status===409)return;throw r}}};function cn(e){return e.join("")}var ly=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${cn(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${cn(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${cn(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${cn(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${cn(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${cn(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Bs&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Bs&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},cy=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=iy({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new oy(this.client,t),this.tableOps=new ly(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},ki=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Te(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var uy=class extends ki{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},fl=class extends ki{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const _c=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),dy=()=>Response,ml=e=>{if(Array.isArray(e))return e.map(r=>ml(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=ml(n)}),t},hy=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},fy=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function zs(e){"@babel/helpers - typeof";return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(e)}function my(e,t){if(zs(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zs(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function py(e){var t=my(e,"string");return zs(t)=="symbol"?t:t+""}function gy(e,t,r){return(t=py(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function he(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yu(Object(r),!0).forEach(function(n){gy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yu(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const ao=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},vy=async(e,t,r)=>{e instanceof await dy()&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const a=e.status||500,i=(n==null?void 0:n.statusCode)||a+"";t(new uy(ao(n),a,i))}).catch(n=>{t(new fl(ao(n),n))}):t(new fl(ao(e),e))},yy=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(hy(n)?(a.headers=he({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),he(he({},a),r))};async function Zs(e,t,r,n,a,i){return new Promise((o,l)=>{e(r,yy(t,n,a,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>vy(c,l,n))})}async function Ks(e,t,r,n){return Zs(e,"GET",t,r,n)}async function $t(e,t,r,n,a){return Zs(e,"POST",t,n,a,r)}async function pl(e,t,r,n,a){return Zs(e,"PUT",t,n,a,r)}async function wy(e,t,r,n){return Zs(e,"HEAD",t,he(he({},r),{},{noResolveJson:!0}),n)}async function xc(e,t,r,n,a){return Zs(e,"DELETE",t,n,a,r)}var _y=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Te(t))return{data:null,error:t};throw t}}};let Bf;Bf=Symbol.toStringTag;var xy=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Bf]="BlobDownloadBuilder",this.promise=null}asStream(){return new _y(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Te(t))return{data:null,error:t};throw t}}};const jy={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Xu={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var by=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=_c(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,n){var a=this;try{let i;const o=he(he({},Xu),n);let l=he(he({},a.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",a.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),c&&!i.has("metadata")&&i.append("metadata",a.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=a.toBase64(a.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),n!=null&&n.headers&&(l=he(he({},l),n.headers));const u=a._removeEmptyFolders(t),d=a._getFinalPath(u),p=await(e=="PUT"?pl:$t)(a.fetch,`${a.url}/object/${d}`,i,he({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:p.Id,fullPath:p.Key},error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(Te(i))return{data:null,error:i};throw i}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var a=this;const i=a._removeEmptyFolders(e),o=a._getFinalPath(i),l=new URL(a.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const u=he({upsert:Xu.upsert},n),d=he(he({},a.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",u.cacheControl)):(c=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:i,fullPath:(await pl(a.fetch,l.toString(),c,{headers:d})).Key},error:null}}catch(c){if(a.shouldThrowOnError)throw c;if(Te(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(e,t){var r=this;try{let n=r._getFinalPath(e);const a=he({},r.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const i=await $t(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:a}),o=new URL(r.url+i.url),l=o.searchParams.get("token");if(!l)throw new ki("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;try{return{data:await $t(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Te(a))return{data:null,error:a};throw a}}async copy(e,t,r){var n=this;try{return{data:{path:(await $t(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Te(a))return{data:null,error:a};throw a}}async createSignedUrl(e,t,r){var n=this;try{let a=n._getFinalPath(e),i=await $t(n.fetch,`${n.url}/object/sign/${a}`,he({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${n.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Te(a))return{data:null,error:a};throw a}}async createSignedUrls(e,t,r){var n=this;try{const a=await $t(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(o=>he(he({},o),{},{signedUrl:o.signedURL?encodeURI(`${n.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Te(a))return{data:null,error:a};throw a}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=n?`?${n}`:"",i=this._getFinalPath(e),o=()=>Ks(this.fetch,`${this.url}/${r}/${i}${a}`,{headers:this.headers,noResolveJson:!0});return new xy(o,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:ml(await Ks(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await wy(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Te(n)&&n instanceof fl){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const i=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});o!==""&&n.push(o);let l=n.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${l}`)}}}async remove(e){var t=this;try{return{data:await xc(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}async list(e,t,r){var n=this;try{const a=he(he(he({},jy),t),{},{prefix:e||""});return{data:await $t(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},r),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Te(a))return{data:null,error:a};throw a}}async listV2(e,t){var r=this;try{const n=he({},e);return{data:await $t(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const zf="2.89.0",Kf={"X-Client-Info":`storage-js/${zf}`};var Sy=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1;const a=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=he(he({},Kf),t),this.fetch=_c(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await Ks(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Ks(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await $t(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var r=this;try{return{data:await pl(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await $t(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await xc(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},ky=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=he(he({},Kf),t),this.fetch=_c(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await $t(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),a=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await Ks(t.fetch,a,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await xc(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!fy(e))throw new ki("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new cy({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(a,i){const o=a[i];return typeof o!="function"?o:async(...l)=>{try{return{data:await o.apply(a,l),error:null}}catch(c){if(n)throw c;return{data:null,error:c}}}}})}};const jc={"X-Client-Info":`storage-js/${zf}`,"Content-Type":"application/json"};var qf=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function _t(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var io=class extends qf{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Ey=class extends qf{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const bc=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Ny=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Zu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Cy=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,a=e;if(typeof a.json=="function")a.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||n+"";t(new io(Zu(i),n,o))}).catch(()=>{const i=n+"";t(new io(a.statusText||`HTTP ${n} error`,n,i))});else{const i=n+"";t(new io(a.statusText||`HTTP ${n} error`,n,i))}}else t(new Ey(Zu(e),e))},Ty=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(Ny(n)?(a.headers=he({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,he(he({},a),r)):a};async function Py(e,t,r,n,a,i){return new Promise((o,l)=>{e(r,Ty(t,n,a,i)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>Cy(c,l,n))})}async function xt(e,t,r,n,a){return Py(e,"POST",t,n,a,r)}var Ry=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=he(he({},jc),t),this.fetch=bc(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await xt(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await xt(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(_t(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await xt(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await xt(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(_t(n))return{data:null,error:n};throw n}}},Ay=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=he(he({},jc),t),this.fetch=bc(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await xt(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await xt(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await xt(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await xt(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await xt(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}}},Oy=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=he(he({},jc),t),this.fetch=bc(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await xt(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await xt(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await xt(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await xt(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(_t(r))return{data:null,error:r};throw r}}},Iy=class extends Oy{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new Dy(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},Dy=class extends Ry{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,he(he({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,he(he({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new Ly(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},Ly=class extends Ay{constructor(e,t,r,n,a){super(e,t,a),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,he(he({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,he(he({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,he(he({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,he(he({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,he(he({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},$y=class extends Sy{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new by(this.url,this.headers,e,this.fetch)}get vectors(){return new Iy(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ky(this.url+"/iceberg",this.headers,this.fetch)}};const Wf="2.89.0",gn=30*1e3,gl=3,oo=gl*gn,Uy="http://localhost:9999",Fy="supabase.auth.token",My={"X-Client-Info":`gotrue-js/${Wf}`},vl="X-Supabase-Api-Version",Hf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},By=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,zy=10*60*1e3;class qs extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function le(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Ky extends qs{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function qy(e){return le(e)&&e.name==="AuthApiError"}class Vr extends qs{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class dr extends qs{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class yt extends dr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Wy(e){return le(e)&&e.name==="AuthSessionMissingError"}class un extends dr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class wa extends dr{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class _a extends dr{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Hy(e){return le(e)&&e.name==="AuthImplicitGrantRedirectError"}class ed extends dr{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Vy extends dr{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class yl extends dr{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function lo(e){return le(e)&&e.name==="AuthRetryableFetchError"}class td extends dr{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class wl extends dr{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const si="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),rd=` 	
\r=`.split(""),Jy=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<rd.length;t+=1)e[rd[t].charCodeAt(0)]=-2;for(let t=0;t<si.length;t+=1)e[si[t].charCodeAt(0)]=t;return e})();function nd(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(si[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(si[n]),t.queuedBits-=6}}function Vf(e,t,r){const n=Jy[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function sd(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{Yy(o,n,r)};for(let o=0;o<e.length;o+=1)Vf(e.charCodeAt(o),a,i);return t.join("")}function Gy(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Qy(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}Gy(n,t)}}function Yy(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function $n(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Vf(e.charCodeAt(a),r,n);return new Uint8Array(t)}function Xy(e){const t=[];return Qy(e,r=>t.push(r)),new Uint8Array(t)}function Yr(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>nd(a,r,n)),nd(null,r,n),t.join("")}function Zy(e){return Math.round(Date.now()/1e3)+e}function ew(){return Symbol("auth-callback")}const Ge=()=>typeof window<"u"&&typeof document<"u",Br={tested:!1,writable:!1},Jf=()=>{if(!Ge())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Br.tested)return Br.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Br.tested=!0,Br.writable=!0}catch{Br.tested=!0,Br.writable=!1}return Br.writable};function tw(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const Gf=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),rw=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",vn=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},zr=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Je=async(e,t)=>{await e.removeItem(t)};class Ei{constructor(){this.promise=new Ei.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Ei.promiseConstructor=Promise;function co(e){const t=e.split(".");if(t.length!==3)throw new wl("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!By.test(t[n]))throw new wl("JWT not in base64url format");return{header:JSON.parse(sd(t[0])),payload:JSON.parse(sd(t[1])),signature:$n(t[2]),raw:{header:t[0],payload:t[1]}}}async function nw(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function sw(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){n(o);return}}catch(o){if(!t(i,o)){a(o);return}}})()})}function aw(e){return("0"+e.toString(16)).substr(-2)}function iw(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,aw).join("")}async function ow(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function lw(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await ow(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function dn(e,t,r=!1){const n=iw();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await vn(e,`${t}-code-verifier`,a);const i=await lw(n);return[i,n===i?"plain":"s256"]}const cw=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function uw(e){const t=e.headers.get(vl);if(!t||!t.match(cw))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function dw(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function hw(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const fw=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function hn(e){if(!fw.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function uo(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function mw(e,t){return new Proxy(e,{get:(r,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,a)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,a)}})}function ad(e){return JSON.parse(JSON.stringify(e))}const Wr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),pw=[502,503,504];async function id(e){var t;if(!rw(e))throw new yl(Wr(e),0);if(pw.includes(e.status))throw new yl(Wr(e),e.status);let r;try{r=await e.json()}catch(i){throw new Vr(Wr(i),i)}let n;const a=uw(e);if(a&&a.getTime()>=Hf["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new td(Wr(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new yt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new td(Wr(r),e.status,r.weak_password.reasons);throw new Ky(Wr(r),e.status||500,n)}const gw=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function de(e,t,r,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[vl]||(i[vl]=Hf["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await vw(e,t,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function vw(e,t,r,n,a,i){const o=gw(t,n,a,i);let l;try{l=await e(r,Object.assign({},o))}catch(c){throw console.error(c),new yl(Wr(c),0)}if(l.ok||await id(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await id(c)}}function Dt(e){var t;let r=null;_w(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Zy(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function od(e){const t=Dt(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function wr(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function yw(e){return{data:e,error:null}}function ww(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,o=Si(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function ld(e){return e}function _w(e){return e.access_token&&e.refresh_token&&e.expires_in}const ho=["global","local","others"];class xw{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Gf(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=ho[0]){if(ho.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ho.join(", ")}`);try{return await de(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(le(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await de(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:wr})}catch(n){if(le(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Si(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await de(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:ww,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(le(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await de(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:wr})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await de(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:ld});if(d.error)throw d.error;const p=await d.json(),h=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,_=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return _.length>0&&(_.forEach(y=>{const j=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(y.split(";")[1].split("=")[1]);u[`${w}Page`]=j}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},p),u),error:null}}catch(u){if(le(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){hn(t);try{return await de(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:wr})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){hn(t);try{return await de(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:wr})}catch(n){if(le(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){hn(t);try{return await de(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:wr})}catch(n){if(le(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){hn(t.userId);try{const{data:r,error:n}=await de(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(le(r))return{data:null,error:r};throw r}}async _deleteFactor(t){hn(t.userId),hn(t.id);try{return{data:await de(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(le(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await de(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:ld});if(d.error)throw d.error;const p=await d.json(),h=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,_=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return _.length>0&&(_.forEach(y=>{const j=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(y.split(";")[1].split("=")[1]);u[`${w}Page`]=j}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},p),u),error:null}}catch(u){if(le(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await de(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(le(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await de(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(le(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await de(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(le(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await de(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(le(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await de(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(le(r))return{data:null,error:r};throw r}}}function cd(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const fn={debug:!!(globalThis&&Jf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Qf extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class jw extends Qf{}async function bw(e,t,r){fn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),fn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){fn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{fn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw fn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new jw(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(fn.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Sw(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Yf(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function kw(e){return parseInt(e,16)}function Ew(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function Nw(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:c,resources:u,scheme:d,uri:p,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const _=Yf(e.address),y=d?`${d}://${n}`:n,j=e.statement?`${e.statement}
`:"",w=`${y} wants you to sign in with your Ethereum account:
${_}

${j}`;let m=`URI: ${p}
Version: ${h}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(a&&(m+=`
Expiration Time: ${a.toISOString()}`),l&&(m+=`
Not Before: ${l.toISOString()}`),c&&(m+=`
Request ID: ${c}`),u){let f=`
Resources:`;for(const g of u){if(!g||typeof g!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${g}`);f+=`
- ${g}`}m+=f}return`${w}
${m}`}class Fe extends Error{constructor({message:t,code:r,cause:n,name:a}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=a??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class ai extends Fe{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function Cw({error:e,options:t}){var r,n,a;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Fe({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Fe({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Fe({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Fe({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Fe({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Fe({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Fe({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Fe({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(Xf(o)){if(i.rp.id!==o)return new Fe({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Fe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Fe({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Fe({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Fe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function Tw({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Fe({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Fe({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(Xf(n)){if(r.rpId!==n)return new Fe({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Fe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Fe({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Fe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class Pw{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const Rw=new Pw;function Aw(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=Si(e,["challenge","user","excludeCredentials"]),i=$n(t).buffer,o=Object.assign(Object.assign({},r),{id:$n(r.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:i,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:$n(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function Ow(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Si(e,["challenge","allowCredentials"]),a=$n(t).buffer,i=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:$n(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function Iw(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Yr(new Uint8Array(e.response.attestationObject)),clientDataJSON:Yr(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Dw(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Yr(new Uint8Array(a.authenticatorData)),clientDataJSON:Yr(new Uint8Array(a.clientDataJSON)),signature:Yr(new Uint8Array(a.signature)),userHandle:a.userHandle?Yr(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Xf(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function ud(){var e,t;return!!(Ge()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function Lw(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new ai("Browser returned unexpected credential type",t)}:{data:null,error:new ai("Empty credential response",t)}}catch(t){return{data:null,error:Cw({error:t,options:e})}}}async function $w(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new ai("Browser returned unexpected credential type",t)}:{data:null,error:new ai("Empty credential response",t)}}catch(t){return{data:null,error:Tw({error:t,options:e})}}}const Uw={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Fw={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ii(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const i in a){const o=a[i];if(o!==void 0)if(Array.isArray(o))n[i]=o;else if(r(o))n[i]=o;else if(t(o)){const l=n[i];t(l)?n[i]=ii(l,o):n[i]=ii(o)}else n[i]=o}return n}function Mw(e,t){return ii(Uw,e,t||{})}function Bw(e,t){return ii(Fw,e,t||{})}class zw{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},i){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const c=a??Rw.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=Mw(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:d,error:p}=await Lw({publicKey:u,signal:c});return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:p}}case"request":{const u=Bw(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:d,error:p}=await $w(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:p}}}}catch(o){return le(o)?{data:null,error:o}:{data:null,error:new Vr("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new qs("rpId is required for WebAuthn authentication")};try{if(!ud())return{data:null,error:new Vr("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:i});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(o){return le(o)?{data:null,error:o}:{data:null,error:new Vr("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new qs("rpId is required for WebAuthn registration")};try{if(!ud())return{data:null,error:new Vr("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(d=>{var p;return(p=d.data)===null||p===void 0?void 0:p.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:i});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(o){return le(o)?{data:null,error:o}:{data:null,error:new Vr("Unexpected error in register",o)}}}}Sw();const Kw={url:Uy,storageKey:Fy,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:My,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function dd(e,t,r){return await r()}const mn={};class Ws{get jwks(){var t,r;return(r=(t=mn[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){mn[this.storageKey]=Object.assign(Object.assign({},mn[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=mn[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){mn[this.storageKey]=Object.assign(Object.assign({},mn[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},Kw),t);if(this.storageKey=i.storageKey,this.instanceID=(r=Ws.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Ws.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Ge()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new xw({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Gf(i.fetch),this.lock=i.lock||dd,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&Ge()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=bw:this.lock=dd,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new zw(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Jf()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=cd(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=cd(this.memoryStorage)),Ge()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Wf}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(Ge()&&(r=tw(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),Ge()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Hy(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return le(r)?this._returnResult({error:r}):this._returnResult({error:new Vr("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Dt}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(le(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:d,password:p,options:h}=t;let _=null,y=null;this.flowType==="pkce"&&([_,y]=await dn(this.storage,this.storageKey)),i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:p,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:_,code_challenge_method:y},xform:Dt})}else if("phone"in t){const{phone:d,password:p,options:h}=t;i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:p,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Dt})}else throw new wa("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return await Je(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(await Je(this.storage,`${this.storageKey}-code-verifier`),le(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:l}=t;r=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:od})}else if("phone"in t){const{phone:i,password:o,options:l}=t;r=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:od})}else throw new wa("You must provide either an email or phone number and a password");const{data:n,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const i=new un;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,i,o,l,c,u,d,p,h;let _,y;if("message"in t)_=t.message,y=t.signature;else{const{chain:j,wallet:w,statement:m,options:f}=t;let g;if(Ge())if(typeof w=="object")g=w;else{const R=window;if("ethereum"in R&&typeof R.ethereum=="object"&&"request"in R.ethereum&&typeof R.ethereum.request=="function")g=R.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(f!=null&&f.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=w}const b=new URL((r=f==null?void 0:f.url)!==null&&r!==void 0?r:window.location.href),L=await g.request({method:"eth_requestAccounts"}).then(R=>R).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!L||L.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const A=Yf(L[0]);let k=(n=f==null?void 0:f.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!k){const R=await g.request({method:"eth_chainId"});k=kw(R)}const N={domain:b.host,address:A,statement:m,uri:b.href,version:"1",chainId:k,nonce:(a=f==null?void 0:f.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(o=(i=f==null?void 0:f.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=f==null?void 0:f.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=f==null?void 0:f.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=f==null?void 0:f.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=f==null?void 0:f.signInWithEthereum)===null||d===void 0?void 0:d.resources};_=Nw(N),y=await g.request({method:"personal_sign",params:[Ew(_),A]})}try{const{data:j,error:w}=await de(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:y},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Dt});if(w)throw w;if(!j||!j.session||!j.user){const m=new un;return this._returnResult({data:{user:null,session:null},error:m})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:w})}catch(j){if(le(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async signInWithSolana(t){var r,n,a,i,o,l,c,u,d,p,h,_;let y,j;if("message"in t)y=t.message,j=t.signature;else{const{chain:w,wallet:m,statement:f,options:g}=t;let b;if(Ge())if(typeof m=="object")b=m;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))b=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=m}const L=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const A=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:L.host,uri:L.href}),f?{statement:f}:null));let k;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")k=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)k=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)y=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),j=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${L.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1",`URI: ${L.href}`,`Issued At: ${(a=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=g==null?void 0:g.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((u=g==null?void 0:g.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((p=(d=g==null?void 0:g.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||p===void 0)&&p.length?["Resources",...g.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const A=await b.signMessage(new TextEncoder().encode(y),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");j=A}}try{const{data:w,error:m}=await de(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:Yr(j)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(_=t.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Dt});if(m)throw m;if(!w||!w.session||!w.user){const f=new un;return this._returnResult({data:{user:null,session:null},error:f})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:m})}catch(w){if(le(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async _exchangeCodeForSession(t){const r=await zr(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new Vy;const{data:i,error:o}=await de(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Dt});if(await Je(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new un;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(await Je(this.storage,`${this.storageKey}-code-verifier`),le(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:o}=t,l=await de(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Dt}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new un;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,a,i,o;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await dn(this.storage,this.storageKey));const{error:p}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new wa("You must provide either an email or phone number.")}catch(l){if(await Je(this.storage,`${this.storageKey}-code-verifier`),le(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await de(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Dt});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(le(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,n,a,i,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await dn(this.storage,this.storageKey));const u=await de(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:yw});return!((i=u.data)===null||i===void 0)&&i.url&&Ge()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(await Je(this.storage,`${this.storageKey}-code-verifier`),le(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new yt;const{error:a}=await de(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:o}=await de(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:o,error:l}=await de(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new wa("You must provide either an email or phone number and a type")}catch(r){if(le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await zr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<oo:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await zr(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=uo()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=mw(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:wr}):await this._useSession(async r=>{var n,a,i;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new yt}:await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:wr})})}catch(r){if(le(r))return Wy(r)&&(await this._removeSession(),await Je(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new yt;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await dn(this.storage,this.storageKey));const{data:u,error:d}=await de(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:wr});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await Je(this.storage,`${this.storageKey}-code-verifier`),le(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new yt;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:o}=co(t.access_token);if(o.exp&&(n=o.exp,a=n<=r),a){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(le(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new yt;const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!Ge())throw new _a("No browser detected.");if(t.error||t.error_description||t.error_code)throw new _a(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new ed("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new _a("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new ed("No code detected.");const{data:f,error:g}=await this._exchangeCodeForSession(t.code);if(g)throw g;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:f.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=t;if(!i||!l||!o||!u)throw new _a("No session defined in URL");const d=Math.round(Date.now()/1e3),p=parseInt(l);let h=d+p;c&&(h=parseInt(c));const _=h-d;_*1e3<=gn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${p}s`);const y=h-p;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,h,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,h,d);const{data:j,error:w}=await this._getUser(i);if(w)throw w;const m={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:p,expires_at:h,refresh_token:o,token_type:u,user:j.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:m,redirectType:t.type},error:null})}catch(n){if(le(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await zr(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({error:i});const o=(n=a.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(qy(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Je(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=ew(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await dn(this.storage,this.storageKey,!0));try{return await de(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await Je(this.storage,`${this.storageKey}-code-verifier`),le(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(le(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var o,l,c,u,d;const{data:p,error:h}=i;if(h)throw h;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await de(this.fetch,"GET",_,{headers:this.headers,jwt:(d=(u=p.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(a)throw a;return Ge()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(le(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:i}}=r;if(a)throw a;const{options:o,provider:l,token:c,access_token:u,nonce:d}=t,p=await de(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i==null?void 0:i.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Dt}),{data:h,error:_}=p;return _?this._returnResult({data:{user:null,session:null},error:_}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new un}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:_}))}catch(a){if(await Je(this.storage,`${this.storageKey}-code-verifier`),le(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:o}=r;if(o)throw o;return await de(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(le(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await sw(async a=>(a>0&&await nw(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await de(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Dt})),(a,i)=>{const o=200*Math.pow(2,a);return i&&lo(i)&&Date.now()+o-n<gn})}catch(n){if(this._debug(r,"error",n),le(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Ge()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await zr(this.storage,this.storageKey);if(a&&this.userStorage){let o=await zr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await vn(this.userStorage,this.storageKey+"-user",o)),a.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:uo()}else if(a&&!a.user&&!a.user){const o=await zr(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,await Je(this.storage,this.storageKey+"-user"),await vn(this.storage,this.storageKey,a)):a.user=uo()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<oo;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${oo}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),lo(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(a.access_token);!l&&(o!=null&&o.user)?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new yt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Ei;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new yt;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),le(i)){const o={data:null,error:i};return lo(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Je(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await vn(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=ad(a);await vn(this.storage,this.storageKey,i)}else{const a=ad(r);await vn(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Je(this.storage,this.storageKey),await Je(this.storage,this.storageKey+"-code-verifier"),await Je(this.storage,this.storageKey+"-user"),this.userStorage&&await Je(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ge()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),gn);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/gn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${gn}ms, refresh threshold is ${gl} ticks`),a<=gl&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Qf)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ge()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await dn(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?this._returnResult({data:null,error:i}):await de(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(le(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await de(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(le(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Iw(t.webauthn.credential_response):Dw(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await de(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(le(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await de(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Aw(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Ow(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(le(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=co(n.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?await de(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new yt})})}catch(r){if(le(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new yt});const o=await de(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Ge()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(le(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new yt});const o=await de(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Ge()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(le(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await de(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new yt})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?(await de(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new yt})})}catch(r){if(le(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+zy>a)return n;const{data:i,error:o}=await de(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:_,error:y}=await this.getSession();if(y||!_.session)return this._returnResult({data:null,error:y});n=_.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:c}}=co(n);r!=null&&r.allowExpired||dw(i.exp);const u=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:_}=await this.getUser(n);if(_)throw _;return{data:{claims:i,header:a,signature:o},error:null}}const d=hw(a.alg),p=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,p,o,Xy(`${l}.${c}`)))throw new wl("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(n){if(le(n))return this._returnResult({data:null,error:n});throw n}}}Ws.nextInstanceID={};const qw=Ws,Ww="2.89.0";let us="";typeof Deno<"u"?us="deno":typeof document<"u"?us="web":typeof navigator<"u"&&navigator.product==="ReactNative"?us="react-native":us="node";const Hw={"X-Client-Info":`supabase-js-${us}/${Ww}`},Vw={headers:Hw},Jw={schema:"public"},Gw={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Qw={};function Hs(e){"@babel/helpers - typeof";return Hs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hs(e)}function Yw(e,t){if(Hs(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hs(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xw(e){var t=Yw(e,"string");return Hs(t)=="symbol"?t:t+""}function Zw(e,t,r){return(t=Xw(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ie(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hd(Object(r),!0).forEach(function(n){Zw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hd(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const e_=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),t_=()=>Headers,r_=(e,t,r)=>{const n=e_(r),a=t_();return async(i,o)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let u=new a(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(i,Ie(Ie({},o),{},{headers:u}))}};function n_(e){return e.endsWith("/")?e:e+"/"}function s_(e,t){var r,n;const{db:a,auth:i,realtime:o,global:l}=e,{db:c,auth:u,realtime:d,global:p}=t,h={db:Ie(Ie({},c),a),auth:Ie(Ie({},u),i),realtime:Ie(Ie({},d),o),storage:{},global:Ie(Ie(Ie({},p),l),{},{headers:Ie(Ie({},(r=p==null?void 0:p.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function a_(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(n_(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var i_=class extends qw{constructor(e){super(e)}},o_=class{constructor(e,t,r){var n,a;this.supabaseUrl=e,this.supabaseKey=t;const i=a_(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,l={db:Jw,realtime:Qw,auth:Ie(Ie({},Gw),{},{storageKey:o}),global:Vw},c=s_(r??{},l);if(this.storageKey=(n=c.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=c.global.headers)!==null&&a!==void 0?a:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(d,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=c.auth)!==null&&u!==void 0?u:{},this.headers,c.global.fetch)}this.fetch=r_(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Ie({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new Mv(new URL("rest/v1",i).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new $y(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new Dv(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,storageKey:i,flowType:o,lock:l,debug:c,throwOnError:u},d,p){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new i_({url:this.authUrl.href,headers:Ie(Ie({},h),d),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,flowType:o,lock:l,debug:c,throwOnError:u,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new ny(this.realtimeUrl.href,Ie(Ie({},e),{},{params:Ie(Ie({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const l_=(e,t,r)=>new o_(e,t,r);function c_(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}c_()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const u_="https://itnuwexelosjzlwlqqce.supabase.co",d_="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml0bnV3ZXhlbG9zanpsd2xxcWNlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5ODEwOTIsImV4cCI6MjA4MjU1NzA5Mn0.3TQlsz6BQioMcJP05Xar-EqtKaWLToGdlnVYPTv69I0",U=l_(u_,d_);function Ht({children:e}){const t=Xs(),r=Qn(),[n,a]=v.useState(null),[i,o]=v.useState(null),[l,c]=v.useState(null),[u,d]=v.useState({}),[p,h]=v.useState(!0),[_,y]=v.useState(!1),[j,w]=v.useState(!1),[m,f]=v.useState({});v.useEffect(()=>{g()},[]);const g=async()=>{console.log("Layout: Starting loadUser...");try{const{data:{user:N},error:R}=await U.auth.getUser();if(console.log("Layout: User fetched:",N==null?void 0:N.email,"Error:",R),!N){console.log("Layout: No user found"),h(!1);return}a(N),console.log("Layout: Fetching role for user:",N.id);const{data:S,error:B}=await U.from("user_roles").select("role, theme").eq("user_id",N.id).maybeSingle();console.log("Layout: Role query result:",{roleData:S,roleError:B});const H=(S==null?void 0:S.role)||"member";console.log("Layout: Setting role:",H),c(H);const J=(S==null?void 0:S.theme)||"warm_white";console.log("Layout: Applying theme:",J),document.body.className="",document.body.classList.add(`theme-${J}`),console.log("Layout: Fetching member data for user:",N.id);const{data:V}=await U.from("members").select("full_name").eq("user_id",N.id).maybeSingle();V&&(console.log("Layout: Member name:",V.full_name),o(V.full_name)),console.log("Layout: Fetching permissions for role:",H);const{data:Y,error:ue}=await U.from("role_permissions").select("*").eq("role",H);console.log("Layout: Permissions query result:",{permsData:Y,permsError:ue});const O={};Y==null||Y.forEach($=>{O[$.menu]={can_view:$.can_view,can_create:$.can_create,can_edit:$.can_edit,can_delete:$.can_delete}}),console.log("Layout: Permissions map:",O),d(O)}catch(N){console.error("Layout: Error loading user:",N)}finally{console.log("Layout: Loading complete"),h(!1)}},b=async()=>{await U.auth.signOut(),t("/login")},L=N=>{var R;return((R=u[N])==null?void 0:R.can_view)||!1},A=N=>{f(R=>({...R,[N]:!R[N]}))};if(p)return s.jsx("div",{className:"loading-screen",children:"Loading..."});if(!n)return null;const k=[{path:"/",label:"Dashboard",icon:"",menu:"dashboard"},{path:"/members",label:"Anggota",icon:"",menu:"members"},{path:"/savings",label:"Simpanan",icon:"",menu:"savings"},{path:"/loans",label:"Pinjaman",icon:"",menu:"loans"},{path:"/reports",label:"Laporan",icon:"",menu:"reports"},{path:"/cooperatives",label:"Koperasi",icon:"",menu:"cooperatives",subMenu:[{path:"/journal-operasional",label:"Jurnal Operasional",icon:"",menu:"journal_operasional"}]},{path:"/audit-logs",label:"Riwayat",icon:"",menu:"audit_logs"},{path:"/admin",label:"Admin",icon:"",menu:"admin"},{path:"/profile",label:"Profile",icon:"",menu:"profile"}];return s.jsxs("div",{className:`app-layout ${j?"sidebar-collapsed":""}`,children:[s.jsx("button",{className:"mobile-menu-toggle",onClick:()=>y(!_),"aria-label":"Toggle menu",children:_?"":""}),s.jsxs("nav",{className:`sidebar ${_?"open":""} ${j?"collapsed":""}`,children:[s.jsxs("div",{className:"sidebar-header",children:[s.jsxs("div",{className:"logo-title",children:[s.jsx("img",{src:"/kop_logo.jpg",alt:"KOP Logo",className:"sidebar-logo"}),s.jsxs("div",{className:"title-text",children:[s.jsx("h2",{children:"SIMAKOM"}),s.jsx("p",{children:l==="super_admin"?"Super Admin":l==="credit_staff"?"Credit Staff":(l==null?void 0:l.charAt(0).toUpperCase())+(l==null?void 0:l.slice(1))})]})]}),s.jsx("button",{className:"sidebar-toggle",onClick:()=>w(!j),"aria-label":j?"Expand sidebar":"Collapse sidebar",children:j?"":""})]}),s.jsx("ul",{className:"sidebar-menu",children:k.map(N=>{if(!L(N.menu))return null;const R=N.subMenu&&N.subMenu.length>0,S=m[N.path],B=R&&N.subMenu.some(H=>r.pathname===H.path);return s.jsx("li",{className:R?"has-submenu":"",children:R?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`menu-item-with-submenu ${B?"parent-active":""}`,onClick:()=>A(N.path),children:[s.jsxs(ro,{to:N.path,className:r.pathname===N.path?"active":"",onClick:H=>{H.stopPropagation(),y(!1)},children:[s.jsx("span",{className:"menu-icon",children:N.icon}),s.jsx("span",{children:N.label})]}),s.jsx("span",{className:"submenu-toggle",children:S?"":""})]}),S&&s.jsx("ul",{className:"submenu",children:N.subMenu.map(H=>L(H.menu)&&s.jsx("li",{children:s.jsxs(ro,{to:H.path,className:r.pathname===H.path?"active":"",onClick:()=>y(!1),children:[s.jsx("span",{className:"menu-icon",children:H.icon}),s.jsx("span",{children:H.label})]})},H.path))})]}):s.jsxs(ro,{to:N.path,className:r.pathname===N.path?"active":"",onClick:()=>y(!1),children:[s.jsx("span",{className:"menu-icon",children:N.icon}),s.jsx("span",{children:N.label})]})},N.path)})}),s.jsxs("div",{className:"sidebar-footer",children:[s.jsxs("div",{className:"user-info",children:[i&&s.jsx("p",{className:"user-name",children:i}),s.jsx("p",{className:"user-email",children:n==null?void 0:n.email})]}),s.jsxs("button",{onClick:b,className:"logout-button",children:[s.jsx("span",{className:"logout-icon",children:""}),s.jsx("span",{className:"logout-text",children:"Logout"})]})]})]}),s.jsx("main",{className:"main-content",children:e})]})}function h_(){const e=Xs(),[t,r]=v.useState(""),[n,a]=v.useState(""),[i,o]=v.useState(!1),[l,c]=v.useState(""),[u,d]=v.useState(""),[p,h]=v.useState("login"),_=async m=>{m.preventDefault(),o(!0),c(""),d("");const{data:f,error:g}=await U.auth.signInWithPassword({email:t,password:n});g?(c(g.message),o(!1)):e("/")},y=async m=>{m.preventDefault(),o(!0),c(""),d("");const{data:f,error:g}=await U.auth.signUp({email:t,password:n});g?(c(g.message),o(!1)):(d("Akun berhasil dibuat! Silakan login."),r(""),a(""),h("login"),o(!1))},j=async m=>{m.preventDefault(),o(!0),c(""),d("");const{error:f}=await U.auth.resetPasswordForEmail(t,{redirectTo:`${window.location.origin}/reset-password`});f?c(f.message):(d("Email reset password telah dikirim. Silakan cek inbox Anda."),r("")),o(!1)},w=m=>{h(m),c(""),d(""),a("")};return s.jsx("div",{className:"login-container",children:s.jsxs("div",{className:"login-card",children:[s.jsxs("div",{className:"login-header",children:[s.jsx("h1",{children:"SIMAKOM"}),s.jsx("p",{children:"Sistem Informasi Manajemen Koperasi Modern"})]}),s.jsxs("form",{onSubmit:p==="forgot"?j:p==="signup"?y:_,className:"login-form",children:[l&&s.jsx("div",{className:"error-message",children:l}),u&&s.jsx("div",{className:"success-message",children:u}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"email",children:"Email"}),s.jsx("input",{id:"email",type:"email",value:t,onChange:m=>r(m.target.value),required:!0,placeholder:"nama@email.com"})]}),p!=="forgot"&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"password",children:"Password"}),s.jsx("input",{id:"password",type:"password",value:n,onChange:m=>a(m.target.value),required:!0,placeholder:"Masukkan password"})]}),s.jsx("button",{type:"submit",disabled:i,className:"login-button",children:i?"Loading...":p==="forgot"?"Kirim Link Reset":p==="signup"?"Daftar":"Login"})]}),s.jsxs("div",{className:"login-footer",children:[p==="login"&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["Belum punya akun? "," ",s.jsx("button",{type:"button",onClick:()=>w("signup"),disabled:i,className:"toggle-mode-button",children:"Daftar"})]}),s.jsx("p",{children:s.jsx("button",{type:"button",onClick:()=>w("forgot"),disabled:i,className:"toggle-mode-button",children:"Lupa Password?"})})]}),p==="signup"&&s.jsxs("p",{children:["Sudah punya akun? "," ",s.jsx("button",{type:"button",onClick:()=>w("login"),disabled:i,className:"toggle-mode-button",children:"Login"})]}),p==="forgot"&&s.jsxs("p",{children:["Ingat password? "," ",s.jsx("button",{type:"button",onClick:()=>w("login"),disabled:i,className:"toggle-mode-button",children:"Kembali ke Login"})]})]})]})})}function f_(){const e=Xs(),[t,r]=v.useState(""),[n,a]=v.useState(""),[i,o]=v.useState(!1),[l,c]=v.useState(""),[u,d]=v.useState(!1);v.useEffect(()=>{const{data:{subscription:h}}=U.auth.onAuthStateChange((_,y)=>{(async()=>_==="PASSWORD_RECOVERY"&&d(!1))()});return()=>{h.unsubscribe()}},[]);const p=async h=>{if(h.preventDefault(),o(!0),c(""),t!==n){c("Password tidak sama"),o(!1);return}if(t.length<6){c("Password minimal 6 karakter"),o(!1);return}const{error:_}=await U.auth.updateUser({password:t});_?(c(_.message),o(!1)):(d(!0),setTimeout(()=>{e("/login")},2e3))};return s.jsx("div",{className:"reset-password-container",children:s.jsxs("div",{className:"reset-password-card",children:[s.jsxs("div",{className:"reset-password-header",children:[s.jsx("h1",{children:"Reset Password"}),s.jsx("p",{children:"Masukkan password baru Anda"})]}),u?s.jsx("div",{className:"success-message",children:"Password berhasil diubah! Mengalihkan ke halaman login..."}):s.jsxs("form",{onSubmit:p,className:"reset-password-form",children:[l&&s.jsx("div",{className:"error-message",children:l}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"password",children:"Password Baru"}),s.jsx("input",{id:"password",type:"password",value:t,onChange:h=>r(h.target.value),required:!0,placeholder:"Minimal 6 karakter"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"confirmPassword",children:"Konfirmasi Password"}),s.jsx("input",{id:"confirmPassword",type:"password",value:n,onChange:h=>a(h.target.value),required:!0,placeholder:"Ketik ulang password"})]}),s.jsx("button",{type:"submit",disabled:i,className:"reset-button",children:i?"Loading...":"Reset Password"})]})]})})}const qt=async()=>{const{data:{user:e}}=await U.auth.getUser();if(!e)throw new Error("User not authenticated");const{data:t,error:r}=await U.from("user_access_info").select("*").eq("user_id",e.id).single();if(r)throw r;let n=null;if(t.role==="member"){const{data:a}=await U.from("members").select("id").eq("user_id",e.id).maybeSingle();n=(a==null?void 0:a.id)||null}return{userId:e.id,role:t.role,cooperativeIds:t.cooperative_ids||[],memberId:n}},qe=e=>e.role==="super_admin",Sc=e=>e.role==="member";function m_({data:e,title:t}){console.log(`=== PIECHART (${t}): Received data:`,e);const r=e.reduce((l,c)=>l+c.value,0);console.log(`=== PIECHART (${t}): Total:`,r);let n=0;const a=e.map((l,c)=>{const u=r>0?l.value/r*100:0,d={...l,percent:u,startPercent:n};return n+=u,d});console.log(`=== PIECHART (${t}): Segments:`,a);const i=(l,c)=>{const u=l/100*360,d=c/100*360,p=o(50,50,40,d),h=o(50,50,40,u),_=d-u<=180?0:1,y=`M 50 50 L ${p.x} ${p.y} A 40 40 0 ${_} 0 ${h.x} ${h.y} Z`;return console.log(`Arc: start=${l}%, end=${c}%, startAngle=${u}, endAngle=${d}, path=${y}`),y},o=(l,c,u,d)=>{const p=(d-90)*Math.PI/180;return{x:l+u*Math.cos(p),y:c+u*Math.sin(p)}};return s.jsxs("div",{className:"chart-card",children:[s.jsx("h3",{children:t}),s.jsxs("div",{className:"pie-chart-container",children:[s.jsx("svg",{viewBox:"0 0 100 100",className:"pie-chart",children:a.map((l,c)=>l.percent>=99.9?s.jsx("circle",{cx:"50",cy:"50",r:"40",fill:l.color},c):s.jsx("path",{d:i(l.startPercent,l.startPercent+l.percent),fill:l.color},c))}),s.jsx("div",{className:"pie-chart-legend",children:e.map((l,c)=>s.jsxs("div",{className:"legend-item",children:[s.jsx("span",{className:"legend-color",style:{backgroundColor:l.color}}),s.jsxs("span",{className:"legend-label",children:[l.label,": ",l.value]})]},c))})]})]})}function p_({data:e,title:t}){var n;console.log(`=== BARCHART (${t}): Received data:`,e);const r=Math.max(...e.map(a=>a.value),1);return console.log(`=== BARCHART (${t}): Max value:`,r),s.jsxs("div",{className:"chart-card",children:[s.jsx("h3",{children:t}),s.jsxs("div",{className:"bar-chart-container",children:[s.jsx("div",{className:"bar-chart",children:e.map((a,i)=>{const o=a.value/r*100;return console.log(`=== BARCHART (${t}): Bar ${i} - label: ${a.label}, value: ${a.value}, height: ${o}%, color: ${a.color}`),s.jsxs("div",{className:"bar-item",children:[s.jsx("div",{className:"bar-wrapper",children:s.jsx("div",{className:"bar",style:{height:`${o}%`,backgroundColor:a.color},children:s.jsx("span",{className:"bar-value",children:a.value.toLocaleString("id-ID")})})}),s.jsx("div",{className:"bar-label",children:a.label})]},i)})}),s.jsxs("div",{className:"bar-legend",children:[s.jsx("span",{className:"bar-legend-color",style:{backgroundColor:(n=e[0])==null?void 0:n.color}}),s.jsx("span",{className:"bar-legend-label",children:"Jumlah (Rp)"})]})]})]})}function g_(){const[e,t]=v.useState({totalMembers:0,totalSavings:0,totalLoans:0,activeLoans:0}),[r,n]=v.useState([]),[a,i]=v.useState([]),[o,l]=v.useState(!0);v.useEffect(()=>{c()},[]);const c=async()=>{var u,d,p,h,_,y,j,w;try{console.log("=== DASHBOARD: Loading stats started ===");const m=await qt();if(console.log("=== DASHBOARD: Access Info:",m),Sc(m)){if(!m.memberId){t({totalMembers:0,totalSavings:0,totalLoans:0,activeLoans:0}),n([]),i([]),l(!1);return}const[M,Q]=await Promise.all([U.from("savings").select("amount, saving_type").eq("member_id",m.memberId),U.from("loans").select("amount, status").eq("member_id",m.memberId)]),te=((u=M.data)==null?void 0:u.reduce((Z,C)=>Z+(parseFloat(C.amount)||0),0))||0,oe=((d=Q.data)==null?void 0:d.reduce((Z,C)=>Z+(parseFloat(C.amount)||0),0))||0,me=((p=Q.data)==null?void 0:p.filter(Z=>Z.status==="approved"||Z.status==="disbursed"||Z.status==="active").length)||0;t({totalMembers:1,totalSavings:te,totalLoans:oe,activeLoans:me});const se=(h=Q.data)==null?void 0:h.reduce((Z,C)=>{const I=C.status||"pending";return Z[I]=(Z[I]||0)+1,Z},{}),K=[];if((se==null?void 0:se.pending)>0&&K.push({label:"Menunggu",value:se.pending,color:"#FDB022"}),(se==null?void 0:se.approved)>0||(se==null?void 0:se.disbursed)>0||(se==null?void 0:se.active)>0){const Z=((se==null?void 0:se.approved)||0)+((se==null?void 0:se.disbursed)||0)+((se==null?void 0:se.active)||0);K.push({label:"Aktif",value:Z,color:"#2ECC71"})}(se==null?void 0:se.paid_off)>0&&K.push({label:"Lunas",value:se.paid_off,color:"#3498DB"}),(se==null?void 0:se.rejected)>0&&K.push({label:"Ditolak",value:se.rejected,color:"#E74C3C"}),n(K.length>0?K:[{label:"Tidak Ada Data",value:1,color:"#BDC3C7"}]);const G=(_=M.data)==null?void 0:_.reduce((Z,C)=>{const I=C.saving_type||"pokok";return Z[I]||(Z[I]=0),Z[I]+=parseFloat(C.amount)||0,Z},{}),P={pokok:"Pokok",wajib:"Wajib",sukarela:"Sukarela"},D={pokok:"#6B8DD6",wajib:"#7B9FE8",sukarela:"#8CB1FA"},q=[];(G==null?void 0:G.pokok)>0&&q.push({label:P.pokok,value:Math.round(G.pokok),color:D.pokok}),(G==null?void 0:G.wajib)>0&&q.push({label:P.wajib,value:Math.round(G.wajib),color:D.wajib}),(G==null?void 0:G.sukarela)>0&&q.push({label:P.sukarela,value:Math.round(G.sukarela),color:D.sukarela}),i(q.length>0?q:[{label:"Tidak Ada Data",value:1,color:"#BDC3C7"}]),l(!1);return}if(!qe(m)&&m.cooperativeIds.length===0){t({totalMembers:0,totalSavings:0,totalLoans:0,activeLoans:0}),n([]),i([]),l(!1);return}let f=U.from("members").select("id, cooperative_id",{count:"exact",head:!1});qe(m)||(f=f.in("cooperative_id",m.cooperativeIds));const g=await f,b=((y=g.data)==null?void 0:y.map(M=>M.id))||[];if(console.log("=== DASHBOARD: Member IDs for queries:",b),!qe(m)&&b.length===0){t({totalMembers:0,totalSavings:0,totalLoans:0,activeLoans:0}),n([{label:"Tidak Ada Data",value:1,color:"#BDC3C7"}]),i([{label:"Tidak Ada Data",value:1,color:"#BDC3C7"}]),l(!1);return}let L=U.from("savings").select("amount, saving_type, member_id"),A=U.from("loans").select("amount, status, member_id");qe(m)||(L=L.in("member_id",b),A=A.in("member_id",b));const[k,N]=await Promise.all([L,A]);N.error&&console.error("Error loading loans:",N.error),k.error&&console.error("Error loading savings:",k.error);const R=k.data||[],S=N.data||[];console.log("=== DASHBOARD: Loans data count:",S.length),console.log("=== DASHBOARD: Loans data:",S),console.log("=== DASHBOARD: Savings data count:",R.length),console.log("=== DASHBOARD: Savings data:",R),console.log("Members data count:",((j=g.data)==null?void 0:j.length)||0);const B=R.reduce((M,Q)=>M+(parseFloat(Q.amount)||0),0),H=S.reduce((M,Q)=>M+(parseFloat(Q.amount)||0),0),J=S.filter(M=>M.status==="approved"||M.status==="disbursed"||M.status==="active").length;t({totalMembers:((w=g.data)==null?void 0:w.length)||0,totalSavings:B,totalLoans:H,activeLoans:J});const V=S.reduce((M,Q)=>{const te=Q.status||"pending";return M[te]=(M[te]||0)+1,M},{});console.log("=== DASHBOARD: Loans by status:",V);const Y=[];if((V==null?void 0:V.pending)>0&&Y.push({label:"Menunggu",value:V.pending,color:"#FDB022"}),(V==null?void 0:V.approved)>0||(V==null?void 0:V.disbursed)>0||(V==null?void 0:V.active)>0){const M=((V==null?void 0:V.approved)||0)+((V==null?void 0:V.disbursed)||0)+((V==null?void 0:V.active)||0);Y.push({label:"Aktif",value:M,color:"#2ECC71"})}(V==null?void 0:V.paid_off)>0&&Y.push({label:"Lunas",value:V.paid_off,color:"#3498DB"}),(V==null?void 0:V.rejected)>0&&Y.push({label:"Ditolak",value:V.rejected,color:"#E74C3C"}),console.log("=== DASHBOARD: Final statusData for chart:",Y),n(Y.length>0?Y:[{label:"Tidak Ada Data",value:1,color:"#BDC3C7"}]);const ue=R.reduce((M,Q)=>{const te=Q.saving_type||"pokok";return M[te]||(M[te]=0),M[te]+=parseFloat(Q.amount)||0,M},{}),O={pokok:"Pokok",wajib:"Wajib",sukarela:"Sukarela"},$={pokok:"#6B8DD6",wajib:"#7B9FE8",sukarela:"#8CB1FA"},F=[];(ue==null?void 0:ue.pokok)>0&&F.push({label:O.pokok,value:Math.round(ue.pokok),color:$.pokok}),(ue==null?void 0:ue.wajib)>0&&F.push({label:O.wajib,value:Math.round(ue.wajib),color:$.wajib}),(ue==null?void 0:ue.sukarela)>0&&F.push({label:O.sukarela,value:Math.round(ue.sukarela),color:$.sukarela}),console.log("=== DASHBOARD: Savings grouped:",ue),console.log("=== DASHBOARD: Final savingsChartData for chart:",F),i(F.length>0?F:[{label:"Tidak Ada Data",value:1,color:"#BDC3C7"}])}catch(m){console.error("Error loading stats:",m)}finally{l(!1)}};return o?s.jsx("div",{className:"loading",children:"Loading dashboard..."}):s.jsxs("div",{className:"dashboard",children:[s.jsx("h1",{children:"Dashboard"}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("h3",{children:"Total Anggota"}),s.jsx("p",{className:"stat-value",children:e.totalMembers})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("h3",{children:"Total Simpanan"}),s.jsxs("p",{className:"stat-value",children:["Rp ",e.totalSavings.toLocaleString("id-ID")]})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("h3",{children:"Total Pinjaman"}),s.jsxs("p",{className:"stat-value",children:["Rp ",e.totalLoans.toLocaleString("id-ID")]})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("h3",{children:"Pinjaman Aktif"}),s.jsx("p",{className:"stat-value",children:e.activeLoans})]})]})]}),s.jsxs("div",{className:"charts-grid",children:[s.jsx(m_,{data:r,title:"Status Pinjaman"}),s.jsx(p_,{data:a,title:"Simpanan per Tipe"})]})]})}function v_(){const[e,t]=v.useState([]),[r,n]=v.useState(!0),[a,i]=v.useState(!1),[o,l]=v.useState(!1),[c,u]=v.useState(null),[d,p]=v.useState([]),[h,_]=v.useState(!1),[y,j]=v.useState(null),[w,m]=v.useState(1),[f,g]=v.useState("created_at"),[b,L]=v.useState("desc"),A=10,[k,N]=v.useState({full_name:"",email:"",phone:"",address:"",cooperative_id:""});v.useEffect(()=>{R(),S()},[]);const R=async()=>{try{const K=await qt();if(!qe(K)&&K.cooperativeIds.length===0){t([]),n(!1);return}let G=U.from("members").select("*, cooperatives (name)");qe(K)||(G=G.in("cooperative_id",K.cooperativeIds));const{data:P,error:D}=await G;if(D)throw D;t(P||[]),m(1)}catch(K){console.error("Error loading members:",K)}finally{n(!1)}},S=async()=>{try{const K=await qt();let G=U.from("cooperatives").select("id, name");qe(K)||(G=G.in("id",K.cooperativeIds));const{data:P,error:D}=await G.order("name");if(D)throw D;p(P||[])}catch(K){console.error("Error loading cooperatives:",K)}},B=()=>{u(null),N({full_name:"",email:"",phone:"",address:"",cooperative_id:""}),i(!0)},H=K=>{u(K),N({full_name:K.full_name,email:K.email,phone:K.phone,address:K.address,cooperative_id:K.cooperative_id}),i(!0)},J=async K=>{if(confirm("Apakah Anda yakin ingin menghapus anggota ini?"))try{const{error:G}=await U.from("members").delete().eq("id",K);if(G)throw G;alert("Anggota berhasil dihapus"),R()}catch(G){console.error("Error deleting member:",G),alert("Gagal menghapus anggota: "+G.message)}},V=async K=>{K.preventDefault();try{if(c){const{email:G,...P}=k,{error:D}=await U.from("members").update(P).eq("id",c.id);if(D)throw D;alert("Data anggota berhasil diupdate")}else{const{error:G}=await U.from("members").insert([k]);if(G)throw G;alert("Anggota berhasil ditambahkan")}i(!1),u(null),R()}catch(G){console.error("Error saving member:",G),alert("Gagal menyimpan data: "+G.message)}},Y=K=>{N({...k,[K.target.name]:K.target.value})},ue=K=>{f===K?L(b==="asc"?"desc":"asc"):(g(K),L("asc"))},O=()=>[...e].sort((G,P)=>{var Z,C;let D=G[f],q=P[f];return f==="cooperatives.name"&&(D=((Z=G.cooperatives)==null?void 0:Z.name)||"",q=((C=P.cooperatives)==null?void 0:C.name)||""),typeof D=="string"&&(D=D.toLowerCase(),q=(q==null?void 0:q.toLowerCase())||""),D<q?b==="asc"?-1:1:D>q?b==="asc"?1:-1:0}),$=()=>{const K=O(),G=(w-1)*A,P=G+A;return K.slice(G,P)},F=Math.ceil(e.length/A),M=$(),Q=K=>f!==K?" ":b==="asc"?" ":" ",te=()=>{const K=["cooperative_id","full_name","email","phone","address"],G=["contoh-id-koperasi","John Doe","john@example.com","081234567890","Jl. Contoh No. 123"],P=[K.join(","),G.join(",")].join(`
`),D=new Blob([P],{type:"text/csv;charset=utf-8;"}),q=document.createElement("a");q.href=URL.createObjectURL(D),q.download="template-import-anggota.csv",q.click()},oe=K=>{const G=K.split(`
`).filter(C=>C.trim());if(G.length<2)throw new Error("File CSV kosong atau tidak valid");const P=G[0].split(",").map(C=>C.trim()),q=["cooperative_id","full_name","email","phone","address"].filter(C=>!P.includes(C));if(q.length>0)throw new Error(`Header yang hilang: ${q.join(", ")}`);const Z=[];for(let C=1;C<G.length;C++){const I=G[C].split(",").map(ae=>ae.trim());if(I.length!==P.length)continue;const ie={};P.forEach((ae,fe)=>{ie[ae]=I[fe]}),ie.cooperative_id&&ie.full_name&&ie.email&&ie.phone&&ie.address&&Z.push(ie)}return Z},me=async K=>{const G=K.target.files[0];if(G){_(!0),j(null);try{const P=await G.text(),D=oe(P);if(D.length===0)throw new Error("Tidak ada data valid dalam file CSV");const q=d.map(ae=>ae.id),Z=[],C=[];if(D.forEach((ae,fe)=>{q.includes(ae.cooperative_id)?C.push(ae):Z.push({row:fe+2,reason:"ID Koperasi tidak valid"})}),C.length===0)throw new Error("Tidak ada data valid untuk diimport");const{data:I,error:ie}=await U.from("members").insert(C).select();if(ie)throw ie;j({success:I.length,failed:Z.length,invalidRows:Z}),R(),K.target.value=""}catch(P){console.error("Error importing CSV:",P),alert("Gagal import CSV: "+P.message)}finally{_(!1)}}},se=()=>{l(!0),j(null)};return r?s.jsx("div",{className:"loading",children:"Loading members..."}):s.jsxs("div",{className:"members-container",children:[s.jsxs("div",{className:"members-header",children:[s.jsx("h1",{children:"Data Anggota"}),s.jsxs("div",{className:"header-actions",children:[s.jsx("button",{className:"btn-import",onClick:se,children:"Import CSV"}),s.jsx("button",{className:"btn-add",onClick:B,children:"+ Tambah Anggota"})]})]}),s.jsxs("div",{className:"data-info",children:[s.jsxs("span",{children:["Total: ",s.jsx("strong",{children:e.length})," anggota"]}),s.jsxs("span",{children:["Halaman ",w," dari ",F||1]})]}),s.jsx("div",{className:"members-table",children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"No"}),s.jsxs("th",{onClick:()=>ue("full_name"),style:{cursor:"pointer"},children:["Nama Lengkap",Q("full_name")]}),s.jsxs("th",{onClick:()=>ue("email"),style:{cursor:"pointer"},children:["Email",Q("email")]}),s.jsxs("th",{onClick:()=>ue("phone"),style:{cursor:"pointer"},children:["No. Telepon",Q("phone")]}),s.jsx("th",{children:"Alamat"}),s.jsx("th",{children:"Aksi"})]})}),s.jsx("tbody",{children:e.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"6",style:{textAlign:"center"},children:"Belum ada data anggota"})}):M.map((K,G)=>s.jsxs("tr",{children:[s.jsx("td",{children:(w-1)*A+G+1}),s.jsx("td",{children:K.full_name}),s.jsx("td",{children:K.email}),s.jsx("td",{children:K.phone}),s.jsx("td",{children:K.address}),s.jsx("td",{children:s.jsxs("div",{className:"actions",children:[s.jsx("button",{className:"btn-edit",onClick:()=>H(K),children:"Edit"}),s.jsx("button",{className:"btn-delete",onClick:()=>J(K.id),children:"Hapus"})]})})]},K.id))})]})}),F>1&&s.jsxs("div",{className:"pagination",children:[s.jsx("button",{onClick:()=>m(1),disabled:w===1,children:""}),s.jsx("button",{onClick:()=>m(w-1),disabled:w===1,children:""}),[...Array(F)].map((K,G)=>{const P=G+1;return P===1||P===F||P>=w-1&&P<=w+1?s.jsx("button",{onClick:()=>m(P),className:w===P?"active":"",children:P},P):P===w-2||P===w+2?s.jsx("span",{children:"..."},P):null}),s.jsx("button",{onClick:()=>m(w+1),disabled:w===F,children:""}),s.jsx("button",{onClick:()=>m(F),disabled:w===F,children:""})]}),a&&s.jsx("div",{className:"modal-overlay",onClick:()=>i(!1),children:s.jsxs("div",{className:"modal-content",onClick:K=>K.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:c?"Edit Anggota":"Tambah Anggota"}),s.jsx("button",{className:"btn-close",onClick:()=>i(!1),children:""})]}),s.jsxs("form",{onSubmit:V,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Koperasi"}),s.jsxs("select",{name:"cooperative_id",value:k.cooperative_id,onChange:Y,required:!0,children:[s.jsx("option",{value:"",children:"Pilih Koperasi"}),d.map(K=>s.jsx("option",{value:K.id,children:K.name},K.id))]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Nama Lengkap"}),s.jsx("input",{type:"text",name:"full_name",value:k.full_name,onChange:Y,required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Email"}),s.jsx("input",{type:"email",name:"email",value:k.email,onChange:Y,required:!0,disabled:c!==null,title:c?"Email tidak dapat diubah karena digunakan untuk login":""})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"No. Telepon"}),s.jsx("input",{type:"text",name:"phone",value:k.phone,onChange:Y,required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Alamat"}),s.jsx("textarea",{name:"address",value:k.address,onChange:Y,rows:"3",required:!0})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>i(!1),children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Simpan"})]})]})]})}),o&&s.jsx("div",{className:"modal-overlay",onClick:()=>l(!1),children:s.jsxs("div",{className:"modal-content import-modal",onClick:K=>K.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Import Anggota dari CSV"}),s.jsx("button",{className:"btn-close",onClick:()=>l(!1),children:""})]}),s.jsxs("div",{className:"import-instructions",children:[s.jsx("h3",{children:"Petunjuk Import:"}),s.jsxs("ol",{children:[s.jsx("li",{children:"Download template CSV terlebih dahulu"}),s.jsx("li",{children:"Isi data anggota sesuai format pada template"}),s.jsx("li",{children:"Pastikan cooperative_id sesuai dengan ID koperasi yang valid"}),s.jsx("li",{children:"Upload file CSV yang sudah diisi"})]}),s.jsxs("div",{className:"cooperative-list",children:[s.jsx("h4",{children:"Daftar ID Koperasi:"}),s.jsxs("table",{className:"coop-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID Koperasi"}),s.jsx("th",{children:"Nama Koperasi"})]})}),s.jsx("tbody",{children:d.map(K=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("code",{children:K.id})}),s.jsx("td",{children:K.name})]},K.id))})]})]}),s.jsx("button",{className:"btn-download-template",onClick:te,children:"Download Template CSV"})]}),s.jsxs("div",{className:"import-section",children:[s.jsx("h3",{children:"Upload File CSV:"}),s.jsx("input",{type:"file",accept:".csv",onChange:me,disabled:h,className:"file-input"}),h&&s.jsx("p",{className:"import-status",children:"Sedang memproses..."})]}),y&&s.jsxs("div",{className:"import-results",children:[s.jsx("h3",{children:"Hasil Import:"}),s.jsxs("div",{className:"result-summary",children:[s.jsxs("div",{className:"result-item success",children:[s.jsx("strong",{children:"Berhasil:"})," ",y.success," anggota"]}),y.failed>0&&s.jsxs("div",{className:"result-item error",children:[s.jsx("strong",{children:"Gagal:"})," ",y.failed," baris",s.jsx("div",{className:"invalid-rows",children:y.invalidRows.map((K,G)=>s.jsxs("div",{children:["Baris ",K.row,": ",K.reason]},G))})]})]})]}),s.jsx("div",{className:"modal-actions",children:s.jsx("button",{className:"btn-cancel",onClick:()=>l(!1),children:"Tutup"})})]})})]})}function y_(){var hr,Fr;const[e,t]=v.useState([]),[r,n]=v.useState([]),[a,i]=v.useState(!0),[o,l]=v.useState(!1),[c,u]=v.useState(null),[d,p]=v.useState([]),[h,_]=v.useState(null),[y,j]=v.useState(!1),[w,m]=v.useState(1),[f,g]=v.useState("created_at"),[b,L]=v.useState("desc"),A=10,[k,N]=v.useState(!1),[R,S]=v.useState(null),[B,H]=v.useState(!1),[J,V]=v.useState([]),[Y,ue]=v.useState({amount:"",withdrawal_date:new Date().toISOString().split("T")[0],notes:""}),[O,$]=v.useState({member_id:"",saving_type:"",amount:""}),[F,M]=v.useState({startDate:"",endDate:"",member_id:"",saving_type:""});v.useEffect(()=>{Q(),te()},[]),v.useEffect(()=>{oe()},[e,F]);const Q=async()=>{try{const z=await qt();if(_(z.role),Sc(z)){if(!z.memberId){t([]),i(!1);return}const{data:re,error:ce}=await U.from("savings").select(`
            id,
            member_id,
            saving_type,
            amount,
            total_amount,
            transaction_date,
            notes,
            created_at,
            members!inner (full_name, cooperative_id, cooperatives (name))
          `).eq("member_id",z.memberId).order("created_at",{ascending:!1});if(ce)throw ce;t(re||[]),i(!1);return}if(!qe(z)&&z.cooperativeIds.length===0){t([]),i(!1);return}let x=U.from("savings").select(`
          id,
          member_id,
          saving_type,
          amount,
          total_amount,
          transaction_date,
          notes,
          created_at,
          members!inner (full_name, cooperative_id, cooperatives (name))
        `);qe(z)||(x=x.in("members.cooperative_id",z.cooperativeIds));const{data:T,error:ee}=await x.order("created_at",{ascending:!1});if(ee)throw ee;t(T||[])}catch(z){console.error("Error loading savings:",z)}finally{i(!1)}},te=async()=>{try{const z=await qt();let x=U.from("members").select("id, full_name, cooperative_id");qe(z)||(x=x.in("cooperative_id",z.cooperativeIds));const{data:T,error:ee}=await x.order("full_name");if(ee)throw ee;p(T||[])}catch(z){console.error("Error loading members:",z)}},oe=()=>{let z=[...e];if(F.startDate&&(z=z.filter(x=>new Date(x.created_at)>=new Date(F.startDate))),F.endDate){const x=new Date(F.endDate);x.setHours(23,59,59,999),z=z.filter(T=>new Date(T.created_at)<=x)}F.member_id&&(z=z.filter(x=>x.member_id===F.member_id)),F.saving_type&&(z=z.filter(x=>x.saving_type===F.saving_type)),n(z),m(1)},me=()=>{M({startDate:"",endDate:"",member_id:"",saving_type:""})},se=z=>{M({...F,[z.target.name]:z.target.value})},K=()=>{const z=r.reduce((re,ce)=>re+(ce.amount||0),0),x=r.length,T=x>0?z/x:0,ee={};return r.forEach(re=>{ee[re.saving_type]||(ee[re.saving_type]={count:0,total:0}),ee[re.saving_type].count++,ee[re.saving_type].total+=re.amount}),{total:z,count:x,average:T,byType:ee}},G=()=>{if(r.length===0){alert("Tidak ada data untuk di-export");return}const z=["No","Nama Anggota","Jenis Simpanan","Jumlah","Tanggal"],x=r.map((ce,ve)=>{var Ze;return[ve+1,((Ze=ce.members)==null?void 0:Ze.full_name)||"-",ce.saving_type,ce.amount,new Date(ce.created_at).toLocaleDateString("id-ID")]}),T=[z.join(","),...x.map(ce=>ce.join(","))].join(`
`),ee=new Blob([T],{type:"text/csv;charset=utf-8;"}),re=document.createElement("a");re.href=URL.createObjectURL(ee),re.download=`laporan-simpanan-${new Date().toISOString().split("T")[0]}.csv`,re.click()},P=()=>{if(r.length===0){alert("Tidak ada data untuk dicetak");return}const z=K(),x=window.open("","","height=600,width=800");x.document.write("<html><head><title>Laporan Simpanan</title>"),x.document.write("<style>"),x.document.write("body { font-family: Arial, sans-serif; padding: 20px; }"),x.document.write("h1 { text-align: center; }"),x.document.write("table { width: 100%; border-collapse: collapse; margin-top: 20px; }"),x.document.write("th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }"),x.document.write("th { background-color: #f2f2f2; }"),x.document.write(".summary { margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 5px; }"),x.document.write(".summary-item { margin: 5px 0; }"),x.document.write("</style></head><body>"),x.document.write("<h1>LAPORAN DATA SIMPANAN</h1>"),x.document.write(`<p style="text-align: center;">Tanggal Cetak: ${new Date().toLocaleDateString("id-ID")}</p>`),x.document.write('<div class="summary">'),x.document.write("<h3>Ringkasan</h3>"),x.document.write(`<div class="summary-item">Total Transaksi: ${z.count}</div>`),x.document.write(`<div class="summary-item">Total Simpanan: Rp ${z.total.toLocaleString("id-ID")}</div>`),x.document.write(`<div class="summary-item">Rata-rata: Rp ${z.average.toLocaleString("id-ID")}</div>`),x.document.write("</div>"),x.document.write("<table>"),x.document.write("<thead><tr><th>No</th><th>Nama Anggota</th><th>Jenis Simpanan</th><th>Jumlah</th><th>Tanggal</th></tr></thead>"),x.document.write("<tbody>"),r.forEach((T,ee)=>{var re;x.document.write("<tr>"),x.document.write(`<td>${ee+1}</td>`),x.document.write(`<td>${((re=T.members)==null?void 0:re.full_name)||"-"}</td>`),x.document.write(`<td style="text-transform: capitalize">${T.saving_type}</td>`),x.document.write(`<td>Rp ${T.amount.toLocaleString("id-ID")}</td>`),x.document.write(`<td>${new Date(T.created_at).toLocaleDateString("id-ID")}</td>`),x.document.write("</tr>")}),x.document.write("</tbody></table>"),x.document.write("</body></html>"),x.document.close(),x.print()},D=()=>{u(null),$({member_id:"",saving_type:"",amount:""}),l(!0)},q=z=>{u(z),$({member_id:z.member_id,saving_type:z.saving_type,amount:z.amount}),l(!0)},Z=async z=>{if(confirm("Apakah Anda yakin ingin menghapus data simpanan ini?"))try{const{error:x}=await U.from("savings").delete().eq("id",z);if(x)throw x;alert("Data simpanan berhasil dihapus"),Q()}catch(x){console.error("Error deleting saving:",x),alert("Gagal menghapus data: "+x.message)}},C=async z=>{z.preventDefault();try{if(c){const{error:x}=await U.from("savings").update({member_id:O.member_id,saving_type:O.saving_type,amount:parseFloat(O.amount)}).eq("id",c.id);if(x)throw x;alert("Data simpanan berhasil diupdate")}else{const{error:x}=await U.from("savings").insert([{member_id:O.member_id,saving_type:O.saving_type,amount:parseFloat(O.amount)}]);if(x)throw x;alert("Simpanan berhasil ditambahkan")}l(!1),u(null),Q()}catch(x){console.error("Error saving data:",x),alert("Gagal menyimpan data: "+x.message)}},I=z=>{$({...O,[z.target.name]:z.target.value})},ie=z=>{S(z),ue({amount:"",withdrawal_date:new Date().toISOString().split("T")[0],notes:""}),N(!0)},ae=async z=>{z.preventDefault();const x=parseFloat(Y.amount);if(x<=0){alert("Jumlah penarikan harus lebih dari 0");return}const T=R.total_amount||0;if(x>T){alert(`Jumlah penarikan melebihi saldo simpanan (Rp ${T.toLocaleString("id-ID")})`);return}try{const{data:{user:ee}}=await U.auth.getUser(),re={saving_id:R.id,amount:x,withdrawal_date:Y.withdrawal_date,notes:Y.notes||null,created_by:ee.id},{error:ce}=await U.from("savings_withdrawals").insert([re]);if(ce)throw ce;alert("Penarikan berhasil dicatat"),N(!1),S(null),Q()}catch(ee){console.error("Error recording withdrawal:",ee),alert("Gagal mencatat penarikan: "+ee.message)}},fe=z=>{ue({...Y,[z.target.name]:z.target.value})},je=async z=>{try{const{data:x,error:T}=await U.from("savings_withdrawals").select("*").eq("saving_id",z.id).order("withdrawal_date",{ascending:!1});if(T)throw T;V(x||[]),S(z),H(!0)}catch(x){console.error("Error loading withdrawal history:",x),alert("Gagal memuat riwayat penarikan: "+x.message)}},pt=async z=>{if(confirm("Apakah Anda yakin ingin menghapus data penarikan ini?"))try{const{error:x}=await U.from("savings_withdrawals").delete().eq("id",z);if(x)throw x;alert("Penarikan berhasil dihapus"),je(R),Q()}catch(x){console.error("Error deleting withdrawal:",x),alert("Gagal menghapus penarikan: "+x.message)}},be=z=>{f===z?L(b==="asc"?"desc":"asc"):(g(z),L("asc"))},Le=()=>[...r].sort((x,T)=>{var ce,ve;let ee=x[f],re=T[f];return f==="member_name"&&(ee=((ce=x.members)==null?void 0:ce.full_name)||"",re=((ve=T.members)==null?void 0:ve.full_name)||""),typeof ee=="string"&&(ee=ee.toLowerCase(),re=(re==null?void 0:re.toLowerCase())||""),ee<re?b==="asc"?-1:1:ee>re?b==="asc"?1:-1:0}),Xt=()=>{const z=Le(),x=(w-1)*A,T=x+A;return z.slice(x,T)},Ot=Math.ceil(r.length/A),lt=Xt(),gt=z=>f!==z?" ":b==="asc"?" ":" ";if(a)return s.jsx("div",{className:"loading",children:"Loading savings..."});const ct=K();return s.jsxs("div",{className:"savings-container",children:[s.jsxs("div",{className:"savings-header",children:[s.jsx("h1",{children:"Data Simpanan"}),s.jsxs("div",{className:"header-actions",children:[s.jsx("button",{className:"btn-filter",onClick:()=>j(!y),children:y?"Sembunyikan Filter":"Tampilkan Filter"}),h!=="member"&&s.jsx("button",{className:"btn-add",onClick:D,children:"+ Tambah Simpanan"})]})]}),s.jsxs("div",{className:"data-info",children:[s.jsxs("span",{children:["Total: ",s.jsx("strong",{children:r.length})," transaksi (dari ",e.length," total)"]}),s.jsxs("span",{children:["Halaman ",w," dari ",Ot||1]})]}),y&&s.jsxs("div",{className:"filter-section",children:[s.jsx("h3",{children:"Filter Data"}),s.jsxs("div",{className:"filter-form",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tanggal Mulai"}),s.jsx("input",{type:"date",name:"startDate",value:F.startDate,onChange:se})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tanggal Akhir"}),s.jsx("input",{type:"date",name:"endDate",value:F.endDate,onChange:se})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Anggota"}),s.jsxs("select",{name:"member_id",value:F.member_id,onChange:se,children:[s.jsx("option",{value:"",children:"Semua Anggota"}),d.map(z=>s.jsx("option",{value:z.id,children:z.full_name},z.id))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Jenis Simpanan"}),s.jsxs("select",{name:"saving_type",value:F.saving_type,onChange:se,children:[s.jsx("option",{value:"",children:"Semua Jenis"}),s.jsx("option",{value:"pokok",children:"Pokok"}),s.jsx("option",{value:"wajib",children:"Wajib"}),s.jsx("option",{value:"sukarela",children:"Sukarela"})]})]}),s.jsx("div",{className:"filter-group",children:s.jsx("button",{className:"btn-reset",onClick:me,children:"Reset Filter"})})]})]}),s.jsxs("div",{className:"statistics-section",children:[s.jsx("h3",{children:"Ringkasan"}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-label",children:"Total Transaksi"}),s.jsx("div",{className:"stat-value",children:ct.count})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-label",children:"Total Simpanan"}),s.jsxs("div",{className:"stat-value",children:["Rp ",ct.total.toLocaleString("id-ID")]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-label",children:"Rata-rata"}),s.jsxs("div",{className:"stat-value",children:["Rp ",ct.average.toLocaleString("id-ID")]})]})]})]}),s.jsxs("div",{className:"report-actions",children:[s.jsx("button",{className:"btn-export",onClick:G,children:"Export CSV"}),s.jsx("button",{className:"btn-print",onClick:P,children:"Cetak Laporan"})]}),s.jsx("div",{className:"savings-table",children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"No"}),s.jsxs("th",{onClick:()=>be("member_name"),style:{cursor:"pointer"},children:["Nama Anggota",gt("member_name")]}),s.jsxs("th",{onClick:()=>be("saving_type"),style:{cursor:"pointer"},children:["Jenis Simpanan",gt("saving_type")]}),s.jsxs("th",{onClick:()=>be("amount"),style:{cursor:"pointer"},children:["Setoran",gt("amount")]}),s.jsxs("th",{onClick:()=>be("total_amount"),style:{cursor:"pointer"},children:["Saldo",gt("total_amount")]}),s.jsxs("th",{onClick:()=>be("created_at"),style:{cursor:"pointer"},children:["Tanggal",gt("created_at")]}),s.jsx("th",{children:"Aksi"})]})}),s.jsx("tbody",{children:r.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"7",style:{textAlign:"center"},children:"Belum ada data simpanan"})}):lt.map((z,x)=>{var re,ce;const T=z.total_amount||0,ee=T>0;return s.jsxs("tr",{children:[s.jsx("td",{children:(w-1)*A+x+1}),s.jsx("td",{children:((re=z.members)==null?void 0:re.full_name)||"-"}),s.jsx("td",{style:{textTransform:"capitalize"},children:z.saving_type}),s.jsxs("td",{children:["Rp ",(ce=z.amount)==null?void 0:ce.toLocaleString("id-ID")]}),s.jsx("td",{children:s.jsxs("span",{style:{color:ee?"green":"gray",fontWeight:ee?"bold":"normal"},children:["Rp ",T.toLocaleString("id-ID")]})}),s.jsx("td",{children:new Date(z.created_at).toLocaleDateString("id-ID")}),s.jsx("td",{children:s.jsxs("div",{className:"actions",children:[h!=="member"&&ee&&s.jsx("button",{className:"btn-payment",onClick:()=>ie(z),children:"Tarik"}),s.jsx("button",{className:"btn-history",onClick:()=>je(z),children:"Riwayat"}),h!=="member"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"btn-edit",onClick:()=>q(z),children:"Edit"}),s.jsx("button",{className:"btn-delete",onClick:()=>Z(z.id),children:"Hapus"})]})]})})]},z.id)})})]})}),Ot>1&&s.jsxs("div",{className:"pagination",children:[s.jsx("button",{onClick:()=>m(1),disabled:w===1,children:""}),s.jsx("button",{onClick:()=>m(w-1),disabled:w===1,children:""}),[...Array(Ot)].map((z,x)=>{const T=x+1;return T===1||T===Ot||T>=w-1&&T<=w+1?s.jsx("button",{onClick:()=>m(T),className:w===T?"active":"",children:T},T):T===w-2||T===w+2?s.jsx("span",{children:"..."},T):null}),s.jsx("button",{onClick:()=>m(w+1),disabled:w===Ot,children:""}),s.jsx("button",{onClick:()=>m(Ot),disabled:w===Ot,children:""})]}),o&&s.jsx("div",{className:"modal-overlay",onClick:()=>l(!1),children:s.jsxs("div",{className:"modal-content",onClick:z=>z.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:c?"Edit Simpanan":"Tambah Simpanan"}),s.jsx("button",{className:"btn-close",onClick:()=>l(!1),children:""})]}),s.jsxs("form",{onSubmit:C,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Anggota"}),s.jsxs("select",{name:"member_id",value:O.member_id,onChange:I,required:!0,children:[s.jsx("option",{value:"",children:"Pilih Anggota"}),d.map(z=>s.jsx("option",{value:z.id,children:z.full_name},z.id))]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Jenis Simpanan"}),s.jsxs("select",{name:"saving_type",value:O.saving_type,onChange:I,required:!0,children:[s.jsx("option",{value:"",children:"Pilih Jenis Simpanan"}),s.jsx("option",{value:"pokok",children:"Pokok"}),s.jsx("option",{value:"wajib",children:"Wajib"}),s.jsx("option",{value:"sukarela",children:"Sukarela"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Jumlah"}),s.jsx("input",{type:"number",name:"amount",value:O.amount,onChange:I,required:!0,min:"0",step:"0.01"})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>l(!1),children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Simpan"})]})]})]})}),k&&R&&s.jsx("div",{className:"modal-overlay",onClick:()=>N(!1),children:s.jsxs("div",{className:"modal-content",onClick:z=>z.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Penarikan Simpanan"}),s.jsx("button",{className:"btn-close",onClick:()=>N(!1),children:""})]}),s.jsxs("div",{className:"loan-info",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Anggota:"})," ",(hr=R.members)==null?void 0:hr.full_name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Jenis Simpanan:"})," ",s.jsx("span",{style:{textTransform:"capitalize"},children:R.saving_type})]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Saldo Saat Ini:"})," Rp ",(R.total_amount||0).toLocaleString("id-ID")]})]}),s.jsxs("form",{onSubmit:ae,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Jumlah Penarikan"}),s.jsx("input",{type:"number",name:"amount",value:Y.amount,onChange:fe,required:!0,min:"0.01",step:"0.01",placeholder:"Masukkan jumlah penarikan"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Tanggal Penarikan"}),s.jsx("input",{type:"date",name:"withdrawal_date",value:Y.withdrawal_date,onChange:fe,required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Catatan (Opsional)"}),s.jsx("textarea",{name:"notes",value:Y.notes,onChange:fe,rows:"3",placeholder:"Catatan penarikan..."})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>N(!1),children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Simpan Penarikan"})]})]})]})}),B&&R&&s.jsx("div",{className:"modal-overlay",onClick:()=>H(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:z=>z.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Riwayat Penarikan"}),s.jsx("button",{className:"btn-close",onClick:()=>H(!1),children:""})]}),s.jsxs("div",{className:"loan-info",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Anggota:"})," ",(Fr=R.members)==null?void 0:Fr.full_name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Jenis Simpanan:"})," ",s.jsx("span",{style:{textTransform:"capitalize"},children:R.saving_type})]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Setoran Awal:"})," Rp ",R.amount.toLocaleString("id-ID")]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Saldo Saat Ini:"})," Rp ",(R.total_amount||0).toLocaleString("id-ID")]})]}),s.jsx("div",{className:"payment-history-table",children:J.length===0?s.jsx("p",{style:{textAlign:"center",padding:"20px"},children:"Belum ada penarikan"}):s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"No"}),s.jsx("th",{children:"Tanggal"}),s.jsx("th",{children:"Jumlah"}),s.jsx("th",{children:"Catatan"}),h!=="member"&&s.jsx("th",{children:"Aksi"})]})}),s.jsx("tbody",{children:J.map((z,x)=>s.jsxs("tr",{children:[s.jsx("td",{children:x+1}),s.jsx("td",{children:new Date(z.withdrawal_date).toLocaleDateString("id-ID")}),s.jsxs("td",{children:["Rp ",z.amount.toLocaleString("id-ID")]}),s.jsx("td",{children:z.notes||"-"}),h!=="member"&&s.jsx("td",{children:s.jsx("button",{className:"btn-delete",onClick:()=>pt(z.id),style:{fontSize:"12px",padding:"4px 8px"},children:"Hapus"})})]},z.id))}),s.jsx("tfoot",{children:s.jsxs("tr",{style:{fontWeight:"bold",backgroundColor:"#f5f5f5"},children:[s.jsx("td",{colSpan:"2",children:"Total Penarikan"}),s.jsxs("td",{children:["Rp ",J.reduce((z,x)=>z+x.amount,0).toLocaleString("id-ID")]}),s.jsx("td",{colSpan:h!=="member"?"2":"1"})]})})]})}),s.jsx("div",{className:"modal-actions",children:s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>H(!1),children:"Tutup"})})]})})]})}function w_(){var Fr,z;const[e,t]=v.useState([]),[r,n]=v.useState([]),[a,i]=v.useState(!0),[o,l]=v.useState(!1),[c,u]=v.useState(null),[d,p]=v.useState([]),[h,_]=v.useState(null),[y,j]=v.useState(!1),[w,m]=v.useState(1),[f,g]=v.useState("created_at"),[b,L]=v.useState("desc"),A=10,[k,N]=v.useState(!1),[R,S]=v.useState(null),[B,H]=v.useState(!1),[J,V]=v.useState([]),[Y,ue]=v.useState({payment_amount:"",payment_date:new Date().toISOString().split("T")[0],notes:""}),[O,$]=v.useState({member_id:"",amount:"",duration_months:"",interest_rate:"10",status:"pending"}),[F,M]=v.useState({startDate:"",endDate:"",member_id:"",status:""});v.useEffect(()=>{Q(),te()},[]),v.useEffect(()=>{oe()},[e,F]);const Q=async()=>{try{const x=await qt();if(_(x.role),Sc(x)){if(!x.memberId){t([]),i(!1);return}const{data:ce,error:ve}=await U.from("loans").select(`
            *,
            members!inner (full_name, cooperative_id, cooperatives (name))
          `).eq("member_id",x.memberId).order("created_at",{ascending:!1});if(ve)throw ve;t(ce||[]),i(!1);return}if(!qe(x)&&x.cooperativeIds.length===0){t([]),i(!1);return}let T=U.from("loans").select(`
          *,
          members!inner (full_name, cooperative_id, cooperatives (name))
        `);qe(x)||(T=T.in("members.cooperative_id",x.cooperativeIds));const{data:ee,error:re}=await T.order("created_at",{ascending:!1});if(re)throw re;t(ee||[])}catch(x){console.error("Error loading loans:",x)}finally{i(!1)}},te=async()=>{try{const x=await qt();let T=U.from("members").select("id, full_name, cooperative_id");qe(x)||(T=T.in("cooperative_id",x.cooperativeIds));const{data:ee,error:re}=await T.order("full_name");if(re)throw re;p(ee||[])}catch(x){console.error("Error loading members:",x)}},oe=()=>{let x=[...e];if(F.startDate&&(x=x.filter(T=>new Date(T.created_at)>=new Date(F.startDate))),F.endDate){const T=new Date(F.endDate);T.setHours(23,59,59,999),x=x.filter(ee=>new Date(ee.created_at)<=T)}F.member_id&&(x=x.filter(T=>T.member_id===F.member_id)),F.status&&(x=x.filter(T=>T.status===F.status)),n(x),m(1)},me=()=>{M({startDate:"",endDate:"",member_id:"",status:""})},se=x=>{M({...F,[x.target.name]:x.target.value})},K=()=>{const x=r.reduce((ce,ve)=>ce+(ve.amount||0),0),T=r.length,ee=T>0?x/T:0,re={};return r.forEach(ce=>{re[ce.status]||(re[ce.status]={count:0,total:0}),re[ce.status].count++,re[ce.status].total+=ce.amount}),{total:x,count:T,average:ee,byStatus:re}},G=()=>{if(r.length===0){alert("Tidak ada data untuk di-export");return}const x=["No","Nama Anggota","Jumlah Pinjaman","Tenor","Bunga","Status","Tanggal"],T=r.map((ve,Ze)=>{var Zt;return[Ze+1,((Zt=ve.members)==null?void 0:Zt.full_name)||"-",ve.amount,ve.duration_months,ve.interest_rate,ve.status,new Date(ve.created_at).toLocaleDateString("id-ID")]}),ee=[x.join(","),...T.map(ve=>ve.join(","))].join(`
`),re=new Blob([ee],{type:"text/csv;charset=utf-8;"}),ce=document.createElement("a");ce.href=URL.createObjectURL(re),ce.download=`laporan-pinjaman-${new Date().toISOString().split("T")[0]}.csv`,ce.click()},P=()=>{if(r.length===0){alert("Tidak ada data untuk dicetak");return}const x=K(),T=window.open("","","height=600,width=800");T.document.write("<html><head><title>Laporan Pinjaman</title>"),T.document.write("<style>"),T.document.write("body { font-family: Arial, sans-serif; padding: 20px; }"),T.document.write("h1 { text-align: center; }"),T.document.write("table { width: 100%; border-collapse: collapse; margin-top: 20px; }"),T.document.write("th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }"),T.document.write("th { background-color: #f2f2f2; }"),T.document.write(".summary { margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 5px; }"),T.document.write(".summary-item { margin: 5px 0; }"),T.document.write(".status-badge { padding: 4px 8px; border-radius: 4px; font-size: 12px; }"),T.document.write("</style></head><body>"),T.document.write("<h1>LAPORAN DATA PINJAMAN</h1>"),T.document.write(`<p style="text-align: center;">Tanggal Cetak: ${new Date().toLocaleDateString("id-ID")}</p>`),T.document.write('<div class="summary">'),T.document.write("<h3>Ringkasan</h3>"),T.document.write(`<div class="summary-item">Total Pinjaman: ${x.count}</div>`),T.document.write(`<div class="summary-item">Total Nilai: Rp ${x.total.toLocaleString("id-ID")}</div>`),T.document.write(`<div class="summary-item">Rata-rata: Rp ${x.average.toLocaleString("id-ID")}</div>`),T.document.write("</div>"),T.document.write("<table>"),T.document.write("<thead><tr><th>No</th><th>Nama Anggota</th><th>Jumlah</th><th>Tenor</th><th>Bunga</th><th>Status</th><th>Tanggal</th></tr></thead>"),T.document.write("<tbody>"),r.forEach((ee,re)=>{var ce;T.document.write("<tr>"),T.document.write(`<td>${re+1}</td>`),T.document.write(`<td>${((ce=ee.members)==null?void 0:ce.full_name)||"-"}</td>`),T.document.write(`<td>Rp ${ee.amount.toLocaleString("id-ID")}</td>`),T.document.write(`<td>${ee.duration_months} bulan</td>`),T.document.write(`<td>${ee.interest_rate}%</td>`),T.document.write(`<td><span class="status-badge">${ee.status}</span></td>`),T.document.write(`<td>${new Date(ee.created_at).toLocaleDateString("id-ID")}</td>`),T.document.write("</tr>")}),T.document.write("</tbody></table>"),T.document.write("</body></html>"),T.document.close(),T.print()},D=()=>{u(null),$({member_id:"",amount:"",duration_months:"",interest_rate:"10",status:"pending"}),l(!0)},q=x=>{u(x),$({member_id:x.member_id,amount:x.amount,duration_months:x.duration_months,interest_rate:x.interest_rate||"10",status:x.status}),l(!0)},Z=async x=>{if(confirm("Apakah Anda yakin ingin menghapus data pinjaman ini?"))try{const{error:T}=await U.from("loans").delete().eq("id",x);if(T)throw T;alert("Data pinjaman berhasil dihapus"),Q()}catch(T){console.error("Error deleting loan:",T),alert("Gagal menghapus data: "+T.message)}},C=async x=>{x.preventDefault();try{if(c){const{error:T}=await U.from("loans").update({member_id:O.member_id,amount:parseFloat(O.amount),duration_months:parseInt(O.duration_months),interest_rate:parseFloat(O.interest_rate),status:O.status}).eq("id",c.id);if(T)throw T;alert("Data pinjaman berhasil diupdate")}else{const{error:T}=await U.from("loans").insert([{member_id:O.member_id,amount:parseFloat(O.amount),duration_months:parseInt(O.duration_months),interest_rate:parseFloat(O.interest_rate),status:O.status}]);if(T)throw T;alert("Pinjaman berhasil ditambahkan")}l(!1),u(null),Q()}catch(T){console.error("Error saving data:",T),alert("Gagal menyimpan data: "+T.message)}},I=x=>{$({...O,[x.target.name]:x.target.value})},ie=x=>{S(x),ue({payment_amount:"",payment_date:new Date().toISOString().split("T")[0],notes:""}),N(!0)},ae=(x,T)=>{const ee=T.amount,re=T.interest_rate/100,ce=T.duration_months,ve=ee*re*(ce/12),Ze=ee+ve,Zt=x/Ze,Yn=ve*Zt,Ni=x-Yn;return{principal:Math.max(0,Ni),interest:Math.max(0,Yn)}},fe=async x=>{if(x.preventDefault(),R.status!=="active"){alert("Pembayaran hanya dapat dilakukan untuk pinjaman dengan status Active");return}const T=parseFloat(Y.payment_amount);if(T<=0){alert("Jumlah pembayaran harus lebih dari 0");return}const ee=R.remaining_amount!==null&&R.remaining_amount!==void 0?R.remaining_amount:R.amount;if(T>ee){alert(`Jumlah pembayaran melebihi sisa pinjaman (Rp ${ee.toLocaleString("id-ID")})`);return}try{const re=ae(T,R),{data:ce}=await U.from("loan_payments").select("payment_number").eq("loan_id",R.id).order("payment_number",{ascending:!1}).limit(1),ve=ce&&ce.length>0?ce[0].payment_number+1:1,Ze={loan_id:R.id,amount:T,principal_amount:re.principal,interest_amount:re.interest,payment_number:ve,payment_date:Y.payment_date,notes:Y.notes||null},{error:Zt}=await U.from("loan_payments").insert([Ze]);if(Zt)throw Zt;alert("Pembayaran berhasil dicatat"),N(!1),S(null),Q()}catch(re){console.error("Error recording payment:",re),alert("Gagal mencatat pembayaran: "+re.message)}},je=x=>{ue({...Y,[x.target.name]:x.target.value})},pt=async x=>{try{const{data:T,error:ee}=await U.from("loan_payments").select("*").eq("loan_id",x.id).order("payment_date",{ascending:!1});if(ee)throw ee;V(T||[]),S(x),H(!0)}catch(T){console.error("Error loading payment history:",T),alert("Gagal memuat riwayat pembayaran: "+T.message)}},be=async x=>{if(confirm("Apakah Anda yakin ingin menghapus data pembayaran ini?"))try{const{error:T}=await U.from("loan_payments").delete().eq("id",x);if(T)throw T;alert("Pembayaran berhasil dihapus"),pt(R),Q()}catch(T){console.error("Error deleting payment:",T),alert("Gagal menghapus pembayaran: "+T.message)}},Le=x=>{f===x?L(b==="asc"?"desc":"asc"):(g(x),L("asc"))},Xt=()=>[...r].sort((T,ee)=>{var ve,Ze;let re=T[f],ce=ee[f];return f==="member_name"&&(re=((ve=T.members)==null?void 0:ve.full_name)||"",ce=((Ze=ee.members)==null?void 0:Ze.full_name)||""),typeof re=="string"&&(re=re.toLowerCase(),ce=(ce==null?void 0:ce.toLowerCase())||""),re<ce?b==="asc"?-1:1:re>ce?b==="asc"?1:-1:0}),Ot=()=>{const x=Xt(),T=(w-1)*A,ee=T+A;return x.slice(T,ee)},lt=Math.ceil(r.length/A),gt=Ot(),ct=x=>f!==x?" ":b==="asc"?" ":" ";if(a)return s.jsx("div",{className:"loading",children:"Loading loans..."});const hr=K();return s.jsxs("div",{className:"loans-container",children:[s.jsxs("div",{className:"loans-header",children:[s.jsx("h1",{children:"Data Pinjaman"}),s.jsxs("div",{className:"header-actions",children:[s.jsx("button",{className:"btn-filter",onClick:()=>j(!y),children:y?"Sembunyikan Filter":"Tampilkan Filter"}),h!=="member"&&s.jsx("button",{className:"btn-add",onClick:D,children:"+ Tambah Pinjaman"})]})]}),s.jsxs("div",{className:"data-info",children:[s.jsxs("span",{children:["Total: ",s.jsx("strong",{children:r.length})," pinjaman (dari ",e.length," total)"]}),s.jsxs("span",{children:["Halaman ",w," dari ",lt||1]})]}),y&&s.jsxs("div",{className:"filter-section",children:[s.jsx("h3",{children:"Filter Data"}),s.jsxs("div",{className:"filter-form",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tanggal Mulai"}),s.jsx("input",{type:"date",name:"startDate",value:F.startDate,onChange:se})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tanggal Akhir"}),s.jsx("input",{type:"date",name:"endDate",value:F.endDate,onChange:se})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Anggota"}),s.jsxs("select",{name:"member_id",value:F.member_id,onChange:se,children:[s.jsx("option",{value:"",children:"Semua Anggota"}),d.map(x=>s.jsx("option",{value:x.id,children:x.full_name},x.id))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Status"}),s.jsxs("select",{name:"status",value:F.status,onChange:se,children:[s.jsx("option",{value:"",children:"Semua Status"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"approved",children:"Approved"}),s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"rejected",children:"Rejected"})]})]}),s.jsx("div",{className:"filter-group",children:s.jsx("button",{className:"btn-reset",onClick:me,children:"Reset Filter"})})]})]}),s.jsxs("div",{className:"statistics-section",children:[s.jsx("h3",{children:"Ringkasan"}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-label",children:"Total Pinjaman"}),s.jsx("div",{className:"stat-value",children:hr.count})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-label",children:"Total Nilai"}),s.jsxs("div",{className:"stat-value",children:["Rp ",hr.total.toLocaleString("id-ID")]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-label",children:"Rata-rata"}),s.jsxs("div",{className:"stat-value",children:["Rp ",hr.average.toLocaleString("id-ID")]})]})]})]}),s.jsxs("div",{className:"report-actions",children:[s.jsx("button",{className:"btn-export",onClick:G,children:"Export CSV"}),s.jsx("button",{className:"btn-print",onClick:P,children:"Cetak Laporan"})]}),s.jsx("div",{className:"loans-table",children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"No"}),s.jsxs("th",{onClick:()=>Le("member_name"),style:{cursor:"pointer"},children:["Nama Anggota",ct("member_name")]}),s.jsxs("th",{onClick:()=>Le("amount"),style:{cursor:"pointer"},children:["Jumlah Pinjaman",ct("amount")]}),s.jsx("th",{children:"Terbayar"}),s.jsx("th",{children:"Sisa Pinjaman"}),s.jsxs("th",{onClick:()=>Le("duration_months"),style:{cursor:"pointer"},children:["Tenor",ct("duration_months")]}),s.jsxs("th",{onClick:()=>Le("status"),style:{cursor:"pointer"},children:["Status",ct("status")]}),s.jsxs("th",{onClick:()=>Le("created_at"),style:{cursor:"pointer"},children:["Tanggal",ct("created_at")]}),s.jsx("th",{children:"Aksi"})]})}),s.jsx("tbody",{children:r.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"9",style:{textAlign:"center"},children:"Belum ada data pinjaman"})}):gt.map((x,T)=>{var ve,Ze;const ee=x.total_paid||0,re=x.remaining_amount!==null&&x.remaining_amount!==void 0?x.remaining_amount:x.amount,ce=re<=0;return s.jsxs("tr",{children:[s.jsx("td",{children:(w-1)*A+T+1}),s.jsx("td",{children:((ve=x.members)==null?void 0:ve.full_name)||"-"}),s.jsxs("td",{children:["Rp ",(Ze=x.amount)==null?void 0:Ze.toLocaleString("id-ID")]}),s.jsxs("td",{children:["Rp ",ee.toLocaleString("id-ID")]}),s.jsx("td",{children:s.jsxs("span",{style:{color:ce?"green":"inherit",fontWeight:ce?"bold":"normal"},children:["Rp ",re.toLocaleString("id-ID")]})}),s.jsxs("td",{children:[x.duration_months," bulan"]}),s.jsx("td",{children:s.jsx("span",{className:`status-badge status-${x.status}`,children:x.status})}),s.jsx("td",{children:new Date(x.created_at).toLocaleDateString("id-ID")}),s.jsx("td",{children:s.jsxs("div",{className:"actions",children:[h!=="member"&&!ce&&x.status==="active"&&s.jsx("button",{className:"btn-payment",onClick:()=>ie(x),children:"Bayar"}),s.jsx("button",{className:"btn-history",onClick:()=>pt(x),children:"Riwayat"}),h!=="member"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"btn-edit",onClick:()=>q(x),children:"Edit"}),s.jsx("button",{className:"btn-delete",onClick:()=>Z(x.id),children:"Hapus"})]})]})})]},x.id)})})]})}),lt>1&&s.jsxs("div",{className:"pagination",children:[s.jsx("button",{onClick:()=>m(1),disabled:w===1,children:""}),s.jsx("button",{onClick:()=>m(w-1),disabled:w===1,children:""}),[...Array(lt)].map((x,T)=>{const ee=T+1;return ee===1||ee===lt||ee>=w-1&&ee<=w+1?s.jsx("button",{onClick:()=>m(ee),className:w===ee?"active":"",children:ee},ee):ee===w-2||ee===w+2?s.jsx("span",{children:"..."},ee):null}),s.jsx("button",{onClick:()=>m(w+1),disabled:w===lt,children:""}),s.jsx("button",{onClick:()=>m(lt),disabled:w===lt,children:""})]}),o&&s.jsx("div",{className:"modal-overlay",onClick:()=>l(!1),children:s.jsxs("div",{className:"modal-content",onClick:x=>x.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:c?"Edit Pinjaman":"Tambah Pinjaman"}),s.jsx("button",{className:"btn-close",onClick:()=>l(!1),children:""})]}),s.jsxs("form",{onSubmit:C,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Anggota"}),s.jsxs("select",{name:"member_id",value:O.member_id,onChange:I,required:!0,children:[s.jsx("option",{value:"",children:"Pilih Anggota"}),d.map(x=>s.jsx("option",{value:x.id,children:x.full_name},x.id))]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Jumlah Pinjaman"}),s.jsx("input",{type:"number",name:"amount",value:O.amount,onChange:I,required:!0,min:"0",step:"0.01"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Tenor (bulan)"}),s.jsx("input",{type:"number",name:"duration_months",value:O.duration_months,onChange:I,required:!0,min:"1"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Bunga (%)"}),s.jsx("input",{type:"number",name:"interest_rate",value:O.interest_rate,onChange:I,required:!0,min:"0",step:"0.01"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Status"}),s.jsxs("select",{name:"status",value:O.status,onChange:I,required:!0,children:[s.jsx("option",{value:"",children:"Pilih Status"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"approved",children:"Approved"}),s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"rejected",children:"Rejected"})]})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>l(!1),children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Simpan"})]})]})]})}),k&&R&&s.jsx("div",{className:"modal-overlay",onClick:()=>N(!1),children:s.jsxs("div",{className:"modal-content",onClick:x=>x.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Pembayaran Pinjaman"}),s.jsx("button",{className:"btn-close",onClick:()=>N(!1),children:""})]}),s.jsxs("div",{className:"loan-info",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Anggota:"})," ",(Fr=R.members)==null?void 0:Fr.full_name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Jumlah Pinjaman:"})," Rp ",R.amount.toLocaleString("id-ID")]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Terbayar:"})," Rp ",(R.total_paid||0).toLocaleString("id-ID")]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Sisa:"})," Rp ",(R.remaining_amount!==null&&R.remaining_amount!==void 0?R.remaining_amount:R.amount).toLocaleString("id-ID")]})]}),s.jsxs("form",{onSubmit:fe,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Jumlah Pembayaran"}),s.jsx("input",{type:"number",name:"payment_amount",value:Y.payment_amount,onChange:je,required:!0,min:"0.01",step:"0.01",placeholder:"Masukkan jumlah pembayaran"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Tanggal Pembayaran"}),s.jsx("input",{type:"date",name:"payment_date",value:Y.payment_date,onChange:je,required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Catatan (Opsional)"}),s.jsx("textarea",{name:"notes",value:Y.notes,onChange:je,rows:"3",placeholder:"Catatan pembayaran..."})]}),Y.payment_amount&&s.jsxs("div",{className:"payment-breakdown",children:[s.jsx("h4",{children:"Alokasi Pembayaran:"}),(()=>{const x=ae(parseFloat(Y.payment_amount)||0,R);return s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["Pokok: Rp ",x.principal.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("p",{children:["Bunga: Rp ",x.interest.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})})()]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>N(!1),children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Simpan Pembayaran"})]})]})]})}),B&&R&&s.jsx("div",{className:"modal-overlay",onClick:()=>H(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:x=>x.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Riwayat Pembayaran"}),s.jsx("button",{className:"btn-close",onClick:()=>H(!1),children:""})]}),s.jsxs("div",{className:"loan-info",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Anggota:"})," ",(z=R.members)==null?void 0:z.full_name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Jumlah Pinjaman:"})," Rp ",R.amount.toLocaleString("id-ID")]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Total Terbayar:"})," Rp ",(R.total_paid||0).toLocaleString("id-ID")]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Sisa:"})," Rp ",(R.remaining_amount!==null&&R.remaining_amount!==void 0?R.remaining_amount:R.amount).toLocaleString("id-ID")]})]}),s.jsx("div",{className:"payment-history-table",children:J.length===0?s.jsx("p",{style:{textAlign:"center",padding:"20px"},children:"Belum ada pembayaran"}):s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"No"}),s.jsx("th",{children:"Tanggal"}),s.jsx("th",{children:"Jumlah"}),s.jsx("th",{children:"Pokok"}),s.jsx("th",{children:"Bunga"}),s.jsx("th",{children:"Catatan"}),h!=="member"&&s.jsx("th",{children:"Aksi"})]})}),s.jsx("tbody",{children:J.map((x,T)=>s.jsxs("tr",{children:[s.jsx("td",{children:T+1}),s.jsx("td",{children:new Date(x.payment_date).toLocaleDateString("id-ID")}),s.jsxs("td",{children:["Rp ",x.amount.toLocaleString("id-ID")]}),s.jsxs("td",{children:["Rp ",x.principal_amount.toLocaleString("id-ID")]}),s.jsxs("td",{children:["Rp ",x.interest_amount.toLocaleString("id-ID")]}),s.jsx("td",{children:x.notes||"-"}),h!=="member"&&s.jsx("td",{children:s.jsx("button",{className:"btn-delete",onClick:()=>be(x.id),style:{fontSize:"12px",padding:"4px 8px"},children:"Hapus"})})]},x.id))}),s.jsx("tfoot",{children:s.jsxs("tr",{style:{fontWeight:"bold",backgroundColor:"#f5f5f5"},children:[s.jsx("td",{colSpan:"2",children:"Total"}),s.jsxs("td",{children:["Rp ",J.reduce((x,T)=>x+T.amount,0).toLocaleString("id-ID")]}),s.jsxs("td",{children:["Rp ",J.reduce((x,T)=>x+T.principal_amount,0).toLocaleString("id-ID")]}),s.jsxs("td",{children:["Rp ",J.reduce((x,T)=>x+T.interest_amount,0).toLocaleString("id-ID")]}),s.jsx("td",{colSpan:h!=="member"?"2":"1"})]})})]})}),s.jsx("div",{className:"modal-actions",children:s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>H(!1),children:"Tutup"})})]})})]})}function __(){const[e,t]=v.useState([]),[r,n]=v.useState(!0),[a,i]=v.useState(!1),[o,l]=v.useState(null),[c,u]=v.useState(1),[d,p]=v.useState("created_at"),[h,_]=v.useState("desc"),y=10,[j,w]=v.useState({name:"",address:"",phone:"",email:""});v.useEffect(()=>{m()},[]);const m=async()=>{try{const J=await qt();if(!qe(J)&&J.cooperativeIds.length===0){t([]),n(!1);return}let V=U.from("cooperatives").select("*");qe(J)||(V=V.in("id",J.cooperativeIds));const{data:Y,error:ue}=await V;if(ue)throw ue;t(Y||[]),u(1)}catch(J){console.error("Error loading cooperatives:",J)}finally{n(!1)}},f=()=>{l(null),w({name:"",address:"",phone:"",email:""}),i(!0)},g=J=>{l(J),w({name:J.name,address:J.address,phone:J.phone,email:J.email}),i(!0)},b=async J=>{if(confirm("Apakah Anda yakin ingin menghapus koperasi ini?"))try{const{error:V}=await U.from("cooperatives").delete().eq("id",J);if(V)throw V;alert("Koperasi berhasil dihapus"),m()}catch(V){console.error("Error deleting cooperative:",V),alert("Gagal menghapus koperasi: "+V.message)}},L=async J=>{J.preventDefault();try{if(o){const{error:V}=await U.from("cooperatives").update(j).eq("id",o.id);if(V)throw V;alert("Data koperasi berhasil diupdate")}else{const{error:V}=await U.from("cooperatives").insert([j]);if(V)throw V;alert("Koperasi berhasil ditambahkan")}i(!1),l(null),m()}catch(V){console.error("Error saving cooperative:",V),alert("Gagal menyimpan data: "+V.message)}},A=J=>{w({...j,[J.target.name]:J.target.value})},k=J=>{d===J?_(h==="asc"?"desc":"asc"):(p(J),_("asc"))},N=()=>[...e].sort((V,Y)=>{let ue=V[d],O=Y[d];return typeof ue=="string"&&(ue=ue.toLowerCase(),O=(O==null?void 0:O.toLowerCase())||""),ue<O?h==="asc"?-1:1:ue>O?h==="asc"?1:-1:0}),R=()=>{const J=N(),V=(c-1)*y,Y=V+y;return J.slice(V,Y)},S=Math.ceil(e.length/y),B=R(),H=J=>d!==J?" ":h==="asc"?" ":" ";return r?s.jsx("div",{className:"loading",children:"Loading cooperatives..."}):s.jsxs("div",{className:"cooperatives-container",children:[s.jsxs("div",{className:"cooperatives-header",children:[s.jsx("h1",{children:"Data Koperasi"}),s.jsx("button",{className:"btn-add",onClick:f,children:"+ Tambah Koperasi"})]}),s.jsxs("div",{className:"data-info",children:[s.jsxs("span",{children:["Total: ",s.jsx("strong",{children:e.length})," koperasi"]}),s.jsxs("span",{children:["Halaman ",c," dari ",S||1]})]}),s.jsx("div",{className:"cooperatives-table",children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"No"}),s.jsxs("th",{onClick:()=>k("name"),style:{cursor:"pointer"},children:["Nama Koperasi",H("name")]}),s.jsx("th",{children:"Alamat"}),s.jsxs("th",{onClick:()=>k("phone"),style:{cursor:"pointer"},children:["No. Telepon",H("phone")]}),s.jsxs("th",{onClick:()=>k("email"),style:{cursor:"pointer"},children:["Email",H("email")]}),s.jsx("th",{children:"Aksi"})]})}),s.jsx("tbody",{children:e.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"6",style:{textAlign:"center"},children:"Belum ada data koperasi"})}):B.map((J,V)=>s.jsxs("tr",{children:[s.jsx("td",{children:(c-1)*y+V+1}),s.jsx("td",{children:J.name}),s.jsx("td",{children:J.address}),s.jsx("td",{children:J.phone}),s.jsx("td",{children:J.email}),s.jsx("td",{children:s.jsxs("div",{className:"actions",children:[s.jsx("button",{className:"btn-edit",onClick:()=>g(J),children:"Edit"}),s.jsx("button",{className:"btn-delete",onClick:()=>b(J.id),children:"Hapus"})]})})]},J.id))})]})}),S>1&&s.jsxs("div",{className:"pagination",children:[s.jsx("button",{onClick:()=>u(1),disabled:c===1,children:""}),s.jsx("button",{onClick:()=>u(c-1),disabled:c===1,children:""}),[...Array(S)].map((J,V)=>{const Y=V+1;return Y===1||Y===S||Y>=c-1&&Y<=c+1?s.jsx("button",{onClick:()=>u(Y),className:c===Y?"active":"",children:Y},Y):Y===c-2||Y===c+2?s.jsx("span",{children:"..."},Y):null}),s.jsx("button",{onClick:()=>u(c+1),disabled:c===S,children:""}),s.jsx("button",{onClick:()=>u(S),disabled:c===S,children:""})]}),a&&s.jsx("div",{className:"modal-overlay",onClick:()=>i(!1),children:s.jsxs("div",{className:"modal-content",onClick:J=>J.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:o?"Edit Koperasi":"Tambah Koperasi"}),s.jsx("button",{className:"btn-close",onClick:()=>i(!1),children:""})]}),s.jsxs("form",{onSubmit:L,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Nama Koperasi"}),s.jsx("input",{type:"text",name:"name",value:j.name,onChange:A,required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Alamat"}),s.jsx("textarea",{name:"address",value:j.address,onChange:A,rows:"3",required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"No. Telepon"}),s.jsx("input",{type:"text",name:"phone",value:j.phone,onChange:A,required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Email"}),s.jsx("input",{type:"email",name:"email",value:j.email,onChange:A,required:!0})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>i(!1),children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Simpan"})]})]})]})})]})}function x_(){const[e,t]=v.useState("loan_settings"),[r,n]=v.useState(!0),[a,i]=v.useState([]),[o,l]=v.useState([]),[c,u]=v.useState([]),[d,p]=v.useState([]),[h,_]=v.useState([]),[y,j]=v.useState({}),[w,m]=v.useState(1),[f,g]=v.useState(0),[b,L]=v.useState(1),[A,k]=v.useState(0),[N,R]=v.useState(1),[S,B]=v.useState(0),H=10,[J,V]=v.useState(!1),[Y,ue]=v.useState(null),[O,$]=v.useState({role:"",theme:""}),[F,M]=v.useState(!1),[Q,te]=v.useState(null),[oe,me]=v.useState({name:"",cooperative_id:"",interest_rate:"",period_months:"",is_active:!0}),[se,K]=v.useState(!1),[G,P]=v.useState(null),[D,q]=v.useState({email:"",password:"",role:"",theme:"warm_white"}),[Z,C]=v.useState(!1),[I,ie]=v.useState(null),[ae,fe]=v.useState({user_id:"",cooperative_id:"",role:"member"}),[je,pt]=v.useState([]),be=["super_admin","manager","credit_staff","member"],Le=["dashboard","members","savings","loans","cooperatives","audit_logs","admin","profile"],Xt=["view","create","edit","delete"];v.useEffect(()=>{m(1),L(1),R(1),Ot()},[e]),v.useEffect(()=>{e==="loan_settings"&&lt()},[w]),v.useEffect(()=>{e==="user_roles"&&gt()},[b]),v.useEffect(()=>{e==="cooperative_assignments"&&ct()},[N]);const Ot=async()=>{n(!0);try{e==="loan_settings"?await lt():e==="user_roles"?await gt():e==="cooperative_assignments"?await ct():e==="role_permissions"&&await hr()}catch(E){console.error("Error loading data:",E)}finally{n(!1)}},lt=async()=>{const{data:E}=await U.from("cooperatives").select("*").order("name");u(E||[]);const{count:X,error:ye}=await U.from("loan_products").select("*",{count:"exact",head:!0});if(ye)throw ye;g(X||0);const _e=(w-1)*H,We=_e+H-1,{data:xe,error:Oe}=await U.from("loan_products").select(`
        *,
        cooperatives (name)
      `).order("created_at",{ascending:!1}).range(_e,We);if(Oe)throw Oe;l(xe||[])},gt=async()=>{const{count:E,error:X}=await U.from("user_roles_with_auth").select("*",{count:"exact",head:!0});if(X)throw X;k(E||0);const ye=(b-1)*H,_e=ye+H-1,{data:We,error:xe}=await U.from("user_roles_with_auth").select("*").order("created_at",{ascending:!1}).range(ye,_e);if(xe)throw xe;i(We||[])},ct=async()=>{const{data:E}=await U.from("cooperatives").select("*").order("name");u(E||[]);const{data:X}=await U.from("user_roles_with_auth").select("*").order("email");pt(X||[]);const{count:ye,error:_e}=await U.from("user_cooperative_assignments_with_auth").select("*",{count:"exact",head:!0});if(_e)throw _e;B(ye||0);const We=(N-1)*H,xe=We+H-1,{data:Oe,error:Mr}=await U.from("user_cooperative_assignments_with_auth").select("*").order("created_at",{ascending:!1}).range(We,xe);if(Mr)throw Mr;p(Oe||[])},hr=async()=>{const{data:E,error:X}=await U.from("role_permissions").select("*").order("role",{ascending:!0});if(X)throw X;_(E||[]);const ye={};be.forEach(_e=>{ye[_e]={},Le.forEach(We=>{const xe=E==null?void 0:E.find(Oe=>Oe.role===_e&&Oe.menu===We);ye[_e][We]={id:xe==null?void 0:xe.id,can_view:(xe==null?void 0:xe.can_view)||!1,can_create:(xe==null?void 0:xe.can_create)||!1,can_edit:(xe==null?void 0:xe.can_edit)||!1,can_delete:(xe==null?void 0:xe.can_delete)||!1}})}),j(ye)},Fr=async(E,X,ye)=>{const _e=y[E][X],We=`can_${ye}`,xe=!_e[We];if(_e.id){const{error:Mr}=await U.from("role_permissions").update({[We]:xe}).eq("id",_e.id);if(Mr){console.error("Error updating permission:",Mr),alert("Gagal mengupdate permission");return}}else{const{data:Mr,error:kc}=await U.from("role_permissions").insert({role:E,menu:X,[We]:xe}).select().single();if(kc){console.error("Error creating permission:",kc),alert("Gagal membuat permission");return}_e.id=Mr.id}const Oe={...y};Oe[E][X][We]=xe,j(Oe)},z=E=>{ue(E),$({role:E.role,theme:E.theme||"warm_white"}),V(!0)},x=()=>{V(!1),ue(null),$({role:"",theme:""})},T=async E=>{if(E.preventDefault(),!!Y)try{const{error:X}=await U.from("user_roles").update({role:O.role,theme:O.theme}).eq("id",Y.id);if(X)throw X;alert("User berhasil diupdate!"),x(),gt()}catch(X){console.error("Error updating user:",X),alert("Gagal mengupdate user: "+X.message)}},ee=async E=>{if(confirm("Yakin ingin menghapus user ini?"))try{const{error:X}=await U.from("user_roles").delete().eq("id",E);if(X)throw X;alert("User berhasil dihapus!"),gt()}catch(X){console.error("Error deleting user:",X),alert("Gagal menghapus user: "+X.message)}},re=(E=null)=>{E?(te(E),me({name:E.name,cooperative_id:E.cooperative_id,interest_rate:E.interest_rate,period_months:E.period_months,is_active:E.is_active})):(te(null),me({name:"",cooperative_id:"",interest_rate:"",period_months:"",is_active:!0})),M(!0)},ce=async E=>{E.preventDefault();try{if(Q){const{error:X}=await U.from("loan_products").update({name:oe.name,cooperative_id:oe.cooperative_id,interest_rate:parseFloat(oe.interest_rate),period_months:parseInt(oe.period_months),is_active:oe.is_active}).eq("id",Q.id);if(X)throw X;alert("Produk pinjaman berhasil diupdate!")}else{const{error:X}=await U.from("loan_products").insert([{name:oe.name,cooperative_id:oe.cooperative_id,interest_rate:parseFloat(oe.interest_rate),period_months:parseInt(oe.period_months),is_active:oe.is_active}]);if(X)throw X;alert("Produk pinjaman berhasil ditambahkan!")}M(!1),lt()}catch(X){console.error("Error saving product:",X),alert("Gagal menyimpan produk: "+X.message)}},ve=async E=>{if(confirm("Yakin ingin menghapus produk ini?"))try{const{error:X}=await U.from("loan_products").delete().eq("id",E);if(X)throw X;alert("Produk berhasil dihapus!"),lt()}catch(X){console.error("Error deleting product:",X),alert("Gagal menghapus produk: "+X.message)}},Ze=(E=null)=>{E?(P(E),q({email:E.email,password:"",role:E.role,theme:E.theme||"warm_white"})):(P(null),q({email:"",password:"",role:"",theme:"warm_white"})),K(!0)},Zt=async E=>{E.preventDefault();try{if(G){const{error:X}=await U.from("user_roles").update({role:D.role,theme:D.theme}).eq("id",G.id);if(X)throw X;alert("User berhasil diupdate!")}else{const{data:X,error:ye}=await U.auth.signUp({email:D.email,password:D.password});if(ye)throw ye;const{error:_e}=await U.from("user_roles").insert([{user_id:X.user.id,role:D.role,theme:D.theme}]);if(_e)throw _e;alert("User berhasil ditambahkan!")}K(!1),gt()}catch(X){console.error("Error saving user:",X),alert("Gagal menyimpan user: "+X.message)}},Yn=(E=null)=>{E?(ie(E),fe({user_id:E.user_id,cooperative_id:E.cooperative_id,role:E.role||"member"})):(ie(null),fe({user_id:"",cooperative_id:"",role:"member"})),C(!0)},Ni=async E=>{E.preventDefault();try{if(I){const{error:X}=await U.from("user_cooperative_assignments").update({user_id:ae.user_id,cooperative_id:ae.cooperative_id,role:ae.role}).eq("id",I.id);if(X)throw X;alert("Assignment berhasil diupdate!")}else{const{error:X}=await U.from("user_cooperative_assignments").insert([{user_id:ae.user_id,cooperative_id:ae.cooperative_id,role:ae.role}]);if(X)throw X;alert("Assignment berhasil ditambahkan!")}C(!1),ct()}catch(X){console.error("Error saving assignment:",X),alert("Gagal menyimpan assignment: "+X.message)}},Zf=async E=>{if(confirm("Yakin ingin menghapus assignment ini?"))try{const{error:X}=await U.from("user_cooperative_assignments").delete().eq("id",E);if(X)throw X;alert("Assignment berhasil dihapus!"),ct()}catch(X){console.error("Error deleting assignment:",X),alert("Gagal menghapus assignment: "+X.message)}},Ci=(E,X,ye)=>{const _e=Math.ceil(X/H);return X<=H?null:s.jsxs("div",{className:"pagination",children:[s.jsx("button",{onClick:()=>ye(1),disabled:E===1,children:""}),s.jsx("button",{onClick:()=>ye(E-1),disabled:E===1,children:""}),[...Array(_e)].map((We,xe)=>{const Oe=xe+1;return Oe===1||Oe===_e||Oe>=E-1&&Oe<=E+1?s.jsx("button",{onClick:()=>ye(Oe),className:E===Oe?"active":"",children:Oe},Oe):Oe===E-2||Oe===E+2?s.jsx("span",{children:"..."},Oe):null}),s.jsx("button",{onClick:()=>ye(E+1),disabled:E===_e,children:""}),s.jsx("button",{onClick:()=>ye(_e),disabled:E===_e,children:""})]})};return r?s.jsx("div",{className:"loading",children:"Loading admin data..."}):s.jsxs("div",{className:"admin-container",children:[s.jsx("div",{className:"admin-header",children:s.jsx("h1",{children:"Manajemen Admin"})}),s.jsxs("div",{className:"admin-tabs",children:[s.jsx("button",{className:`admin-tab ${e==="loan_settings"?"active":""}`,onClick:()=>t("loan_settings"),children:"Pengaturan Pinjaman"}),s.jsx("button",{className:`admin-tab ${e==="user_roles"?"active":""}`,onClick:()=>t("user_roles"),children:"Kelola User dan Roles"}),s.jsx("button",{className:`admin-tab ${e==="cooperative_assignments"?"active":""}`,onClick:()=>t("cooperative_assignments"),children:"Assignment Koperasi"}),s.jsx("button",{className:`admin-tab ${e==="role_permissions"?"active":""}`,onClick:()=>t("role_permissions"),children:"Kelola Akses Roles"})]}),s.jsxs("div",{className:"admin-content",children:[e==="loan_settings"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{className:"section-title",children:"Produk Pinjaman"}),s.jsx("button",{className:"btn-add",onClick:()=>re(),children:"+ Tambah Produk"})]}),s.jsxs("div",{className:"data-info",children:[s.jsxs("span",{children:["Total: ",s.jsx("strong",{children:f})," produk"]}),s.jsxs("span",{children:["Halaman ",w," dari ",Math.ceil(f/H)||1]})]}),s.jsx("div",{className:"products-table-container",children:s.jsxs("table",{className:"products-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"No"}),s.jsx("th",{children:"Nama Produk"}),s.jsx("th",{children:"Koperasi"}),s.jsx("th",{children:"Bunga (%)"}),s.jsx("th",{children:"Periode (Bulan)"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Aksi"})]})}),s.jsx("tbody",{children:o.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"7",style:{textAlign:"center"},children:"Belum ada produk pinjaman"})}):o.map((E,X)=>{var ye;return s.jsxs("tr",{children:[s.jsx("td",{children:(w-1)*H+X+1}),s.jsx("td",{children:E.name}),s.jsx("td",{children:((ye=E.cooperatives)==null?void 0:ye.name)||"-"}),s.jsxs("td",{children:[E.interest_rate,"%"]}),s.jsx("td",{children:E.period_months}),s.jsx("td",{children:s.jsx("span",{className:`status-badge ${E.is_active?"active":"inactive"}`,children:E.is_active?"Aktif":"Nonaktif"})}),s.jsx("td",{children:s.jsxs("div",{className:"action-buttons",children:[s.jsx("button",{className:"edit-button-small",onClick:()=>re(E),children:"Edit"}),s.jsx("button",{className:"delete-button-small",onClick:()=>ve(E.id),children:"Hapus"})]})})]},E.id)})})]})}),Ci(w,f,m)]}),e==="user_roles"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{className:"section-title",children:"Kelola User dan Roles"}),s.jsx("button",{className:"btn-add",onClick:()=>Ze(),children:"+ Tambah User"})]}),s.jsxs("div",{className:"data-info",children:[s.jsxs("span",{children:["Total: ",s.jsx("strong",{children:A})," user"]}),s.jsxs("span",{children:["Halaman ",b," dari ",Math.ceil(A/H)||1]})]}),s.jsx("div",{className:"staff-table-container",children:s.jsxs("table",{className:"staff-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"No"}),s.jsx("th",{children:"Nama"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Theme"}),s.jsx("th",{children:"Aksi"})]})}),s.jsx("tbody",{children:a.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"6",style:{textAlign:"center"},children:"Belum ada data user"})}):a.map((E,X)=>s.jsxs("tr",{children:[s.jsx("td",{children:(b-1)*H+X+1}),s.jsx("td",{children:E.full_name||E.email||"-"}),s.jsx("td",{children:E.email||"-"}),s.jsx("td",{children:s.jsx("span",{className:"role-badge",children:E.role})}),s.jsx("td",{children:E.theme}),s.jsx("td",{children:s.jsxs("div",{className:"action-buttons",children:[s.jsx("button",{className:"edit-button-small",onClick:()=>z(E),children:"Edit"}),s.jsx("button",{className:"delete-button-small",onClick:()=>ee(E.id),children:"Hapus"})]})})]},E.id))})]})}),Ci(b,A,L)]}),e==="cooperative_assignments"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{className:"section-title",children:"Assignment Koperasi"}),s.jsx("button",{className:"btn-add",onClick:()=>Yn(),children:"+ Tambah Assignment"})]}),s.jsxs("div",{className:"data-info",children:[s.jsxs("span",{children:["Total: ",s.jsx("strong",{children:S})," assignment"]}),s.jsxs("span",{children:["Halaman ",N," dari ",Math.ceil(S/H)||1]})]}),s.jsx("div",{className:"staff-table-container",children:s.jsxs("table",{className:"staff-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"No"}),s.jsx("th",{children:"Nama User"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Koperasi"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Aksi"})]})}),s.jsx("tbody",{children:d.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"6",style:{textAlign:"center"},children:"Belum ada assignment"})}):d.map((E,X)=>s.jsxs("tr",{children:[s.jsx("td",{children:(N-1)*H+X+1}),s.jsx("td",{children:E.full_name||E.email||"-"}),s.jsx("td",{children:E.email||"-"}),s.jsx("td",{children:E.cooperative_name||"-"}),s.jsx("td",{children:s.jsx("span",{className:"role-badge",children:E.role})}),s.jsx("td",{children:s.jsxs("div",{className:"action-buttons",children:[s.jsx("button",{className:"edit-button-small",onClick:()=>Yn(E),children:"Edit"}),s.jsx("button",{className:"delete-button-small",onClick:()=>Zf(E.id),children:"Hapus"})]})})]},E.id))})]})}),Ci(N,S,R)]}),e==="role_permissions"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"permissions-header",children:[s.jsx("h2",{className:"permissions-title",children:"Kelola Akses Menu per Role"}),s.jsx("p",{className:"permissions-subtitle",children:"Atur akses setiap role ke menu dan permission yang tersedia"})]}),s.jsx("div",{className:"permissions-matrix-container",children:s.jsxs("table",{className:"permissions-matrix",children:[s.jsxs("thead",{children:[s.jsxs("tr",{children:[s.jsx("th",{className:"role-column",children:"Role"}),Le.map(E=>s.jsx("th",{colSpan:4,className:"menu-column",children:E==="audit_logs"?"Riwayat":E.charAt(0).toUpperCase()+E.slice(1)},E))]}),s.jsxs("tr",{children:[s.jsx("th",{}),Le.map(E=>Xt.map(X=>s.jsx("th",{className:"permission-type-column",children:X.charAt(0).toUpperCase()+X.slice(1)},`${E}-${X}`)))]})]}),s.jsx("tbody",{children:be.map(E=>s.jsxs("tr",{children:[s.jsx("td",{className:"role-name-cell",children:E==="super_admin"?"Super Admin":E==="credit_staff"?"Credit Staff":E.charAt(0).toUpperCase()+E.slice(1)}),Le.map(X=>Xt.map(ye=>{var _e,We;return s.jsx("td",{className:"permission-toggle-cell",children:s.jsxs("label",{className:"toggle-switch-small",children:[s.jsx("input",{type:"checkbox",checked:((We=(_e=y[E])==null?void 0:_e[X])==null?void 0:We[`can_${ye}`])||!1,onChange:()=>Fr(E,X,ye)}),s.jsx("span",{className:"toggle-slider-small"})]})},`${E}-${X}-${ye}`)}))]},E))})]})})]})]}),F&&s.jsx("div",{className:"modal-overlay",onClick:()=>M(!1),children:s.jsxs("div",{className:"modal-content",onClick:E=>E.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:Q?"Edit Produk Pinjaman":"Tambah Produk Pinjaman"}),s.jsx("button",{className:"modal-close",onClick:()=>M(!1),children:""})]}),s.jsxs("form",{onSubmit:ce,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Nama Produk"}),s.jsx("input",{type:"text",className:"form-input",value:oe.name,onChange:E=>me({...oe,name:E.target.value}),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Koperasi"}),s.jsxs("select",{className:"form-input",value:oe.cooperative_id,onChange:E=>me({...oe,cooperative_id:E.target.value}),required:!0,children:[s.jsx("option",{value:"",children:"Pilih Koperasi"}),c.map(E=>s.jsx("option",{value:E.id,children:E.name},E.id))]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Bunga (%)"}),s.jsx("input",{type:"number",step:"0.01",className:"form-input",value:oe.interest_rate,onChange:E=>me({...oe,interest_rate:E.target.value}),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Periode (Bulan)"}),s.jsx("input",{type:"number",className:"form-input",value:oe.period_months,onChange:E=>me({...oe,period_months:E.target.value}),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Status"}),s.jsxs("select",{className:"form-input",value:oe.is_active,onChange:E=>me({...oe,is_active:E.target.value==="true"}),required:!0,children:[s.jsx("option",{value:"true",children:"Aktif"}),s.jsx("option",{value:"false",children:"Nonaktif"})]})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>M(!1),children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Simpan"})]})]})]})}),J&&s.jsx("div",{className:"modal-overlay",onClick:x,children:s.jsxs("div",{className:"modal-content",onClick:E=>E.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Edit User dan Role"}),s.jsx("button",{className:"modal-close",onClick:x,children:""})]}),s.jsxs("form",{onSubmit:T,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Nama"}),s.jsx("input",{type:"text",value:(Y==null?void 0:Y.full_name)||(Y==null?void 0:Y.email)||"-",disabled:!0,className:"form-input"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Email"}),s.jsx("input",{type:"text",value:(Y==null?void 0:Y.email)||"-",disabled:!0,className:"form-input"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Role"}),s.jsxs("select",{className:"form-input",value:O.role,onChange:E=>$({...O,role:E.target.value}),required:!0,children:[s.jsx("option",{value:"",children:"Pilih Role"}),s.jsx("option",{value:"superadmin",children:"Superadmin"}),s.jsx("option",{value:"admin",children:"Admin"}),s.jsx("option",{value:"manager",children:"Manager"}),s.jsx("option",{value:"staff",children:"Staff"}),s.jsx("option",{value:"credit_staff",children:"Credit Staff"}),s.jsx("option",{value:"member",children:"Member"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Theme"}),s.jsxs("select",{className:"form-input",value:O.theme,onChange:E=>$({...O,theme:E.target.value}),required:!0,children:[s.jsx("option",{value:"warm_white",children:"Warm White"}),s.jsx("option",{value:"dark",children:"Dark"}),s.jsx("option",{value:"color",children:"Color"})]})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:x,children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Simpan"})]})]})]})}),se&&s.jsx("div",{className:"modal-overlay",onClick:()=>K(!1),children:s.jsxs("div",{className:"modal-content",onClick:E=>E.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:G?"Edit User":"Tambah User Baru"}),s.jsx("button",{className:"modal-close",onClick:()=>K(!1),children:""})]}),s.jsxs("form",{onSubmit:Zt,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Email"}),s.jsx("input",{type:"email",className:"form-input",value:D.email,onChange:E=>q({...D,email:E.target.value}),disabled:G,required:!0})]}),!G&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Password"}),s.jsx("input",{type:"password",className:"form-input",value:D.password,onChange:E=>q({...D,password:E.target.value}),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Role"}),s.jsxs("select",{className:"form-input",value:D.role,onChange:E=>q({...D,role:E.target.value}),required:!0,children:[s.jsx("option",{value:"",children:"Pilih Role"}),s.jsx("option",{value:"super_admin",children:"Super Admin"}),s.jsx("option",{value:"manager",children:"Manager"}),s.jsx("option",{value:"credit_staff",children:"Credit Staff"}),s.jsx("option",{value:"member",children:"Member"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Theme"}),s.jsxs("select",{className:"form-input",value:D.theme,onChange:E=>q({...D,theme:E.target.value}),required:!0,children:[s.jsx("option",{value:"warm_white",children:"Warm White"}),s.jsx("option",{value:"dark",children:"Dark"}),s.jsx("option",{value:"color",children:"Color"})]})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>K(!1),children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Simpan"})]})]})]})}),Z&&s.jsx("div",{className:"modal-overlay",onClick:()=>C(!1),children:s.jsxs("div",{className:"modal-content",onClick:E=>E.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:I?"Edit Assignment":"Tambah Assignment Baru"}),s.jsx("button",{className:"modal-close",onClick:()=>C(!1),children:""})]}),s.jsxs("form",{onSubmit:Ni,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"User"}),s.jsxs("select",{className:"form-input",value:ae.user_id,onChange:E=>fe({...ae,user_id:E.target.value}),required:!0,children:[s.jsx("option",{value:"",children:"Pilih User"}),je.map(E=>s.jsx("option",{value:E.user_id,children:E.full_name||E.email},E.user_id))]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Koperasi"}),s.jsxs("select",{className:"form-input",value:ae.cooperative_id,onChange:E=>fe({...ae,cooperative_id:E.target.value}),required:!0,children:[s.jsx("option",{value:"",children:"Pilih Koperasi"}),c.map(E=>s.jsx("option",{value:E.id,children:E.name},E.id))]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Role di Koperasi"}),s.jsxs("select",{className:"form-input",value:ae.role,onChange:E=>fe({...ae,role:E.target.value}),required:!0,children:[s.jsx("option",{value:"member",children:"Member"}),s.jsx("option",{value:"manager",children:"Manager"}),s.jsx("option",{value:"credit_staff",children:"Credit Staff"})]})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>C(!1),children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Simpan"})]})]})]})})]})}function j_(){var R;const[e,t]=v.useState(null),[r,n]=v.useState(null),[a,i]=v.useState(!0),[o,l]=v.useState(!1),[c,u]=v.useState(!1),[d,p]=v.useState("warm_white"),[h,_]=v.useState(null),[y,j]=v.useState({full_name:"",phone:"",address:""}),[w,m]=v.useState({currentPassword:"",newPassword:"",confirmPassword:""});v.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:{user:S}}=await U.auth.getUser();if(t(S),S){const{data:B,error:H}=await U.from("members").select("*").eq("user_id",S.id).maybeSingle();if(H)throw H;n(B);const{data:J,error:V}=await U.from("user_roles").select("*").eq("user_id",S.id).maybeSingle();if(V)throw V;_(J),J!=null&&J.theme&&(p(J.theme),g(J.theme))}}catch(S){console.error("Error loading profile:",S)}finally{i(!1)}},g=S=>{document.body.className="",document.body.classList.add(`theme-${S}`)},b=()=>{j({full_name:(r==null?void 0:r.full_name)||"",phone:(r==null?void 0:r.phone)||"",address:(r==null?void 0:r.address)||""}),l(!0)},L=async S=>{S.preventDefault();try{if(r){const{error:B}=await U.from("members").update({full_name:y.full_name,phone:y.phone,address:y.address}).eq("id",r.id);if(B)throw B;alert("Profile berhasil diupdate!"),l(!1),f()}}catch(B){console.error("Error updating profile:",B),alert("Gagal mengupdate profile: "+B.message)}},A=()=>{m({currentPassword:"",newPassword:"",confirmPassword:""}),u(!0)},k=async S=>{if(S.preventDefault(),w.newPassword!==w.confirmPassword){alert("Password baru dan konfirmasi password tidak sama!");return}if(w.newPassword.length<6){alert("Password baru minimal 6 karakter!");return}try{const{error:B}=await U.auth.updateUser({password:w.newPassword});if(B)throw B;alert("Password berhasil diubah!"),u(!1)}catch(B){console.error("Error changing password:",B),alert("Gagal mengubah password: "+B.message)}},N=async S=>{try{if(!h){alert("User role tidak ditemukan!");return}const{error:B}=await U.from("user_roles").update({theme:S}).eq("id",h.id);if(B)throw B;p(S),g(S),alert("Theme berhasil diubah!")}catch(B){console.error("Error changing theme:",B),alert("Gagal mengubah theme: "+B.message)}};return a?s.jsx("div",{className:"loading",children:"Loading profile..."}):s.jsxs("div",{className:"profile-page",children:[s.jsx("h1",{children:"Profile Saya"}),s.jsxs("div",{className:"profile-card",children:[s.jsxs("div",{className:"profile-header",children:[s.jsx("div",{className:"profile-avatar",children:((R=r==null?void 0:r.full_name)==null?void 0:R.charAt(0).toUpperCase())||"U"}),s.jsxs("div",{className:"profile-info",children:[s.jsx("h2",{children:(r==null?void 0:r.full_name)||"User"}),s.jsx("p",{children:e==null?void 0:e.email})]})]}),s.jsxs("div",{className:"profile-details",children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Nama Lengkap"}),s.jsx("p",{children:(r==null?void 0:r.full_name)||"-"})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Email"}),s.jsx("p",{children:(r==null?void 0:r.email)||(e==null?void 0:e.email)||"-"})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"No. Telepon"}),s.jsx("p",{children:(r==null?void 0:r.phone)||"-"})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Alamat"}),s.jsx("p",{children:(r==null?void 0:r.address)||"-"})]})]}),s.jsxs("div",{className:"profile-actions",children:[s.jsx("button",{className:"btn-add",onClick:b,children:"Edit Profile"}),s.jsx("button",{className:"btn-add",onClick:A,children:"Ubah Password"})]})]}),s.jsxs("div",{className:"profile-card",children:[s.jsx("h2",{children:"Personalisasi Theme"}),s.jsx("p",{className:"theme-description",children:"Pilih tema tampilan yang sesuai dengan preferensi Anda"}),s.jsxs("div",{className:"theme-selector",children:[s.jsxs("div",{className:`theme-option ${d==="warm_white"?"active":""}`,onClick:()=>N("warm_white"),children:[s.jsxs("div",{className:"theme-preview theme-preview-light",children:[s.jsx("div",{className:"preview-header"}),s.jsx("div",{className:"preview-sidebar"}),s.jsx("div",{className:"preview-content"})]}),s.jsxs("div",{className:"theme-info",children:[s.jsx("h3",{children:"Warm White"}),s.jsx("p",{children:"Tema terang dengan nuansa hangat dan profesional"})]})]}),s.jsxs("div",{className:`theme-option ${d==="dark"?"active":""}`,onClick:()=>N("dark"),children:[s.jsxs("div",{className:"theme-preview theme-preview-dark",children:[s.jsx("div",{className:"preview-header"}),s.jsx("div",{className:"preview-sidebar"}),s.jsx("div",{className:"preview-content"})]}),s.jsxs("div",{className:"theme-info",children:[s.jsx("h3",{children:"Dark Mode"}),s.jsx("p",{children:"Tema gelap yang nyaman untuk mata di malam hari"})]})]}),s.jsxs("div",{className:`theme-option ${d==="color"?"active":""}`,onClick:()=>N("color"),children:[s.jsxs("div",{className:"theme-preview theme-preview-color",children:[s.jsx("div",{className:"preview-header"}),s.jsx("div",{className:"preview-sidebar"}),s.jsx("div",{className:"preview-content"})]}),s.jsxs("div",{className:"theme-info",children:[s.jsx("h3",{children:"Colorful"}),s.jsx("p",{children:"Tema berwarna dengan nuansa merah yang lembut"})]})]})]})]}),o&&s.jsx("div",{className:"modal-overlay",onClick:()=>l(!1),children:s.jsxs("div",{className:"modal-content",onClick:S=>S.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Edit Profile"}),s.jsx("button",{className:"modal-close",onClick:()=>l(!1),children:""})]}),s.jsxs("form",{onSubmit:L,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Nama Lengkap"}),s.jsx("input",{type:"text",className:"form-input",value:y.full_name,onChange:S=>j({...y,full_name:S.target.value}),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"No. Telepon"}),s.jsx("input",{type:"text",className:"form-input",value:y.phone,onChange:S=>j({...y,phone:S.target.value})})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Alamat"}),s.jsx("textarea",{className:"form-input",rows:"4",value:y.address,onChange:S=>j({...y,address:S.target.value})})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>l(!1),children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Simpan"})]})]})]})}),c&&s.jsx("div",{className:"modal-overlay",onClick:()=>u(!1),children:s.jsxs("div",{className:"modal-content",onClick:S=>S.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Ubah Password"}),s.jsx("button",{className:"modal-close",onClick:()=>u(!1),children:""})]}),s.jsxs("form",{onSubmit:k,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Password Baru"}),s.jsx("input",{type:"password",className:"form-input",value:w.newPassword,onChange:S=>m({...w,newPassword:S.target.value}),required:!0,minLength:"6"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Konfirmasi Password Baru"}),s.jsx("input",{type:"password",className:"form-input",value:w.confirmPassword,onChange:S=>m({...w,confirmPassword:S.target.value}),required:!0,minLength:"6"})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>u(!1),children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Ubah Password"})]})]})]})})]})}function b_(){const[e,t]=v.useState([]),[r,n]=v.useState(!0),[a,i]=v.useState(null),[o,l]=v.useState({table:"all",action:"all",dateFrom:"",dateTo:""}),[c,u]=v.useState(!1),[d,p]=v.useState(null),[h,_]=v.useState(1),[y,j]=v.useState(0),w=10;v.useEffect(()=>{m()},[]),v.useEffect(()=>{c&&_(1)},[o]),v.useEffect(()=>{c&&f()},[c,o,h]);async function m(){try{const{data:{user:k}}=await U.auth.getUser();if(!k){i("Tidak terautentikasi");return}const{data:N}=await U.from("user_roles").select("role").eq("user_id",k.id).maybeSingle(),R=(N==null?void 0:N.role)||"member";p(R);const{data:S}=await U.from("role_permissions").select("can_view").eq("role",R).eq("menu","audit_logs").maybeSingle();S!=null&&S.can_view?u(!0):(u(!1),i("Anda tidak memiliki akses ke halaman ini"))}catch(k){console.error("Error checking access:",k),i("Gagal memeriksa akses")}}async function f(){try{n(!0),i(null);let k=U.from("audit_logs_with_users").select("*",{count:"exact",head:!0});o.table!=="all"&&(k=k.eq("table_name",o.table)),o.action!=="all"&&(k=k.eq("action",o.action)),o.dateFrom&&(k=k.gte("changed_at",o.dateFrom)),o.dateTo&&(k=k.lte("changed_at",o.dateTo+"T23:59:59"));const{count:N,error:R}=await k;if(R)throw R;j(N||0);const S=(h-1)*w,B=S+w-1;let H=U.from("audit_logs_with_users").select(`
          *,
          member:members(member_number, full_name),
          cooperative:cooperatives(name)
        `).order("changed_at",{ascending:!1}).range(S,B);o.table!=="all"&&(H=H.eq("table_name",o.table)),o.action!=="all"&&(H=H.eq("action",o.action)),o.dateFrom&&(H=H.gte("changed_at",o.dateFrom)),o.dateTo&&(H=H.lte("changed_at",o.dateTo+"T23:59:59"));const{data:J,error:V}=await H;if(V)throw V;t(J||[])}catch(k){console.error("Error fetching logs:",k),i("Gagal memuat data audit logs")}finally{n(!1)}}function g(k){return new Date(k).toLocaleString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function b(k){return{INSERT:{class:"badge-success",text:"Tambah"},UPDATE:{class:"badge-warning",text:"Ubah"},DELETE:{class:"badge-danger",text:"Hapus"}}[k]||{class:"",text:k}}function L(k){return{members:"Anggota",loans:"Pinjaman",savings:"Simpanan"}[k]||k}function A(k){if(k.action==="INSERT")return s.jsx("div",{className:"changes-summary",children:s.jsx("span",{className:"change-label",children:"Data baru ditambahkan"})});if(k.action==="DELETE")return s.jsx("div",{className:"changes-summary",children:s.jsx("span",{className:"change-label",children:"Data dihapus"})});if(k.action==="UPDATE"&&k.old_data&&k.new_data){const N=[],R=k.old_data,S=k.new_data;for(const B in S)R[B]!==S[B]&&B!=="updated_at"&&B!=="created_at"&&N.push({field:B,old:R[B],new:S[B]});return N.length===0?s.jsx("span",{className:"no-changes",children:"Tidak ada perubahan signifikan"}):s.jsxs("div",{className:"changes-list",children:[N.slice(0,3).map((B,H)=>s.jsxs("div",{className:"change-item",children:[s.jsxs("span",{className:"field-name",children:[B.field,":"]}),s.jsx("span",{className:"old-value",children:String(B.old||"-")}),s.jsx("span",{className:"arrow",children:""}),s.jsx("span",{className:"new-value",children:String(B.new||"-")})]},H)),N.length>3&&s.jsxs("span",{className:"more-changes",children:["+",N.length-3," perubahan lainnya"]})]})}return null}return c?s.jsxs("div",{className:"audit-logs-page",children:[s.jsxs("div",{className:"page-header",children:[s.jsx("h1",{children:"Riwayat Perubahan Data"}),s.jsx("p",{className:"page-subtitle",children:"Audit trail untuk melacak semua perubahan data anggota, pinjaman, dan simpanan"})]}),s.jsxs("div",{className:"filters-section",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tabel:"}),s.jsxs("select",{value:o.table,onChange:k=>l({...o,table:k.target.value}),children:[s.jsx("option",{value:"all",children:"Semua"}),s.jsx("option",{value:"members",children:"Anggota"}),s.jsx("option",{value:"loans",children:"Pinjaman"}),s.jsx("option",{value:"savings",children:"Simpanan"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Aksi:"}),s.jsxs("select",{value:o.action,onChange:k=>l({...o,action:k.target.value}),children:[s.jsx("option",{value:"all",children:"Semua"}),s.jsx("option",{value:"INSERT",children:"Tambah"}),s.jsx("option",{value:"UPDATE",children:"Ubah"}),s.jsx("option",{value:"DELETE",children:"Hapus"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Dari Tanggal:"}),s.jsx("input",{type:"date",value:o.dateFrom,onChange:k=>l({...o,dateFrom:k.target.value})})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Sampai Tanggal:"}),s.jsx("input",{type:"date",value:o.dateTo,onChange:k=>l({...o,dateTo:k.target.value})})]}),s.jsx("button",{className:"btn-reset",onClick:()=>l({table:"all",action:"all",dateFrom:"",dateTo:""}),children:"Reset Filter"})]}),r&&s.jsx("div",{className:"loading",children:"Memuat data..."}),a&&s.jsx("div",{className:"error-message",children:a}),!r&&!a&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"data-info",children:[s.jsxs("span",{children:["Total: ",s.jsx("strong",{children:y})," riwayat"]}),s.jsxs("span",{children:["Halaman ",h," dari ",Math.ceil(y/w)||1]})]}),s.jsx("div",{className:"logs-container",children:e.length===0?s.jsx("div",{className:"no-data",children:"Belum ada riwayat perubahan data"}):s.jsx("div",{className:"logs-list",children:e.map(k=>s.jsxs("div",{className:"log-card",children:[s.jsxs("div",{className:"log-header",children:[s.jsxs("div",{className:"log-info",children:[s.jsx("span",{className:`action-badge ${b(k.action).class}`,children:b(k.action).text}),s.jsx("span",{className:"table-name",children:L(k.table_name)}),k.cooperative&&s.jsx("span",{className:"cooperative-name",children:k.cooperative.name})]}),s.jsx("div",{className:"log-time",children:g(k.changed_at)})]}),s.jsxs("div",{className:"log-body",children:[k.member&&s.jsxs("div",{className:"member-info",children:[s.jsx("strong",{children:"Anggota:"})," ",k.member.member_number," - ",k.member.full_name]}),A(k)]}),s.jsx("div",{className:"log-footer",children:s.jsxs("span",{className:"changed-by",children:["Oleh: ",k.changed_by_name||k.changed_by_email||"System"]})})]},k.id))})}),y>w&&s.jsxs("div",{className:"pagination",children:[s.jsx("button",{onClick:()=>_(1),disabled:h===1,children:""}),s.jsx("button",{onClick:()=>_(h-1),disabled:h===1,children:""}),[...Array(Math.ceil(y/w))].map((k,N)=>{const R=N+1,S=Math.ceil(y/w);return R===1||R===S||R>=h-1&&R<=h+1?s.jsx("button",{onClick:()=>_(R),className:h===R?"active":"",children:R},R):R===h-2||R===h+2?s.jsx("span",{children:"..."},R):null}),s.jsx("button",{onClick:()=>_(h+1),disabled:h===Math.ceil(y/w),children:""}),s.jsx("button",{onClick:()=>_(Math.ceil(y/w)),disabled:h===Math.ceil(y/w),children:""})]})]})]}):s.jsx("div",{className:"audit-logs-page",children:s.jsx("div",{className:"error-message",children:a})})}function S_(){const[e,t]=v.useState([]),[r,n]=v.useState([]),[a,i]=v.useState(null),[o,l]=v.useState({cooperative_id:"",period_year:new Date().getFullYear(),gross_shu:0,notes:""}),[c,u]=v.useState([]),[d,p]=v.useState(null),[h,_]=v.useState(!0),[y,j]=v.useState(!1),[w,m]=v.useState(""),[f,g]=v.useState(""),[b,L]=v.useState(null),[A,k]=v.useState(null),[N,R]=v.useState(!1),[S,B]=v.useState([]);v.useEffect(()=>{H()},[]),v.useEffect(()=>{if(o.cooperative_id){const P=e.find(D=>D.id===o.cooperative_id);i(P),P&&o.gross_shu>0&&ue(P,o.gross_shu)}},[o.cooperative_id,o.gross_shu,e]),v.useEffect(()=>{o.cooperative_id&&o.period_year&&V()},[o.cooperative_id,o.period_year]);const H=async()=>{try{const P=await qt();L(P.role);let D=U.from("cooperatives").select("*").order("name");qe(P)||(D=D.in("id",P.cooperativeIds));const{data:q,error:Z}=await D;if(Z)throw Z;t(q||[]),q&&q.length>0&&l(C=>({...C,cooperative_id:q[0].id})),await J()}catch(P){console.error("Error loading data:",P),m("Gagal memuat data: "+P.message)}finally{_(!1)}},J=async()=>{try{const{data:P,error:D}=await U.from("shu_calculations").select(`
          *,
          cooperatives (name)
        `).order("period_year",{ascending:!1});if(D)throw D;n(P||[])}catch(P){console.error("Error loading calculations:",P)}},V=async()=>{if(!(!o.cooperative_id||!o.period_year)){j(!0);try{const P=`${o.period_year}-01-01`,D=`${o.period_year}-12-31`,{data:q}=await U.from("loan_payments").select(`
          interest_amount,
          payment_date,
          loan_id (
            member_id (
              cooperative_id
            )
          )
        `).gte("payment_date",P).lte("payment_date",D),{data:Z}=await U.from("operational_journal").select("*").gte("transaction_date",P).lte("transaction_date",D),C=q==null?void 0:q.filter(be=>{var Le,Xt;return((Xt=(Le=be.loan_id)==null?void 0:Le.member_id)==null?void 0:Xt.cooperative_id)===o.cooperative_id}),I=Z==null?void 0:Z.filter(be=>be.cooperative_id===o.cooperative_id),ie=(C==null?void 0:C.reduce((be,Le)=>be+parseFloat(Le.interest_amount||0),0))||0,ae=(I==null?void 0:I.filter(be=>be.transaction_type==="credit").reduce((be,Le)=>be+parseFloat(Le.amount||0),0))||0,fe=ie+ae,je=(I==null?void 0:I.filter(be=>be.transaction_type==="debit").reduce((be,Le)=>be+parseFloat(Le.amount||0),0))||0,pt=Math.round((fe-je)*100)/100;k(pt)}catch(P){console.error("Error loading net income:",P),k(null)}finally{j(!1)}}},Y=()=>{if(A!==null){const P=Math.round(A*100)/100;l(D=>({...D,gross_shu:P})),g("SHU Kotor berhasil diisi dari Laba Bersih")}},ue=(P,D)=>{const Z=[{type:"jasa_modal",label:"Jasa Modal",pct:P.shu_jasa_modal_pct||30},{type:"jasa_usaha",label:"Jasa Usaha",pct:P.shu_jasa_usaha_pct||25},{type:"cadangan",label:"Dana Cadangan",pct:P.shu_cadangan_pct||20},{type:"pengurus",label:"Dana Pengurus",pct:P.shu_pengurus_pct||10},{type:"karyawan",label:"Dana Karyawan",pct:P.shu_karyawan_pct||5},{type:"pendidikan",label:"Dana Pendidikan",pct:P.shu_pendidikan_pct||5},{type:"sosial",label:"Dana Sosial",pct:P.shu_sosial_pct||3},{type:"pembangunan",label:"Dana Pembangunan",pct:P.shu_pembangunan_pct||2}].map((C,I)=>({...C,id:`alloc-${I}`,amount:D*C.pct/100}));u(Z),B(Z)},O=()=>{R(!0),B([...c])},$=()=>{R(!1),B([...c])},F=()=>{const P=S.reduce((q,Z)=>q+parseFloat(Z.pct||0),0);if(Math.abs(P-100)>.01){m(`Total persentase harus 100% (saat ini: ${P.toFixed(2)}%)`);return}const D=S.map(q=>({...q,pct:parseFloat(q.pct||0),amount:o.gross_shu*parseFloat(q.pct||0)/100}));u(D),R(!1),g("Alokasi berhasil diperbarui"),m("")},M=()=>{const P={id:`alloc-${Date.now()}`,type:`custom_${Date.now()}`,label:"Alokasi Baru",pct:0,amount:0};B([...S,P])},Q=(P,D,q)=>{B(S.map(Z=>{if(Z.id===P){const C={...Z};if(D==="pct"){const I=parseFloat(q||0);C.pct=I,C.amount=o.gross_shu*I/100}else C[D]=q;return C}return Z}))},te=P=>{B(S.filter(D=>D.id!==P))},oe=async P=>{var D;if(P.preventDefault(),m(""),g(""),!o.cooperative_id||!o.period_year||o.gross_shu<=0){m("Mohon lengkapi semua field dengan benar");return}try{const{data:{user:q}}=await U.auth.getUser(),Z={cooperative_id:o.cooperative_id,period_year:parseInt(o.period_year),gross_shu:parseFloat(o.gross_shu),status:"draft",notes:o.notes,created_by:q.id},{data:C,error:I}=await U.from("shu_calculations").insert([Z]).select().single();if(I)throw I;const ie=c.map(fe=>({shu_calculation_id:C.id,allocation_type:fe.type,percentage:fe.pct,amount:fe.amount})),{error:ae}=await U.from("shu_allocations").insert(ie);if(ae)throw ae;g("Perhitungan SHU berhasil disimpan"),p(C),await J(),l({cooperative_id:((D=e[0])==null?void 0:D.id)||"",period_year:new Date().getFullYear(),gross_shu:0,notes:""}),u([])}catch(q){console.error("Error saving calculation:",q),m("Gagal menyimpan perhitungan: "+q.message)}},me=async P=>{try{const{data:D,error:q}=await U.from("shu_allocations").select("*").eq("shu_calculation_id",P.id).order("allocation_type");if(q)throw q;const Z={jasa_modal:"Jasa Modal",jasa_usaha:"Jasa Usaha",cadangan:"Dana Cadangan",pengurus:"Dana Pengurus",karyawan:"Dana Karyawan",pendidikan:"Dana Pendidikan",sosial:"Dana Sosial",pembangunan:"Dana Pembangunan"},C=D.map(I=>({type:I.allocation_type,label:Z[I.allocation_type]||I.allocation_type,pct:I.percentage,amount:I.amount}));u(C),p(P),l({cooperative_id:P.cooperative_id,period_year:P.period_year,gross_shu:P.gross_shu,notes:P.notes||""})}catch(D){console.error("Error loading calculation details:",D),m("Gagal memuat detail perhitungan")}},se=P=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(P),K=()=>c.reduce((P,D)=>P+D.amount,0),G=()=>c.reduce((P,D)=>P+parseFloat(D.pct||0),0);return h?s.jsx("div",{className:"shu-calculation-page",children:"Memuat data..."}):s.jsxs("div",{className:"shu-calculation-page",children:[s.jsx("div",{className:"shu-calculation-header",children:s.jsx("h1",{children:"Perhitungan & Alokasi SHU"})}),w&&s.jsx("div",{className:"shu-error",children:w}),f&&s.jsx("div",{className:"shu-success",children:f}),s.jsxs("div",{className:"shu-calculation-content",children:[s.jsxs("div",{className:"shu-calculation-card",children:[s.jsx("h2",{children:"Input Perhitungan SHU"}),s.jsxs("form",{onSubmit:oe,children:[s.jsxs("div",{className:"shu-form-grid",children:[s.jsxs("div",{className:"shu-form-group",children:[s.jsx("label",{children:"Koperasi"}),s.jsxs("select",{value:o.cooperative_id,onChange:P=>l({...o,cooperative_id:P.target.value}),required:!0,children:[s.jsx("option",{value:"",children:"Pilih Koperasi"}),e.map(P=>s.jsx("option",{value:P.id,children:P.name},P.id))]})]}),s.jsxs("div",{className:"shu-form-group",children:[s.jsx("label",{children:"Tahun Periode"}),s.jsx("input",{type:"number",value:o.period_year,onChange:P=>l({...o,period_year:P.target.value}),min:"2000",max:"2100",required:!0})]}),s.jsxs("div",{className:"shu-form-group",children:[s.jsx("label",{children:"SHU Kotor (Rp)"}),s.jsx("input",{type:"number",value:o.gross_shu,onChange:P=>l({...o,gross_shu:P.target.value}),min:"0",step:"0.01",required:!0})]})]}),A!==null&&s.jsx("div",{style:{backgroundColor:"#e7f3ff",padding:"1rem",borderRadius:"4px",marginBottom:"1rem",border:"1px solid #3498db"},children:s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Laba Bersih dari Laporan Laba Rugi:"}),s.jsx("div",{style:{fontSize:"1.25rem",color:"#27ae60",fontWeight:"700",marginTop:"0.5rem"},children:se(A)}),s.jsxs("small",{style:{color:"#7f8c8d"},children:["Periode: ",o.period_year]})]}),s.jsx("button",{type:"button",className:"shu-btn shu-btn-primary",onClick:Y,style:{whiteSpace:"nowrap"},children:"Gunakan Nilai Ini"})]})}),y&&s.jsx("div",{style:{backgroundColor:"#f8f9fa",padding:"1rem",borderRadius:"4px",marginBottom:"1rem",textAlign:"center",color:"#7f8c8d"},children:"Memuat data Laba Bersih..."}),s.jsxs("div",{className:"shu-form-group",children:[s.jsx("label",{children:"Catatan"}),s.jsx("input",{type:"text",value:o.notes,onChange:P=>l({...o,notes:P.target.value}),placeholder:"Catatan tambahan (opsional)"})]}),c.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"2rem",marginBottom:"1rem"},children:[s.jsx("h3",{style:{margin:0},children:"Alokasi SHU"}),!N&&s.jsx("button",{type:"button",className:"shu-btn shu-btn-secondary",onClick:O,style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:"Edit Alokasi"})]}),N?s.jsxs(s.Fragment,{children:[s.jsxs("table",{className:"shu-allocations-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Jenis Alokasi"}),s.jsx("th",{className:"percentage-cell",children:"Persentase (%)"}),s.jsx("th",{className:"amount-cell",children:"Jumlah"}),s.jsx("th",{style:{width:"80px",textAlign:"center"},children:"Aksi"})]})}),s.jsxs("tbody",{children:[S.map(P=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("input",{type:"text",value:P.label,onChange:D=>Q(P.id,"label",D.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px"}})}),s.jsx("td",{className:"percentage-cell",children:s.jsx("input",{type:"number",value:P.pct,onChange:D=>Q(P.id,"pct",D.target.value),min:"0",max:"100",step:"0.01",style:{width:"80px",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",textAlign:"center"}})}),s.jsx("td",{className:"amount-cell",children:se(P.amount)}),s.jsx("td",{style:{textAlign:"center"},children:s.jsx("button",{type:"button",onClick:()=>te(P.id),style:{padding:"0.25rem 0.5rem",backgroundColor:"#e74c3c",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.875rem"},children:"Hapus"})})]},P.id)),s.jsxs("tr",{className:"shu-total-row",children:[s.jsx("td",{children:"Total"}),s.jsxs("td",{className:"percentage-cell",children:[S.reduce((P,D)=>P+parseFloat(D.pct||0),0).toFixed(2),"%"]}),s.jsx("td",{className:"amount-cell",children:se(S.reduce((P,D)=>P+parseFloat(D.amount||0),0))}),s.jsx("td",{})]})]})]}),(()=>{const P=S.reduce((q,Z)=>q+parseFloat(Z.pct||0),0);return!(Math.abs(P-100)<.01)&&s.jsxs("div",{className:"shu-percentage-warning",children:["Peringatan: Total persentase harus 100%. Saat ini: ",P.toFixed(2),"%"]})})(),s.jsxs("div",{style:{marginTop:"1rem",display:"flex",gap:"0.5rem"},children:[s.jsx("button",{type:"button",className:"shu-btn shu-btn-secondary",onClick:M,children:"+ Tambah Alokasi"}),s.jsx("button",{type:"button",className:"shu-btn shu-btn-success",onClick:F,children:"Simpan Perubahan"}),s.jsx("button",{type:"button",className:"shu-btn shu-btn-secondary",onClick:$,children:"Batal"})]})]}):s.jsxs("table",{className:"shu-allocations-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Jenis Alokasi"}),s.jsx("th",{className:"percentage-cell",children:"Persentase"}),s.jsx("th",{className:"amount-cell",children:"Jumlah"})]})}),s.jsxs("tbody",{children:[c.map((P,D)=>s.jsxs("tr",{children:[s.jsx("td",{children:P.label}),s.jsxs("td",{className:"percentage-cell",children:[P.pct,"%"]}),s.jsx("td",{className:"amount-cell",children:se(P.amount)})]},D)),s.jsxs("tr",{className:"shu-total-row",children:[s.jsx("td",{children:"Total"}),s.jsxs("td",{className:"percentage-cell",children:[G(),"%"]}),s.jsx("td",{className:"amount-cell",children:se(K())})]})]})]})]}),s.jsxs("div",{className:"shu-btn-group",children:[s.jsx("button",{type:"submit",className:"shu-btn shu-btn-primary",children:"Simpan Perhitungan"}),s.jsx("button",{type:"button",className:"shu-btn shu-btn-secondary",onClick:()=>{var P;l({cooperative_id:((P=e[0])==null?void 0:P.id)||"",period_year:new Date().getFullYear(),gross_shu:0,notes:""}),u([]),p(null)},children:"Reset"})]})]})]}),s.jsx("div",{className:"shu-calculations-list",children:s.jsxs("div",{className:"shu-calculation-card",children:[s.jsx("h2",{children:"Riwayat Perhitungan SHU"}),s.jsxs("table",{className:"shu-calculations-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Tahun"}),s.jsx("th",{children:"Koperasi"}),s.jsx("th",{children:"SHU Kotor"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Tanggal"})]})}),s.jsx("tbody",{children:r.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"5",style:{textAlign:"center",padding:"2rem"},children:"Belum ada perhitungan SHU"})}):r.map(P=>{var D;return s.jsxs("tr",{onClick:()=>me(P),children:[s.jsx("td",{children:P.period_year}),s.jsx("td",{children:(D=P.cooperatives)==null?void 0:D.name}),s.jsx("td",{children:se(P.gross_shu)}),s.jsx("td",{children:s.jsx("span",{className:`shu-status-badge shu-status-${P.status}`,children:P.status==="draft"?"Draft":P.status==="calculated"?"Dihitung":"Didistribusi"})}),s.jsx("td",{children:new Date(P.calculation_date).toLocaleDateString("id-ID")})]},P.id)})})]})]})})]})]})}function k_(){const[e,t]=v.useState([]),[r,n]=v.useState(null),[a,i]=v.useState([]),[o,l]=v.useState([]),[c,u]=v.useState(!0),[d,p]=v.useState(!1),[h,_]=v.useState(""),[y,j]=v.useState("");v.useEffect(()=>{w()},[]);const w=async()=>{try{const{data:S,error:B}=await U.from("shu_calculations").select(`
          *,
          cooperatives (name)
        `).order("period_year",{ascending:!1});if(B)throw B;t(S||[])}catch(S){console.error("Error loading calculations:",S),_("Gagal memuat data perhitungan SHU")}finally{u(!1)}},m=async S=>{if(!S){n(null),i([]),l([]);return}try{const B=e.find(V=>V.id===S);n(B);const{data:H,error:J}=await U.from("shu_member_distributions").select(`
          *,
          members (full_name)
        `).eq("shu_calculation_id",S);if(J)throw J;H&&H.length>0?i(H):i([]),await f(B)}catch(B){console.error("Error loading distribution:",B),_("Gagal memuat data distribusi")}},f=async S=>{try{const{data:B,error:H}=await U.from("shu_member_calculation_data").select("*").eq("cooperative_id",S.cooperative_id).eq("year",S.period_year);if(H)throw H;l(B||[])}catch(B){console.error("Error loading member data:",B),_("Gagal memuat data anggota")}},g=async()=>{if(!r||o.length===0){_("Data tidak lengkap untuk melakukan perhitungan");return}p(!0),_(""),j("");try{const{data:S,error:B}=await U.from("shu_allocations").select("*").eq("shu_calculation_id",r.id);if(B)throw B;const H=S.find(M=>M.allocation_type==="jasa_modal"),J=S.find(M=>M.allocation_type==="jasa_usaha");if(!H||!J){_("Data alokasi tidak lengkap");return}const V=o.reduce((M,Q)=>M+parseFloat(Q.total_simpanan_pokok_wajib||0),0),Y=o.reduce((M,Q)=>M+parseFloat(Q.total_loans||0),0),ue=o.map(M=>{const Q=parseFloat(M.total_simpanan_pokok_wajib||0),te=parseFloat(M.total_loans||0),oe=V>0?Q/V*H.amount:0,me=Y>0?te/Y*J.amount:0;return{shu_calculation_id:r.id,member_id:M.member_id,jasa_modal:oe,jasa_usaha:me,total_distribution:oe+me,payment_status:"pending"}}),{data:O,error:$}=await U.from("shu_member_distributions").upsert(ue,{onConflict:"shu_calculation_id,member_id"}).select(`
          *,
          members (full_name)
        `);if($)throw $;i(O),j("Distribusi SHU berhasil dihitung");const{error:F}=await U.from("shu_calculations").update({status:"calculated"}).eq("id",r.id);if(F)throw F;await w()}catch(S){console.error("Error calculating distributions:",S),_("Gagal menghitung distribusi: "+S.message)}finally{p(!1)}},b=async S=>{try{const{error:B}=await U.from("shu_member_distributions").update({payment_status:"paid",payment_date:new Date().toISOString().split("T")[0]}).eq("id",S);if(B)throw B;i(a.map(H=>H.id===S?{...H,payment_status:"paid",payment_date:new Date().toISOString().split("T")[0]}:H)),j("Status pembayaran berhasil diperbarui")}catch(B){console.error("Error updating payment status:",B),_("Gagal memperbarui status pembayaran")}},L=async()=>{try{const S=a.filter(J=>J.payment_status==="pending").map(J=>J.id);if(S.length===0){_("Tidak ada distribusi yang perlu dibayar");return}const{error:B}=await U.from("shu_member_distributions").update({payment_status:"paid",payment_date:new Date().toISOString().split("T")[0]}).in("id",S);if(B)throw B;i(a.map(J=>({...J,payment_status:"paid",payment_date:new Date().toISOString().split("T")[0]})));const{error:H}=await U.from("shu_calculations").update({status:"distributed"}).eq("id",r.id);if(H)throw H;j("Semua distribusi berhasil ditandai sebagai dibayar"),await w()}catch(S){console.error("Error marking all as paid:",S),_("Gagal memperbarui status pembayaran")}},A=S=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(S),k=()=>a.reduce((S,B)=>S+parseFloat(B.total_distribution||0),0),N=()=>a.reduce((S,B)=>S+parseFloat(B.jasa_modal||0),0),R=()=>a.reduce((S,B)=>S+parseFloat(B.jasa_usaha||0),0);return c?s.jsx("div",{className:"shu-distribution-page shu-loading",children:"Memuat data..."}):s.jsxs("div",{className:"shu-distribution-page",children:[s.jsx("div",{className:"shu-distribution-header",children:s.jsx("h1",{children:"Distribusi SHU Anggota"})}),h&&s.jsx("div",{className:"shu-error",children:h}),y&&s.jsx("div",{className:"shu-success",children:y}),s.jsx("div",{className:"shu-distribution-content",children:s.jsxs("div",{className:"shu-distribution-card",children:[s.jsx("h2",{children:"Pilih Perhitungan SHU"}),s.jsxs("div",{className:"shu-calculation-selector",children:[s.jsxs("select",{value:(r==null?void 0:r.id)||"",onChange:S=>m(S.target.value),children:[s.jsx("option",{value:"",children:"Pilih Perhitungan SHU"}),e.map(S=>{var B;return s.jsxs("option",{value:S.id,children:[S.period_year," - ",(B=S.cooperatives)==null?void 0:B.name," - ",A(S.gross_shu)]},S.id)})]}),r&&a.length===0&&o.length>0&&s.jsx("button",{className:"shu-btn shu-btn-primary",onClick:g,disabled:d,children:d?"Menghitung...":"Hitung Distribusi"}),r&&a.length>0&&s.jsx("button",{className:"shu-btn shu-btn-success",onClick:L,children:"Tandai Semua Dibayar"})]}),r&&a.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"shu-summary-grid",children:[s.jsxs("div",{className:"shu-summary-item",children:[s.jsx("div",{className:"label",children:"Total Jasa Modal"}),s.jsx("div",{className:"value",children:A(N())})]}),s.jsxs("div",{className:"shu-summary-item",children:[s.jsx("div",{className:"label",children:"Total Jasa Usaha"}),s.jsx("div",{className:"value",children:A(R())})]}),s.jsxs("div",{className:"shu-summary-item",children:[s.jsx("div",{className:"label",children:"Total Distribusi"}),s.jsx("div",{className:"value",children:A(k())})]}),s.jsxs("div",{className:"shu-summary-item",children:[s.jsx("div",{className:"label",children:"Jumlah Anggota"}),s.jsx("div",{className:"value",children:a.length})]})]}),s.jsx("h3",{style:{marginTop:"2rem",marginBottom:"1rem"},children:"Detail Distribusi Per Anggota"}),s.jsxs("table",{className:"shu-distribution-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Nama Anggota"}),s.jsx("th",{className:"amount-cell",children:"Jasa Modal"}),s.jsx("th",{className:"amount-cell",children:"Jasa Usaha"}),s.jsx("th",{className:"amount-cell",children:"Total"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Aksi"})]})}),s.jsx("tbody",{children:a.map(S=>{var B;return s.jsxs("tr",{children:[s.jsx("td",{children:(B=S.members)==null?void 0:B.full_name}),s.jsx("td",{className:"amount-cell",children:A(S.jasa_modal)}),s.jsx("td",{className:"amount-cell",children:A(S.jasa_usaha)}),s.jsx("td",{className:"amount-cell total-cell",children:A(S.total_distribution)}),s.jsx("td",{children:s.jsx("span",{className:`shu-payment-status shu-payment-${S.payment_status}`,children:S.payment_status==="pending"?"Belum Dibayar":"Dibayar"})}),s.jsxs("td",{children:[S.payment_status==="pending"&&s.jsx("button",{className:"shu-btn shu-btn-success shu-btn-small",onClick:()=>b(S.id),children:"Bayar"}),S.payment_status==="paid"&&S.payment_date&&s.jsx("span",{style:{fontSize:"0.85rem",color:"#7f8c8d"},children:new Date(S.payment_date).toLocaleDateString("id-ID")})]})]},S.id)})})]})]}),r&&a.length===0&&o.length===0&&s.jsx("div",{className:"shu-empty-state",children:s.jsx("p",{children:"Tidak ada data anggota untuk periode ini"})}),!r&&s.jsx("div",{className:"shu-empty-state",children:s.jsx("p",{children:"Silakan pilih perhitungan SHU untuk melihat distribusi"})})]})})]})}function E_(){const[e,t]=v.useState("income"),[r,n]=v.useState(!1),[a,i]=v.useState(null),[o,l]=v.useState(""),[c,u]=v.useState([]),[d,p]=v.useState(""),h=new Date().toISOString().split("T")[0],_=new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0],[y,j]=v.useState(_),[w,m]=v.useState(h),[f,g]=v.useState(null),[b,L]=v.useState(null),[A,k]=v.useState(null);v.useEffect(()=>{N()},[]);const N=async()=>{try{const{data:{user:O}}=await U.auth.getUser();if(!O)return;const{data:$}=await U.from("user_roles").select("role").eq("user_id",O.id).maybeSingle(),F=($==null?void 0:$.role)||"member";p(F);const{data:M}=await U.from("role_permissions").select("*").eq("role",F).eq("menu","reports").maybeSingle();i(M);let Q=U.from("cooperatives").select("id, name").eq("status","active").order("name");if(F!=="super_admin"){const{data:me}=await U.from("user_access_info").select("cooperative_ids").eq("user_id",O.id).maybeSingle();if(me!=null&&me.cooperative_ids&&me.cooperative_ids.length>0)Q=Q.in("id",me.cooperative_ids);else{u([]);return}}const{data:te,error:oe}=await Q;if(oe)throw oe;u(te||[]),te&&te.length>0&&l(te[0].id)}catch(O){console.error("Error loading access:",O)}},R=O=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(O||0),S=async()=>{n(!0);try{const{data:O}=await U.from("loan_payments").select(`
          interest_amount,
          payment_date,
          loan_id (
            member_id (
              cooperative_id
            )
          )
        `).gte("payment_date",y).lte("payment_date",w),{data:$}=await U.from("loans").select("amount, interest_rate, duration_months, disbursement_date, member_id(cooperative_id)").eq("status","active").gte("disbursement_date",y).lte("disbursement_date",w),{data:F}=await U.from("operational_journal").select("*").gte("transaction_date",y).lte("transaction_date",w);let M=O,Q=$,te=F;o&&(M=O==null?void 0:O.filter(D=>{var q,Z;return((Z=(q=D.loan_id)==null?void 0:q.member_id)==null?void 0:Z.cooperative_id)===o}),Q=$==null?void 0:$.filter(D=>{var q;return((q=D.member_id)==null?void 0:q.cooperative_id)===o}),te=F==null?void 0:F.filter(D=>D.cooperative_id===o));const oe=(M==null?void 0:M.reduce((D,q)=>D+parseFloat(q.interest_amount||0),0))||0,me=(te==null?void 0:te.filter(D=>D.transaction_type==="credit").reduce((D,q)=>D+parseFloat(q.amount||0),0))||0,se=oe+me,K=(te==null?void 0:te.filter(D=>D.transaction_type==="debit").reduce((D,q)=>D+parseFloat(q.amount||0),0))||0,G=K,P=se-G;g({revenue:{interestIncome:oe,otherIncome:me,total:se},expenses:{operating:K,total:G},netIncome:P})}catch(O){console.error("Error loading income statement:",O)}finally{n(!1)}},B=async()=>{n(!0);try{const{data:O}=await U.from("savings").select("amount, member_id(cooperative_id)").lte("transaction_date",w),{data:$}=await U.from("loans").select("amount, member_id(cooperative_id)").in("status",["active","disbursed"]),{data:F}=await U.from("loan_payments").select(`
          principal_amount,
          loan_id (
            member_id (
              cooperative_id
            )
          )
        `).lte("payment_date",w);let M=O,Q=$,te=F;o&&(M=O==null?void 0:O.filter(Z=>{var C;return((C=Z.member_id)==null?void 0:C.cooperative_id)===o}),Q=$==null?void 0:$.filter(Z=>{var C;return((C=Z.member_id)==null?void 0:C.cooperative_id)===o}),te=F==null?void 0:F.filter(Z=>{var C,I;return((I=(C=Z.loan_id)==null?void 0:C.member_id)==null?void 0:I.cooperative_id)===o}));const oe=(M==null?void 0:M.reduce((Z,C)=>Z+parseFloat(C.amount||0),0))||0,me=(Q==null?void 0:Q.reduce((Z,C)=>Z+parseFloat(C.amount||0),0))||0,se=(te==null?void 0:te.reduce((Z,C)=>Z+parseFloat(C.principal_amount||0),0))||0,K=me-se,G=oe*.2,P=G+K,D=oe,q=P-D;L({assets:{cash:G,receivables:K,total:P},liabilities:{deposits:oe,total:D},equity:{capital:q,total:q}})}catch(O){console.error("Error loading balance sheet:",O)}finally{n(!1)}},H=async()=>{n(!0);try{const{data:O}=await U.from("savings").select("amount, transaction_date, member_id(cooperative_id)").gte("transaction_date",y).lte("transaction_date",w),{data:$}=await U.from("loans").select("amount, disbursement_date, member_id(cooperative_id)").gte("disbursement_date",y).lte("disbursement_date",w),{data:F}=await U.from("loan_payments").select(`
          amount,
          payment_date,
          loan_id (
            member_id (
              cooperative_id
            )
          )
        `).gte("payment_date",y).lte("payment_date",w);let M=O,Q=$,te=F;o&&(M=O==null?void 0:O.filter(D=>{var q;return((q=D.member_id)==null?void 0:q.cooperative_id)===o}),Q=$==null?void 0:$.filter(D=>{var q;return((q=D.member_id)==null?void 0:q.cooperative_id)===o}),te=F==null?void 0:F.filter(D=>{var q,Z;return((Z=(q=D.loan_id)==null?void 0:q.member_id)==null?void 0:Z.cooperative_id)===o}));const oe=(M==null?void 0:M.reduce((D,q)=>D+parseFloat(q.amount||0),0))||0,me=(te==null?void 0:te.reduce((D,q)=>D+parseFloat(q.amount||0),0))||0,se=oe+me,K=(Q==null?void 0:Q.reduce((D,q)=>D+parseFloat(q.amount||0),0))||0,G=K,P=se-G;k({cashIn:{savings:oe,payments:me,total:se},cashOut:{loans:K,total:G},netCashFlow:P})}catch(O){console.error("Error loading cash flow:",O)}finally{n(!1)}},J=()=>{e==="income"?S():e==="balance"?B():e==="cashflow"&&H()},V=()=>{window.print()},Y=()=>{let O="",$="";const F=ue();e==="income"&&f?($=`Laporan_Laba_Rugi_${y}_to_${w}.csv`,O=`Laporan Laba Rugi
${F}
Periode: ${y} - ${w}

`,O+=`Keterangan,Jumlah
`,O+=`
PENDAPATAN
`,O+=`Pendapatan Bunga Pinjaman,${f.revenue.interestIncome}
`,O+=`Pendapatan Lain-lain,${f.revenue.otherIncome}
`,O+=`Total Pendapatan,${f.revenue.total}
`,O+=`
BEBAN
`,O+=`Beban Operasional,${f.expenses.operating}
`,O+=`Total Beban,${f.expenses.total}
`,O+=`
LABA BERSIH (SHU),${f.netIncome}
`):e==="balance"&&b?($=`Neraca_${w}.csv`,O=`Neraca
${F}
Per Tanggal: ${w}

`,O+=`Keterangan,Jumlah
`,O+=`
ASET
`,O+=`Kas dan Setara Kas,${b.assets.cash}
`,O+=`Piutang Pinjaman,${b.assets.receivables}
`,O+=`Total Aset,${b.assets.total}
`,O+=`
KEWAJIBAN
`,O+=`Simpanan Anggota,${b.liabilities.deposits}
`,O+=`Total Kewajiban,${b.liabilities.total}
`,O+=`
EKUITAS
`,O+=`Modal Koperasi,${b.equity.capital}
`,O+=`Total Ekuitas,${b.equity.total}
`,O+=`
TOTAL KEWAJIBAN DAN EKUITAS,${b.liabilities.total+b.equity.total}
`):e==="cashflow"&&A&&($=`Laporan_Arus_Kas_${y}_to_${w}.csv`,O=`Laporan Arus Kas
${F}
Periode: ${y} - ${w}

`,O+=`Keterangan,Jumlah
`,O+=`
KAS MASUK
`,O+=`Penerimaan dari Simpanan,${A.cashIn.savings}
`,O+=`Penerimaan Angsuran Pinjaman,${A.cashIn.payments}
`,O+=`Total Kas Masuk,${A.cashIn.total}
`,O+=`
KAS KELUAR
`,O+=`Pencairan Pinjaman,${A.cashOut.loans}
`,O+=`Total Kas Keluar,${A.cashOut.total}
`,O+=`
PERUBAHAN KAS BERSIH,${A.netCashFlow}
`);const M=new Blob([O],{type:"text/csv;charset=utf-8;"}),Q=document.createElement("a"),te=URL.createObjectURL(M);Q.setAttribute("href",te),Q.setAttribute("download",$),Q.style.visibility="hidden",document.body.appendChild(Q),Q.click(),document.body.removeChild(Q)};if(!(a!=null&&a.can_view))return s.jsx("div",{className:"reports-container",children:s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-state-icon",children:""}),s.jsx("p",{children:"Akses Ditolak"}),s.jsx("small",{children:"Anda tidak memiliki izin untuk melihat laporan"})]})});const ue=()=>{const O=c.find($=>$.id===o);return(O==null?void 0:O.name)||""};return s.jsxs("div",{className:"reports-container",children:[s.jsxs("div",{className:"reports-header",children:[s.jsx("h1",{children:"Laporan Keuangan"}),s.jsx("p",{children:"Laporan keuangan dan analisis koperasi"})]}),s.jsxs("div",{className:"reports-tabs",children:[s.jsx("button",{className:`tab-button ${e==="income"?"active":""}`,onClick:()=>t("income"),children:" Laporan Laba Rugi"}),s.jsx("button",{className:`tab-button ${e==="balance"?"active":""}`,onClick:()=>t("balance"),children:" Neraca"}),s.jsx("button",{className:`tab-button ${e==="cashflow"?"active":""}`,onClick:()=>t("cashflow"),children:" Arus Kas"}),s.jsx("button",{className:`tab-button ${e==="shu-calculation"?"active":""}`,onClick:()=>t("shu-calculation"),children:" Perhitungan SHU"}),s.jsx("button",{className:`tab-button ${e==="shu-distribution"?"active":""}`,onClick:()=>t("shu-distribution"),children:" Distribusi SHU"})]}),e==="shu-calculation"||e==="shu-distribution"?s.jsxs(s.Fragment,{children:[e==="shu-calculation"&&s.jsx(S_,{}),e==="shu-distribution"&&s.jsx(k_,{})]}):s.jsxs("div",{className:"report-section",children:[s.jsxs("div",{className:"report-filters",children:[s.jsxs("div",{className:"filter-group",children:[s.jsxs("label",{children:["Koperasi ",s.jsx("span",{className:"required",children:"*"})]}),s.jsxs("select",{value:o,onChange:O=>l(O.target.value),required:!0,children:[s.jsx("option",{value:"",children:"Pilih Koperasi"}),c.map(O=>s.jsx("option",{value:O.id,children:O.name},O.id))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Dari Tanggal"}),s.jsx("input",{type:"date",value:y,onChange:O=>j(O.target.value)})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Sampai Tanggal"}),s.jsx("input",{type:"date",value:w,onChange:O=>m(O.target.value)})]}),s.jsxs("div",{className:"report-action-buttons",children:[s.jsx("button",{className:"filter-button",onClick:J,disabled:r||!o||!y||!w,children:r?"Memuat...":" Generate Laporan"}),(e==="income"&&f||e==="balance"&&b||e==="cashflow"&&A)&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:"export-button",onClick:V,children:[s.jsx("span",{style:{fontSize:"1.2rem"},children:""}),s.jsx("span",{children:"Print"})]}),s.jsxs("button",{className:"export-button",onClick:Y,style:{background:"#10b981"},children:[s.jsx("span",{style:{fontSize:"1.2rem"},children:""}),s.jsx("span",{children:"Export"})]})]})]})]}),e==="income"&&s.jsx(N_,{data:f,formatCurrency:R,cooperativeName:ue(),dateFrom:y,dateTo:w}),e==="balance"&&s.jsx(C_,{data:b,formatCurrency:R,cooperativeName:ue(),dateFrom:y,dateTo:w}),e==="cashflow"&&s.jsx(T_,{data:A,formatCurrency:R,cooperativeName:ue(),dateFrom:y,dateTo:w})]})]})}function N_({data:e,formatCurrency:t,cooperativeName:r,dateFrom:n,dateTo:a}){if(!e)return s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-state-icon",children:""}),s.jsx("p",{children:"Belum ada data laporan"}),s.jsx("small",{children:"Pilih koperasi, periode, dan klik Generate Laporan"})]});const i=o=>new Date(o).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"});return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"report-info-header",children:[s.jsx("h3",{children:r}),s.jsxs("p",{children:["Periode: ",i(n)," - ",i(a)]})]}),s.jsxs("div",{className:"report-summary",children:[s.jsxs("div",{className:"summary-card positive",children:[s.jsx("h3",{children:"Total Pendapatan"}),s.jsx("div",{className:"amount",children:t(e.revenue.total)}),s.jsx("div",{className:"sub-info",children:"Pendapatan usaha periode ini"})]}),s.jsxs("div",{className:"summary-card negative",children:[s.jsx("h3",{children:"Total Beban"}),s.jsx("div",{className:"amount",children:t(e.expenses.total)}),s.jsx("div",{className:"sub-info",children:"Beban operasional"})]}),s.jsxs("div",{className:"summary-card neutral",children:[s.jsx("h3",{children:"Laba Bersih"}),s.jsx("div",{className:"amount",children:t(e.netIncome)}),s.jsx("div",{className:"sub-info",children:"Sisa Hasil Usaha (SHU)"})]})]}),s.jsx("div",{className:"report-table-container",children:s.jsxs("table",{className:"report-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Keterangan"}),s.jsx("th",{className:"text-right",children:"Jumlah"})]})}),s.jsxs("tbody",{children:[s.jsx("tr",{className:"category-header",children:s.jsx("td",{colSpan:"2",children:"PENDAPATAN"})}),s.jsxs("tr",{children:[s.jsx("td",{children:"Pendapatan Bunga Pinjaman"}),s.jsx("td",{className:"text-right",children:t(e.revenue.interestIncome)})]}),s.jsxs("tr",{children:[s.jsx("td",{children:"Pendapatan Lain-lain"}),s.jsx("td",{className:"text-right",children:t(e.revenue.otherIncome)})]}),s.jsxs("tr",{className:"subtotal",children:[s.jsx("td",{children:"Total Pendapatan"}),s.jsx("td",{className:"text-right",children:t(e.revenue.total)})]}),s.jsx("tr",{className:"category-header",children:s.jsx("td",{colSpan:"2",children:"BEBAN"})}),s.jsxs("tr",{children:[s.jsx("td",{children:"Beban Operasional"}),s.jsx("td",{className:"text-right",children:t(e.expenses.operating)})]}),s.jsxs("tr",{className:"subtotal",children:[s.jsx("td",{children:"Total Beban"}),s.jsx("td",{className:"text-right",children:t(e.expenses.total)})]}),s.jsxs("tr",{className:"total",children:[s.jsx("td",{children:"LABA BERSIH (SHU)"}),s.jsx("td",{className:"text-right",children:t(e.netIncome)})]})]})]})})]})}function C_({data:e,formatCurrency:t,cooperativeName:r,dateFrom:n,dateTo:a}){if(!e)return s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-state-icon",children:""}),s.jsx("p",{children:"Belum ada data laporan"}),s.jsx("small",{children:"Pilih koperasi, periode, dan klik Generate Laporan"})]});const i=o=>new Date(o).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"});return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"report-info-header",children:[s.jsx("h3",{children:r}),s.jsxs("p",{children:["Per Tanggal: ",i(a)]})]}),s.jsxs("div",{className:"report-summary",children:[s.jsxs("div",{className:"summary-card positive",children:[s.jsx("h3",{children:"Total Aset"}),s.jsx("div",{className:"amount",children:t(e.assets.total)}),s.jsx("div",{className:"sub-info",children:"Kas dan piutang pinjaman"})]}),s.jsxs("div",{className:"summary-card negative",children:[s.jsx("h3",{children:"Total Kewajiban"}),s.jsx("div",{className:"amount",children:t(e.liabilities.total)}),s.jsx("div",{className:"sub-info",children:"Simpanan anggota"})]}),s.jsxs("div",{className:"summary-card neutral",children:[s.jsx("h3",{children:"Total Ekuitas"}),s.jsx("div",{className:"amount",children:t(e.equity.total)}),s.jsx("div",{className:"sub-info",children:"Modal koperasi"})]})]}),s.jsx("div",{className:"report-table-container",children:s.jsxs("table",{className:"report-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Keterangan"}),s.jsx("th",{className:"text-right",children:"Jumlah"})]})}),s.jsxs("tbody",{children:[s.jsx("tr",{className:"category-header",children:s.jsx("td",{colSpan:"2",children:"ASET"})}),s.jsxs("tr",{children:[s.jsx("td",{children:"Kas dan Setara Kas"}),s.jsx("td",{className:"text-right",children:t(e.assets.cash)})]}),s.jsxs("tr",{children:[s.jsx("td",{children:"Piutang Pinjaman"}),s.jsx("td",{className:"text-right",children:t(e.assets.receivables)})]}),s.jsxs("tr",{className:"subtotal",children:[s.jsx("td",{children:"Total Aset"}),s.jsx("td",{className:"text-right",children:t(e.assets.total)})]}),s.jsx("tr",{className:"category-header",children:s.jsx("td",{colSpan:"2",children:"KEWAJIBAN"})}),s.jsxs("tr",{children:[s.jsx("td",{children:"Simpanan Anggota"}),s.jsx("td",{className:"text-right",children:t(e.liabilities.deposits)})]}),s.jsxs("tr",{className:"subtotal",children:[s.jsx("td",{children:"Total Kewajiban"}),s.jsx("td",{className:"text-right",children:t(e.liabilities.total)})]}),s.jsx("tr",{className:"category-header",children:s.jsx("td",{colSpan:"2",children:"EKUITAS"})}),s.jsxs("tr",{children:[s.jsx("td",{children:"Modal Koperasi"}),s.jsx("td",{className:"text-right",children:t(e.equity.capital)})]}),s.jsxs("tr",{className:"subtotal",children:[s.jsx("td",{children:"Total Ekuitas"}),s.jsx("td",{className:"text-right",children:t(e.equity.total)})]}),s.jsxs("tr",{className:"total",children:[s.jsx("td",{children:"TOTAL KEWAJIBAN DAN EKUITAS"}),s.jsx("td",{className:"text-right",children:t(e.liabilities.total+e.equity.total)})]})]})]})})]})}function T_({data:e,formatCurrency:t,cooperativeName:r,dateFrom:n,dateTo:a}){if(!e)return s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-state-icon",children:""}),s.jsx("p",{children:"Belum ada data laporan"}),s.jsx("small",{children:"Pilih koperasi, periode, dan klik Generate Laporan"})]});const i=o=>new Date(o).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"});return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"report-info-header",children:[s.jsx("h3",{children:r}),s.jsxs("p",{children:["Periode: ",i(n)," - ",i(a)]})]}),s.jsxs("div",{className:"report-summary",children:[s.jsxs("div",{className:"summary-card positive",children:[s.jsx("h3",{children:"Total Kas Masuk"}),s.jsx("div",{className:"amount",children:t(e.cashIn.total)}),s.jsx("div",{className:"sub-info",children:"Simpanan dan pembayaran"})]}),s.jsxs("div",{className:"summary-card negative",children:[s.jsx("h3",{children:"Total Kas Keluar"}),s.jsx("div",{className:"amount",children:t(e.cashOut.total)}),s.jsx("div",{className:"sub-info",children:"Pencairan pinjaman"})]}),s.jsxs("div",{className:"summary-card neutral",children:[s.jsx("h3",{children:"Kas Bersih"}),s.jsx("div",{className:"amount",children:t(e.netCashFlow)}),s.jsx("div",{className:"sub-info",children:"Perubahan kas periode ini"})]})]}),s.jsx("div",{className:"report-table-container",children:s.jsxs("table",{className:"report-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Keterangan"}),s.jsx("th",{className:"text-right",children:"Jumlah"})]})}),s.jsxs("tbody",{children:[s.jsx("tr",{className:"category-header",children:s.jsx("td",{colSpan:"2",children:"KAS MASUK"})}),s.jsxs("tr",{children:[s.jsx("td",{children:"Penerimaan dari Simpanan"}),s.jsx("td",{className:"text-right",children:t(e.cashIn.savings)})]}),s.jsxs("tr",{children:[s.jsx("td",{children:"Penerimaan Angsuran Pinjaman"}),s.jsx("td",{className:"text-right",children:t(e.cashIn.payments)})]}),s.jsxs("tr",{className:"subtotal",children:[s.jsx("td",{children:"Total Kas Masuk"}),s.jsx("td",{className:"text-right",children:t(e.cashIn.total)})]}),s.jsx("tr",{className:"category-header",children:s.jsx("td",{colSpan:"2",children:"KAS KELUAR"})}),s.jsxs("tr",{children:[s.jsx("td",{children:"Pencairan Pinjaman"}),s.jsx("td",{className:"text-right",children:t(e.cashOut.loans)})]}),s.jsxs("tr",{className:"subtotal",children:[s.jsx("td",{children:"Total Kas Keluar"}),s.jsx("td",{className:"text-right",children:t(e.cashOut.total)})]}),s.jsxs("tr",{className:"total",children:[s.jsx("td",{children:"PERUBAHAN KAS BERSIH"}),s.jsx("td",{className:"text-right",children:t(e.netCashFlow)})]})]})]})})]})}function P_(){const[e,t]=v.useState([]),[r,n]=v.useState([]),[a,i]=v.useState(!0),[o,l]=v.useState(!1),[c,u]=v.useState(null),[d,p]=v.useState([]),[h,_]=v.useState(null),[y,j]=v.useState(!1),[w,m]=v.useState(1),[f,g]=v.useState("transaction_date"),[b,L]=v.useState("desc"),A=10,[k,N]=v.useState({cooperative_id:"",transaction_date:new Date().toISOString().split("T")[0],category:"",description:"",transaction_type:"",amount:"",reference_number:"",notes:""}),[R,S]=v.useState({startDate:"",endDate:"",cooperative_id:"",category:"",transaction_type:""});v.useEffect(()=>{B(),H()},[]),v.useEffect(()=>{J()},[e,R]);const B=async()=>{try{const C=await qt();if(_(C.role),!qe(C)&&C.cooperativeIds.length===0){t([]),i(!1);return}let I=U.from("operational_journal").select(`
          *,
          cooperatives (name)
        `);qe(C)||(I=I.in("cooperative_id",C.cooperativeIds));const{data:ie,error:ae}=await I.order("transaction_date",{ascending:!1});if(ae)throw ae;t(ie||[])}catch(C){console.error("Error loading journals:",C)}finally{i(!1)}},H=async()=>{try{const C=await qt();let I=U.from("cooperatives").select("id, name").eq("status","active");qe(C)||(I=I.in("id",C.cooperativeIds));const{data:ie,error:ae}=await I.order("name");if(ae)throw ae;p(ie||[])}catch(C){console.error("Error loading cooperatives:",C)}},J=()=>{let C=[...e];if(R.startDate&&(C=C.filter(I=>new Date(I.transaction_date)>=new Date(R.startDate))),R.endDate){const I=new Date(R.endDate);I.setHours(23,59,59,999),C=C.filter(ie=>new Date(ie.transaction_date)<=I)}R.cooperative_id&&(C=C.filter(I=>I.cooperative_id===R.cooperative_id)),R.category&&(C=C.filter(I=>I.category===R.category)),R.transaction_type&&(C=C.filter(I=>I.transaction_type===R.transaction_type)),n(C),m(1)},V=()=>{S({startDate:"",endDate:"",cooperative_id:"",category:"",transaction_type:""})},Y=C=>{S({...R,[C.target.name]:C.target.value})},ue=()=>{const C=r.filter(fe=>fe.transaction_type==="debit").reduce((fe,je)=>fe+(je.amount||0),0),I=r.filter(fe=>fe.transaction_type==="credit").reduce((fe,je)=>fe+(je.amount||0),0),ie=r.length,ae={};return r.forEach(fe=>{ae[fe.category]||(ae[fe.category]={count:0,total:0}),ae[fe.category].count++,ae[fe.category].total+=fe.amount}),{debitTotal:C,creditTotal:I,balance:I-C,count:ie,byCategory:ae}},O=()=>{if(r.length===0){alert("Tidak ada data untuk di-export");return}const C=["No","Tanggal","Koperasi","Kategori","Deskripsi","Tipe","Jumlah","No. Referensi"],I=r.map((je,pt)=>{var be;return[pt+1,new Date(je.transaction_date).toLocaleDateString("id-ID"),((be=je.cooperatives)==null?void 0:be.name)||"-",je.category,je.description,je.transaction_type,je.amount,je.reference_number||"-"]}),ie=[C.join(","),...I.map(je=>je.join(","))].join(`
`),ae=new Blob([ie],{type:"text/csv;charset=utf-8;"}),fe=document.createElement("a");fe.href=URL.createObjectURL(ae),fe.download=`laporan-jurnal-operasional-${new Date().toISOString().split("T")[0]}.csv`,fe.click()},$=()=>{if(r.length===0){alert("Tidak ada data untuk dicetak");return}const C=ue(),I=window.open("","","height=600,width=800");I.document.write("<html><head><title>Laporan Jurnal Operasional</title>"),I.document.write("<style>"),I.document.write("body { font-family: Arial, sans-serif; padding: 20px; }"),I.document.write("h1 { text-align: center; }"),I.document.write("table { width: 100%; border-collapse: collapse; margin-top: 20px; }"),I.document.write("th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }"),I.document.write("th { background-color: #f2f2f2; }"),I.document.write(".summary { margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 5px; }"),I.document.write(".summary-item { margin: 5px 0; }"),I.document.write(".debit { color: #d32f2f; }"),I.document.write(".credit { color: #388e3c; }"),I.document.write("</style></head><body>"),I.document.write("<h1>LAPORAN JURNAL OPERASIONAL</h1>"),I.document.write(`<p style="text-align: center;">Tanggal Cetak: ${new Date().toLocaleDateString("id-ID")}</p>`),I.document.write('<div class="summary">'),I.document.write("<h3>Ringkasan</h3>"),I.document.write(`<div class="summary-item">Total Transaksi: ${C.count}</div>`),I.document.write(`<div class="summary-item">Total Debit: Rp ${C.debitTotal.toLocaleString("id-ID")}</div>`),I.document.write(`<div class="summary-item">Total Kredit: Rp ${C.creditTotal.toLocaleString("id-ID")}</div>`),I.document.write(`<div class="summary-item">Saldo: Rp ${C.balance.toLocaleString("id-ID")}</div>`),I.document.write("</div>"),I.document.write("<table>"),I.document.write("<thead><tr><th>No</th><th>Tanggal</th><th>Kategori</th><th>Deskripsi</th><th>Tipe</th><th>Jumlah</th></tr></thead>"),I.document.write("<tbody>"),r.forEach((ie,ae)=>{I.document.write("<tr>"),I.document.write(`<td>${ae+1}</td>`),I.document.write(`<td>${new Date(ie.transaction_date).toLocaleDateString("id-ID")}</td>`),I.document.write(`<td style="text-transform: capitalize">${ie.category}</td>`),I.document.write(`<td>${ie.description}</td>`),I.document.write(`<td style="text-transform: uppercase">${ie.transaction_type}</td>`);const fe=ie.transaction_type==="debit"?"debit":"credit";I.document.write(`<td class="${fe}">Rp ${ie.amount.toLocaleString("id-ID")}</td>`),I.document.write("</tr>")}),I.document.write("</tbody></table>"),I.document.write("</body></html>"),I.document.close(),I.print()},F=()=>{u(null),N({cooperative_id:"",transaction_date:new Date().toISOString().split("T")[0],category:"",description:"",transaction_type:"",amount:"",reference_number:"",notes:""}),l(!0)},M=C=>{u(C),N({cooperative_id:C.cooperative_id,transaction_date:C.transaction_date,category:C.category,description:C.description,transaction_type:C.transaction_type,amount:C.amount,reference_number:C.reference_number||"",notes:C.notes||""}),l(!0)},Q=async C=>{if(confirm("Apakah Anda yakin ingin menghapus data jurnal ini?"))try{const{error:I}=await U.from("operational_journal").delete().eq("id",C);if(I)throw I;alert("Data jurnal berhasil dihapus"),B()}catch(I){console.error("Error deleting journal:",I),alert("Gagal menghapus data: "+I.message)}},te=async C=>{C.preventDefault();try{const{data:{user:I}}=await U.auth.getUser(),ie={cooperative_id:k.cooperative_id,transaction_date:k.transaction_date,category:k.category,description:k.description,transaction_type:k.transaction_type,amount:parseFloat(k.amount),reference_number:k.reference_number||null,notes:k.notes||null,created_by:I.id};if(c){const{error:ae}=await U.from("operational_journal").update(ie).eq("id",c.id);if(ae)throw ae;alert("Data jurnal berhasil diupdate")}else{const{error:ae}=await U.from("operational_journal").insert([ie]);if(ae)throw ae;alert("Jurnal berhasil ditambahkan")}l(!1),u(null),B()}catch(I){console.error("Error saving data:",I),alert("Gagal menyimpan data: "+I.message)}},oe=C=>{N({...k,[C.target.name]:C.target.value})},me=C=>{f===C?L(b==="asc"?"desc":"asc"):(g(C),L("asc"))},se=()=>[...r].sort((I,ie)=>{var je,pt;let ae=I[f],fe=ie[f];return f==="cooperative_name"&&(ae=((je=I.cooperatives)==null?void 0:je.name)||"",fe=((pt=ie.cooperatives)==null?void 0:pt.name)||""),typeof ae=="string"&&(ae=ae.toLowerCase(),fe=(fe==null?void 0:fe.toLowerCase())||""),ae<fe?b==="asc"?-1:1:ae>fe?b==="asc"?1:-1:0}),K=()=>{const C=se(),I=(w-1)*A,ie=I+A;return C.slice(I,ie)},G=Math.ceil(r.length/A),P=K(),D=C=>f!==C?" ":b==="asc"?" ":" ";if(a)return s.jsx("div",{className:"loading",children:"Loading journals..."});const q=ue(),Z=h==="super_admin"||h==="manager";return s.jsxs("div",{className:"journal-container",children:[s.jsxs("div",{className:"journal-header",children:[s.jsx("h1",{children:"Jurnal Operasional"}),s.jsxs("div",{className:"header-actions",children:[s.jsx("button",{className:"btn-filter",onClick:()=>j(!y),children:y?"Sembunyikan Filter":"Tampilkan Filter"}),Z&&s.jsx("button",{className:"btn-add",onClick:F,children:"+ Tambah Jurnal"})]})]}),s.jsxs("div",{className:"data-info",children:[s.jsxs("span",{children:["Total: ",s.jsx("strong",{children:r.length})," transaksi (dari ",e.length," total)"]}),s.jsxs("span",{children:["Halaman ",w," dari ",G||1]})]}),y&&s.jsxs("div",{className:"filter-section",children:[s.jsx("h3",{children:"Filter Data"}),s.jsxs("div",{className:"filter-form",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tanggal Mulai"}),s.jsx("input",{type:"date",name:"startDate",value:R.startDate,onChange:Y})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tanggal Akhir"}),s.jsx("input",{type:"date",name:"endDate",value:R.endDate,onChange:Y})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Koperasi"}),s.jsxs("select",{name:"cooperative_id",value:R.cooperative_id,onChange:Y,children:[s.jsx("option",{value:"",children:"Semua Koperasi"}),d.map(C=>s.jsx("option",{value:C.id,children:C.name},C.id))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Kategori"}),s.jsxs("select",{name:"category",value:R.category,onChange:Y,children:[s.jsx("option",{value:"",children:"Semua Kategori"}),s.jsx("option",{value:"operational_expense",children:"Biaya Operasional"}),s.jsx("option",{value:"other_income",children:"Pendapatan Lain"}),s.jsx("option",{value:"asset_purchase",children:"Pembelian Aset"}),s.jsx("option",{value:"other",children:"Lainnya"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tipe Transaksi"}),s.jsxs("select",{name:"transaction_type",value:R.transaction_type,onChange:Y,children:[s.jsx("option",{value:"",children:"Semua Tipe"}),s.jsx("option",{value:"debit",children:"Debit"}),s.jsx("option",{value:"credit",children:"Kredit"})]})]}),s.jsx("div",{className:"filter-group",children:s.jsx("button",{className:"btn-reset",onClick:V,children:"Reset Filter"})})]})]}),s.jsxs("div",{className:"statistics-section",children:[s.jsx("h3",{children:"Ringkasan"}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-label",children:"Total Transaksi"}),s.jsx("div",{className:"stat-value",children:q.count})]}),s.jsxs("div",{className:"stat-card debit-card",children:[s.jsx("div",{className:"stat-label",children:"Total Debit"}),s.jsxs("div",{className:"stat-value",children:["Rp ",q.debitTotal.toLocaleString("id-ID")]})]}),s.jsxs("div",{className:"stat-card credit-card",children:[s.jsx("div",{className:"stat-label",children:"Total Kredit"}),s.jsxs("div",{className:"stat-value",children:["Rp ",q.creditTotal.toLocaleString("id-ID")]})]}),s.jsxs("div",{className:"stat-card balance-card",children:[s.jsx("div",{className:"stat-label",children:"Saldo"}),s.jsxs("div",{className:"stat-value",children:["Rp ",q.balance.toLocaleString("id-ID")]})]})]})]}),s.jsxs("div",{className:"report-actions",children:[s.jsx("button",{className:"btn-export",onClick:O,children:"Export CSV"}),s.jsx("button",{className:"btn-print",onClick:$,children:"Cetak Laporan"})]}),s.jsx("div",{className:"journal-table",children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"No"}),s.jsxs("th",{onClick:()=>me("transaction_date"),style:{cursor:"pointer"},children:["Tanggal",D("transaction_date")]}),s.jsxs("th",{onClick:()=>me("cooperative_name"),style:{cursor:"pointer"},children:["Koperasi",D("cooperative_name")]}),s.jsxs("th",{onClick:()=>me("category"),style:{cursor:"pointer"},children:["Kategori",D("category")]}),s.jsx("th",{children:"Deskripsi"}),s.jsxs("th",{onClick:()=>me("transaction_type"),style:{cursor:"pointer"},children:["Tipe",D("transaction_type")]}),s.jsxs("th",{onClick:()=>me("amount"),style:{cursor:"pointer"},children:["Jumlah",D("amount")]}),Z&&s.jsx("th",{children:"Aksi"})]})}),s.jsx("tbody",{children:r.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:Z?"8":"7",style:{textAlign:"center"},children:"Belum ada data jurnal"})}):P.map((C,I)=>{var ie,ae;return s.jsxs("tr",{children:[s.jsx("td",{children:(w-1)*A+I+1}),s.jsx("td",{children:new Date(C.transaction_date).toLocaleDateString("id-ID")}),s.jsx("td",{children:((ie=C.cooperatives)==null?void 0:ie.name)||"-"}),s.jsx("td",{style:{textTransform:"capitalize"},children:C.category.replace(/_/g," ")}),s.jsx("td",{children:C.description}),s.jsx("td",{style:{textTransform:"uppercase"},children:C.transaction_type}),s.jsxs("td",{className:C.transaction_type==="debit"?"amount-debit":"amount-credit",children:["Rp ",(ae=C.amount)==null?void 0:ae.toLocaleString("id-ID")]}),Z&&s.jsx("td",{children:s.jsxs("div",{className:"actions",children:[s.jsx("button",{className:"btn-edit",onClick:()=>M(C),children:"Edit"}),h==="super_admin"&&s.jsx("button",{className:"btn-delete",onClick:()=>Q(C.id),children:"Hapus"})]})})]},C.id)})})]})}),G>1&&s.jsxs("div",{className:"pagination",children:[s.jsx("button",{onClick:()=>m(1),disabled:w===1,children:""}),s.jsx("button",{onClick:()=>m(w-1),disabled:w===1,children:""}),[...Array(G)].map((C,I)=>{const ie=I+1;return ie===1||ie===G||ie>=w-1&&ie<=w+1?s.jsx("button",{onClick:()=>m(ie),className:w===ie?"active":"",children:ie},ie):ie===w-2||ie===w+2?s.jsx("span",{children:"..."},ie):null}),s.jsx("button",{onClick:()=>m(w+1),disabled:w===G,children:""}),s.jsx("button",{onClick:()=>m(G),disabled:w===G,children:""})]}),o&&s.jsx("div",{className:"modal-overlay",onClick:()=>l(!1),children:s.jsxs("div",{className:"modal-content",onClick:C=>C.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:c?"Edit Jurnal":"Tambah Jurnal"}),s.jsx("button",{className:"btn-close",onClick:()=>l(!1),children:""})]}),s.jsxs("form",{onSubmit:te,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Koperasi"}),s.jsxs("select",{name:"cooperative_id",value:k.cooperative_id,onChange:oe,required:!0,children:[s.jsx("option",{value:"",children:"Pilih Koperasi"}),d.map(C=>s.jsx("option",{value:C.id,children:C.name},C.id))]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Tanggal Transaksi"}),s.jsx("input",{type:"date",name:"transaction_date",value:k.transaction_date,onChange:oe,required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Kategori"}),s.jsxs("select",{name:"category",value:k.category,onChange:oe,required:!0,children:[s.jsx("option",{value:"",children:"Pilih Kategori"}),s.jsx("option",{value:"operational_expense",children:"Biaya Operasional"}),s.jsx("option",{value:"other_income",children:"Pendapatan Lain"}),s.jsx("option",{value:"asset_purchase",children:"Pembelian Aset"}),s.jsx("option",{value:"other",children:"Lainnya"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Deskripsi"}),s.jsx("textarea",{name:"description",value:k.description,onChange:oe,required:!0,rows:"3"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Tipe Transaksi"}),s.jsxs("select",{name:"transaction_type",value:k.transaction_type,onChange:oe,required:!0,children:[s.jsx("option",{value:"",children:"Pilih Tipe"}),s.jsx("option",{value:"debit",children:"Debit (Pengeluaran)"}),s.jsx("option",{value:"credit",children:"Kredit (Pemasukan)"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Jumlah"}),s.jsx("input",{type:"number",name:"amount",value:k.amount,onChange:oe,required:!0,min:"0",step:"0.01"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"No. Referensi (Opsional)"}),s.jsx("input",{type:"text",name:"reference_number",value:k.reference_number,onChange:oe,placeholder:"Contoh: INV-001"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Catatan (Opsional)"}),s.jsx("textarea",{name:"notes",value:k.notes,onChange:oe,rows:"2",placeholder:"Catatan tambahan..."})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>l(!1),children:"Batal"}),s.jsx("button",{type:"submit",className:"btn-save",children:"Simpan"})]})]})]})})]})}function Vt({children:e}){const[t,r]=v.useState(null),[n,a]=v.useState(!0);return v.useEffect(()=>{U.auth.getSession().then(({data:{session:o}})=>{r((o==null?void 0:o.user)??null),a(!1)});const{data:{subscription:i}}=U.auth.onAuthStateChange((o,l)=>{(async()=>r((l==null?void 0:l.user)??null))()});return()=>i.unsubscribe()},[]),n?s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:"Loading..."}):t?e:s.jsx(wv,{to:"/login"})}function R_(){return s.jsx(Cv,{children:s.jsxs(xv,{children:[s.jsx(vt,{path:"/login",element:s.jsx(h_,{})}),s.jsx(vt,{path:"/reset-password",element:s.jsx(f_,{})}),s.jsx(vt,{path:"/",element:s.jsx(Vt,{children:s.jsx(Ht,{children:s.jsx(g_,{})})})}),s.jsx(vt,{path:"/members",element:s.jsx(Vt,{children:s.jsx(Ht,{children:s.jsx(v_,{})})})}),s.jsx(vt,{path:"/savings",element:s.jsx(Vt,{children:s.jsx(Ht,{children:s.jsx(y_,{})})})}),s.jsx(vt,{path:"/loans",element:s.jsx(Vt,{children:s.jsx(Ht,{children:s.jsx(w_,{})})})}),s.jsx(vt,{path:"/cooperatives",element:s.jsx(Vt,{children:s.jsx(Ht,{children:s.jsx(__,{})})})}),s.jsx(vt,{path:"/journal-operasional",element:s.jsx(Vt,{children:s.jsx(Ht,{children:s.jsx(P_,{})})})}),s.jsx(vt,{path:"/admin",element:s.jsx(Vt,{children:s.jsx(Ht,{children:s.jsx(x_,{})})})}),s.jsx(vt,{path:"/profile",element:s.jsx(Vt,{children:s.jsx(Ht,{children:s.jsx(j_,{})})})}),s.jsx(vt,{path:"/audit-logs",element:s.jsx(Vt,{children:s.jsx(Ht,{children:s.jsx(b_,{})})})}),s.jsx(vt,{path:"/reports",element:s.jsx(Vt,{children:s.jsx(Ht,{children:s.jsx(E_,{})})})})]})})}fo.createRoot(document.getElementById("root")).render(s.jsx(bd.StrictMode,{children:s.jsx(R_,{})}));
